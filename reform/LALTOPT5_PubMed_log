[I 2023-06-12 00:12:20,526] A new study created in RDB with name: PubMed_ALTOPT
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.45
lr:  0.00036609533433365027
weight_decay:  0.005717709591466276
dropout:  0.5
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.3504973631352186
None Run 01:
Highest Train: 100.00
Highest Valid: 49.40
  Final Train: 100.00
   Final Test: 51.90
Split: 01, Run: 02
None time:  1.3358329408802092
None Run 02:
Highest Train: 100.00
Highest Valid: 49.40
  Final Train: 100.00
   Final Test: 51.90
Split: 01, Run: 03
None time:  1.2634313078597188
None Run 03:
Highest Train: 100.00
Highest Valid: 49.40
  Final Train: 100.00
   Final Test: 51.90
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.3754848239477724
None Run 04:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 66.40
Split: 02, Run: 02
None time:  1.3060304529499263
None Run 05:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 66.40
Split: 02, Run: 03
None time:  1.3017046099994332
None Run 06:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 66.40
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.316266787936911
None Run 07:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 60.30
Split: 03, Run: 02
None time:  1.3953290248755366
None Run 08:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 67.00
Split: 03, Run: 03
None time:  1.2783846440725029
None Run 09:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 60.30
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.3188146639149636
None Run 10:
Highest Train: 100.00
Highest Valid: 56.20
  Final Train: 100.00
   Final Test: 58.60
Split: 04, Run: 02
None time:  1.3963557379320264
None Run 11:
Highest Train: 100.00
Highest Valid: 60.60
  Final Train: 100.00
   Final Test: 58.40
Split: 04, Run: 03
None time:  1.4402736769989133
None Run 12:
Highest Train: 100.00
Highest Valid: 56.20
  Final Train: 100.00
   Final Test: 58.60
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.3304151920601726
None Run 13:
Highest Train: 100.00
Highest Valid: 62.40
  Final Train: 100.00
   Final Test: 59.50
Split: 05, Run: 02
None time:  1.2992544020526111
None Run 14:
Highest Train: 100.00
Highest Valid: 62.40
  Final Train: 100.00
   Final Test: 59.50
Split: 05, Run: 03
None time:  1.28159160586074
None Run 15:
Highest Train: 100.00
Highest Valid: 62.40
  Final Train: 100.00
   Final Test: 59.50
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.2969522150233388
None Run 16:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 65.80
Split: 06, Run: 02
None time:  1.3005633789580315
None Run 17:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 65.80
Split: 06, Run: 03
None time:  1.3925882899202406
None Run 18:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 65.80
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.3237524118740112
None Run 19:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 64.70
Split: 07, Run: 02
None time:  1.3729078560136259
None Run 20:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 64.70
Split: 07, Run: 03
None time:  1.3171953589189798
None Run 21:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 64.70
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.3182849551085383
None Run 22:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 71.80
Split: 08, Run: 02
None time:  1.2639957920182496
None Run 23:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 71.80
Split: 08, Run: 03
None time:  1.4080008710734546
None Run 24:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 71.80
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.38110218080692
None Run 25:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 68.00
Split: 09, Run: 02
None time:  1.3982095911633223
None Run 26:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 68.00
Split: 09, Run: 03
None time:  1.4215401350520551
None Run 27:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 68.00
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.42064502206631
None Run 28:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 62.90
Split: 10, Run: 02
None time:  1.4276292910799384
None Run 29:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 62.90
Split: 10, Run: 03
None time:  1.475937315961346
None Run 30:
Highest Train: 100.00
Highest Valid: 63.00
  Final Train: 100.00
   Final Test: 60.20
run time now: 4.388856649398804
total time:  44.744139126036316
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 62.93 ± 6.43
  Final Train: 100.00 ± 0.00
   Final Test: 63.12 ± 5.50
best run test_acc: 63.659996032714844
[I 2023-06-12 00:13:05,975] Trial 0 finished with value: 62.93333435058594 and parameters: {'Fwd': 5.929979173453358e-05, 'K': 6, 'alpha': 0.45, 'dropout': 0.5, 'gnnepoch': 70, 'lambda1': 0.1, 'lambda2': 7.375080348723948, 'loop': 0, 'loss': 'MSE', 'lr': 0.00036609533433365027, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.005717709591466276, 'weightedloss': True}. Best is trial 0 with value: 62.93333435058594.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  10
alpha:  0.45
lr:  0.0017772611628522179
weight_decay:  0.0005056697422371055
dropout:  0.5
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.9882133649662137
None Run 01:
Highest Train: 100.00
Highest Valid: 50.00
  Final Train: 100.00
   Final Test: 53.20
Split: 01, Run: 02
None time:  0.9956327369436622
None Run 02:
Highest Train: 100.00
Highest Valid: 50.00
  Final Train: 100.00
   Final Test: 53.20
Split: 01, Run: 03
None time:  1.4819589229300618
None Run 03:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 64.30
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.0144707800354809
None Run 04:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 69.00
Split: 02, Run: 02
None time:  1.0410516501870006
None Run 05:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 69.00
Split: 02, Run: 03
None time:  1.011410413775593
None Run 06:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 69.00
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.0374455119017512
None Run 07:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 70.10
Split: 03, Run: 02
None time:  1.0713383529800922
None Run 08:
Highest Train: 100.00
Highest Valid: 60.80
  Final Train: 100.00
   Final Test: 64.10
Split: 03, Run: 03
None time:  1.0605372949503362
None Run 09:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 67.40
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.0827050141524523
None Run 10:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 56.80
Split: 04, Run: 02
None time:  1.0748237480875105
None Run 11:
Highest Train: 100.00
Highest Valid: 57.60
  Final Train: 100.00
   Final Test: 54.00
Split: 04, Run: 03
None time:  0.7160323911812156
None Run 12:
Highest Train: 100.00
Highest Valid: 57.80
  Final Train: 100.00
   Final Test: 54.90
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.0366036901250482
None Run 13:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 62.00
Split: 05, Run: 02
None time:  1.057883942965418
None Run 14:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 62.00
Split: 05, Run: 03
None time:  1.0398838589899242
None Run 15:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 62.00
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.4276063479483128
None Run 16:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 78.30
Split: 06, Run: 02
None time:  1.2783685470931232
None Run 17:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 77.90
Split: 06, Run: 03
None time:  0.8839990890119225
None Run 18:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 77.90
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.5088753739837557
None Run 19:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 68.10
Split: 07, Run: 02
None time:  1.4724039901047945
None Run 20:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 73.30
Split: 07, Run: 03
None time:  1.3558058489579707
None Run 21:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 70.20
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.0275957020930946
None Run 22:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 74.10
Split: 08, Run: 02
None time:  1.0108735519461334
None Run 23:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 74.10
Split: 08, Run: 03
None time:  1.0320167359896004
None Run 24:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 74.10
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.0740894312039018
None Run 25:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 74.30
Split: 09, Run: 02
None time:  1.0349925560876727
None Run 26:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 75.10
Split: 09, Run: 03
None time:  1.0732224457897246
None Run 27:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 74.30
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.009624905185774
None Run 28:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 66.00
Split: 10, Run: 02
None time:  1.1829410851933062
None Run 29:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 69.00
Split: 10, Run: 03
None time:  1.2350338341202587
None Run 30:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 67.40
run time now: 3.4764585494995117
total time:  34.95669031585567
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 66.45 ± 7.23
  Final Train: 100.00 ± 0.00
   Final Test: 67.50 ± 7.54
best run test_acc: 69.19999694824219
[I 2023-06-12 00:13:41,406] Trial 1 finished with value: 66.44666290283203 and parameters: {'Fwd': 1.1750246771343306e-06, 'K': 10, 'alpha': 0.45, 'dropout': 0.5, 'gnnepoch': 40, 'lambda1': 0.65, 'lambda2': 7.559250524516031, 'loop': 0, 'loss': 'CE', 'lr': 0.0017772611628522179, 'softmaxF': False, 'useGCN': True, 'weight_decay': 0.0005056697422371055, 'weightedloss': False}. Best is trial 1 with value: 66.44666290283203.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  9
alpha:  0.35000000000000003
lr:  0.0003179597695594366
weight_decay:  0.018869968027622086
dropout:  0.8
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.5537970720324665
None Run 01:
Highest Train: 100.00
Highest Valid: 49.80
  Final Train: 100.00
   Final Test: 52.90
Split: 01, Run: 02
None time:  2.5318103339523077
None Run 02:
Highest Train: 100.00
Highest Valid: 49.80
  Final Train: 100.00
   Final Test: 52.90
Split: 01, Run: 03
None time:  2.566348613006994
None Run 03:
Highest Train: 100.00
Highest Valid: 54.00
  Final Train: 100.00
   Final Test: 54.00
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  2.539937481051311
None Run 04:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 68.50
Split: 02, Run: 02
None time:  2.4429702379275113
None Run 05:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 68.50
Split: 02, Run: 03
None time:  2.5807370310649276
None Run 06:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 66.50
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  2.588545728009194
None Run 07:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 61.10
Split: 03, Run: 02
None time:  2.466615868965164
None Run 08:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 61.10
Split: 03, Run: 03
None time:  2.5386385729070753
None Run 09:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 61.10
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  2.5028941240161657
None Run 10:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 100.00
   Final Test: 58.40
Split: 04, Run: 02
None time:  2.4708989991340786
None Run 11:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 100.00
   Final Test: 58.40
Split: 04, Run: 03
None time:  2.552551710046828
None Run 12:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 100.00
   Final Test: 58.40
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  2.494125703116879
None Run 13:
Highest Train: 100.00
Highest Valid: 62.40
  Final Train: 100.00
   Final Test: 60.50
Split: 05, Run: 02
None time:  2.5410448510665447
None Run 14:
Highest Train: 100.00
Highest Valid: 62.40
  Final Train: 100.00
   Final Test: 60.50
Split: 05, Run: 03
None time:  2.5396793060936034
None Run 15:
Highest Train: 100.00
Highest Valid: 62.40
  Final Train: 100.00
   Final Test: 60.50
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  2.5146461850963533
None Run 16:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 68.40
Split: 06, Run: 02
None time:  2.4971911280881613
None Run 17:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 68.40
Split: 06, Run: 03
None time:  2.5196093739941716
None Run 18:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 68.40
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.225957970833406
None Run 19:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 68.20
Split: 07, Run: 02
None time:  2.3335315932054073
None Run 20:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 68.20
Split: 07, Run: 03
None time:  2.326112712966278
None Run 21:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 68.20
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  2.3450921301264316
None Run 22:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 73.70
Split: 08, Run: 02
None time:  2.4198455759324133
None Run 23:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 73.70
Split: 08, Run: 03
None time:  2.2970782620832324
None Run 24:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 73.70
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.3732552090659738
None Run 25:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 70.30
Split: 09, Run: 02
None time:  2.329291808884591
None Run 26:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 70.30
Split: 09, Run: 03
None time:  2.404426640830934
None Run 27:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 70.30
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  2.369832505006343
None Run 28:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 65.10
Split: 10, Run: 02
None time:  2.2989939420949668
None Run 29:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 65.10
Split: 10, Run: 03
None time:  2.3739754881244153
None Run 30:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 65.10
run time now: 7.089827299118042
total time:  74.7198638599366
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 63.22 ± 6.29
  Final Train: 100.00 ± 0.00
   Final Test: 64.68 ± 6.02
best run test_acc: 64.81999969482422
[I 2023-06-12 00:14:56,523] Trial 2 finished with value: 63.22000503540039 and parameters: {'Fwd': 0.0037556537130951397, 'K': 9, 'alpha': 0.35000000000000003, 'dropout': 0.8, 'gnnepoch': 110, 'lambda1': 0.1, 'lambda2': 7.916513378263177, 'loop': 2, 'loss': 'MSE', 'lr': 0.0003179597695594366, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.018869968027622086, 'weightedloss': False}. Best is trial 1 with value: 66.44666290283203.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  2
alpha:  0.35000000000000003
lr:  0.0017562321807753063
weight_decay:  8.850960020108799e-06
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.9421156400348991
None Run 01:
Highest Train: 100.00
Highest Valid: 50.60
  Final Train: 100.00
   Final Test: 49.10
Split: 01, Run: 02
None time:  0.9885650109499693
None Run 02:
Highest Train: 100.00
Highest Valid: 50.80
  Final Train: 100.00
   Final Test: 50.40
Split: 01, Run: 03
None time:  0.9950567800551653
None Run 03:
Highest Train: 100.00
Highest Valid: 52.60
  Final Train: 100.00
   Final Test: 51.70
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.0164897898212075
None Run 04:
Highest Train: 100.00
Highest Valid: 56.00
  Final Train: 100.00
   Final Test: 57.40
Split: 02, Run: 02
None time:  0.9799100898671895
None Run 05:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 100.00
   Final Test: 57.80
Split: 02, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 58.40% Test: 60.30%
Split: 02, Run: 03
None time:  1.4821466230787337
None Run 06:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 60.20
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 67.80% Test: 65.80%
Split: 03, Run: 01
None time:  1.5059650919865817
None Run 07:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 65.80
Split: 03, Run: 02
None time:  0.9653367849532515
None Run 08:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 68.00
Split: 03, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 70.80% Test: 69.20%
Split: 03, Run: 03
None time:  1.3371153639163822
None Run 09:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 69.10
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 59.00% Test: 54.40%
Split: 04, Run: 01
None time:  1.473034837981686
None Run 10:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 54.50
Split: 04, Run: 02
None time:  0.998183973133564
None Run 11:
Highest Train: 100.00
Highest Valid: 59.80
  Final Train: 100.00
   Final Test: 58.70
Split: 04, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 61.80% Test: 59.30%
Split: 04, Run: 03
None time:  1.3482554990332574
None Run 12:
Highest Train: 100.00
Highest Valid: 61.80
  Final Train: 100.00
   Final Test: 59.40
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.9836851840373129
None Run 13:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 55.90
Split: 05, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 67.00% Test: 61.50%
Split: 05, Run: 02
None time:  1.457071288023144
None Run 14:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 61.50
Split: 05, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 63.20% Test: 57.50%
Split: 05, Run: 03
None time:  1.4834946629125625
None Run 15:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 57.60
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 59.00% Test: 57.20%
Split: 06, Run: 01
None time:  1.446917838184163
None Run 16:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 57.30
Split: 06, Run: 02
None time:  0.9383074431680143
None Run 17:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 63.40
Split: 06, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 66.00% Test: 67.00%
Split: 06, Run: 03
None time:  1.5215378219727427
None Run 18:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 67.00
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 66.80% Test: 65.00%
Split: 07, Run: 01
None time:  1.4127936258446425
None Run 19:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 65.00
Split: 07, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 65.80% Test: 64.80%
Split: 07, Run: 02
None time:  1.423531258944422
None Run 20:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 64.70
Split: 07, Run: 03
None time:  0.9632560391910374
None Run 21:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 65.80
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.881114570889622
None Run 22:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 66.00
Split: 08, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 69.20% Test: 68.90%
Split: 08, Run: 02
None time:  1.2005539240781218
None Run 23:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 68.90
Split: 08, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 69.40% Test: 70.10%
Split: 08, Run: 03
None time:  1.5172304180450737
None Run 24:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 69.90
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 71.20% Test: 70.50%
Split: 09, Run: 01
None time:  1.5051776960026473
None Run 25:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 70.90
Split: 09, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 70.60% Test: 69.50%
Split: 09, Run: 02
None time:  1.4801457759458572
None Run 26:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 69.40
Split: 09, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 70.40% Test: 68.70%
Split: 09, Run: 03
None time:  1.375568182906136
None Run 27:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 68.60
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 58.40% Test: 52.40%
Split: 10, Run: 01
None time:  1.4579194840043783
None Run 28:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 52.30
Split: 10, Run: 02
None time:  0.9474503679666668
None Run 29:
Highest Train: 100.00
Highest Valid: 61.40
  Final Train: 100.00
   Final Test: 54.80
Split: 10, Run: 03
None time:  1.0238108970224857
None Run 30:
Highest Train: 100.00
Highest Valid: 62.20
  Final Train: 100.00
   Final Test: 57.10
run time now: 3.468076467514038
total time:  38.17908708192408
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 63.21 ± 6.00
  Final Train: 100.00 ± 0.00
   Final Test: 61.27 ± 6.48
best run test_acc: 63.26000213623047
[I 2023-06-12 00:15:35,070] Trial 3 finished with value: 63.21332931518555 and parameters: {'Fwd': 0.053291808884269036, 'K': 2, 'alpha': 0.35000000000000003, 'dropout': 0.30000000000000004, 'gnnepoch': 100, 'lambda1': 0.35000000000000003, 'lambda2': 2.9676194257142328, 'loop': 0, 'loss': 'MSE', 'lr': 0.0017562321807753063, 'softmaxF': False, 'useGCN': False, 'weight_decay': 8.850960020108799e-06, 'weightedloss': True}. Best is trial 1 with value: 66.44666290283203.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  1
alpha:  0.5
lr:  0.00866562490925765
weight_decay:  0.0020071743186865954
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.1693693588022143
None Run 01:
Highest Train: 100.00
Highest Valid: 51.80
  Final Train: 100.00
   Final Test: 51.50
Split: 01, Run: 02
None time:  1.2620319288689643
None Run 02:
Highest Train: 100.00
Highest Valid: 49.40
  Final Train: 100.00
   Final Test: 54.20
Split: 01, Run: 03
None time:  1.340439932886511
None Run 03:
Highest Train: 100.00
Highest Valid: 51.00
  Final Train: 73.33
   Final Test: 51.90
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.2393539100885391
None Run 04:
Highest Train: 100.00
Highest Valid: 55.60
  Final Train: 100.00
   Final Test: 53.80
Split: 02, Run: 02
None time:  1.192596061853692
None Run 05:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 59.00
Split: 02, Run: 03
None time:  1.234352732077241
None Run 06:
Highest Train: 100.00
Highest Valid: 53.80
  Final Train: 86.67
   Final Test: 51.10
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.4991989280097187
None Run 07:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 93.33
   Final Test: 67.60
Split: 03, Run: 02
None time:  1.3043733478989452
None Run 08:
Highest Train: 100.00
Highest Valid: 62.20
  Final Train: 100.00
   Final Test: 61.30
Split: 03, Run: 03
None time:  1.2584742659237236
None Run 09:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 86.67
   Final Test: 59.00
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.2130144741386175
None Run 10:
Highest Train: 100.00
Highest Valid: 53.60
  Final Train: 100.00
   Final Test: 50.90
Split: 04, Run: 02
None time:  1.2246679300442338
None Run 11:
Highest Train: 100.00
Highest Valid: 43.60
  Final Train: 100.00
   Final Test: 40.60
Split: 04, Run: 03
None time:  1.2326567939016968
None Run 12:
Highest Train: 100.00
Highest Valid: 38.60
  Final Train: 100.00
   Final Test: 36.40
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.2330200138967484
None Run 13:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 57.90
Split: 05, Run: 02
None time:  1.3527641431428492
None Run 14:
Highest Train: 100.00
Highest Valid: 52.80
  Final Train: 93.33
   Final Test: 52.10
Split: 05, Run: 03
None time:  1.3519124209415168
None Run 15:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 58.00
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.2090301730204374
None Run 16:
Highest Train: 100.00
Highest Valid: 59.20
  Final Train: 100.00
   Final Test: 58.10
Split: 06, Run: 02
None time:  1.4353914549574256
None Run 17:
Highest Train: 100.00
Highest Valid: 51.60
  Final Train: 80.00
   Final Test: 48.70
Split: 06, Run: 03
None time:  1.2360986268613487
None Run 18:
Highest Train: 100.00
Highest Valid: 53.00
  Final Train: 100.00
   Final Test: 54.00
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.175153851043433
None Run 19:
Highest Train: 100.00
Highest Valid: 60.80
  Final Train: 100.00
   Final Test: 61.20
Split: 07, Run: 02
None time:  1.283065325813368
None Run 20:
Highest Train: 100.00
Highest Valid: 58.20
  Final Train: 100.00
   Final Test: 59.90
Split: 07, Run: 03
None time:  1.353394575882703
None Run 21:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 86.67
   Final Test: 56.10
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.1951940672006458
None Run 22:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 63.00
Split: 08, Run: 02
None time:  1.2543503439519554
None Run 23:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 55.40
Split: 08, Run: 03
None time:  1.3059269171208143
None Run 24:
Highest Train: 100.00
Highest Valid: 60.00
  Final Train: 100.00
   Final Test: 58.70
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.2135035041719675
None Run 25:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 63.30
Split: 09, Run: 02
None time:  1.3651848279405385
None Run 26:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 55.90
Split: 09, Run: 03
None time:  1.37279476900585
None Run 27:
Highest Train: 100.00
Highest Valid: 52.20
  Final Train: 100.00
   Final Test: 47.60
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.264898963039741
None Run 28:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 58.00
Split: 10, Run: 02
None time:  1.392994698137045
None Run 29:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 65.30
Split: 10, Run: 03
None time:  1.3210843338165432
None Run 30:
Highest Train: 100.00
Highest Valid: 54.00
  Final Train: 100.00
   Final Test: 53.30
run time now: 4.059558629989624
total time:  39.547506459988654
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 56.65 ± 6.51
  Final Train: 96.67 ± 6.95
   Final Test: 55.46 ± 6.68
best run test_acc: 60.05999755859375
[I 2023-06-12 00:16:15,064] Trial 4 finished with value: 56.64666748046875 and parameters: {'Fwd': 0.014354425530217615, 'K': 1, 'alpha': 0.5, 'dropout': 0.2, 'gnnepoch': 110, 'lambda1': 0.25, 'lambda2': 0.1700934060510173, 'loop': 2, 'loss': 'CE', 'lr': 0.00866562490925765, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.0020071743186865954, 'weightedloss': True}. Best is trial 1 with value: 66.44666290283203.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  4
alpha:  0.8
lr:  0.0007120103007813908
weight_decay:  0.0016420942117235816
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.9402535979170352
None Run 01:
Highest Train: 100.00
Highest Valid: 43.00
  Final Train: 100.00
   Final Test: 44.20
Split: 01, Run: 02
None time:  1.8536822819150984
None Run 02:
Highest Train: 100.00
Highest Valid: 43.00
  Final Train: 100.00
   Final Test: 41.80
Split: 01, Run: 03
None time:  1.2733164969831705
None Run 03:
Highest Train: 100.00
Highest Valid: 56.20
  Final Train: 100.00
   Final Test: 56.90
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.3480912558734417
None Run 04:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 66.80
Split: 02, Run: 02
None time:  2.0718867969699204
None Run 05:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 58.40
Split: 02, Run: 03
None time:  1.2821898548863828
None Run 06:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 65.20
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.581648499937728
None Run 07:
Highest Train: 100.00
Highest Valid: 62.00
  Final Train: 100.00
   Final Test: 63.00
Split: 03, Run: 02
None time:  1.5264093670994043
None Run 08:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 65.10
Split: 03, Run: 03
None time:  1.2056963029317558
None Run 09:
Highest Train: 100.00
Highest Valid: 52.00
  Final Train: 100.00
   Final Test: 52.00
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.992223055101931
None Run 10:
Highest Train: 100.00
Highest Valid: 58.00
  Final Train: 100.00
   Final Test: 57.10
Split: 04, Run: 02
None time:  3.0231041579972953
None Run 11:
Highest Train: 100.00
Highest Valid: 55.00
  Final Train: 100.00
   Final Test: 51.50
Split: 04, Run: 03
None time:  1.2115320509765297
None Run 12:
Highest Train: 100.00
Highest Valid: 48.20
  Final Train: 100.00
   Final Test: 48.40
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.1733242978807539
None Run 13:
Highest Train: 100.00
Highest Valid: 48.00
  Final Train: 100.00
   Final Test: 45.40
Split: 05, Run: 02
None time:  1.8499680010136217
None Run 14:
Highest Train: 100.00
Highest Valid: 54.00
  Final Train: 100.00
   Final Test: 55.90
Split: 05, Run: 03
None time:  1.724471597932279
None Run 15:
Highest Train: 100.00
Highest Valid: 48.60
  Final Train: 100.00
   Final Test: 53.00
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.648800855036825
None Run 16:
Highest Train: 100.00
Highest Valid: 54.00
  Final Train: 100.00
   Final Test: 53.50
Split: 06, Run: 02
None time:  1.9473416830878705
None Run 17:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 73.70
Split: 06, Run: 03
None time:  1.936479785013944
None Run 18:
Highest Train: 100.00
Highest Valid: 52.40
  Final Train: 100.00
   Final Test: 57.70
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.598523291060701
None Run 19:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 64.60
Split: 07, Run: 02
None time:  1.7942110889125615
None Run 20:
Highest Train: 100.00
Highest Valid: 59.80
  Final Train: 100.00
   Final Test: 58.00
Split: 07, Run: 03
None time:  1.947101595113054
None Run 21:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 64.20
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.254156329901889
None Run 22:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 63.10
Split: 08, Run: 02
None time:  1.2099978919140995
None Run 23:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 63.10
Split: 08, Run: 03
None time:  1.235009087016806
None Run 24:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 63.10
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.2184162039775401
None Run 25:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 55.70
Split: 09, Run: 02
None time:  1.8038160339929163
None Run 26:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 61.50
Split: 09, Run: 03
None time:  1.217023397097364
None Run 27:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 55.70
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.3702437889296561
None Run 28:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 64.40
Split: 10, Run: 02
None time:  1.3141570389270782
None Run 29:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 60.70
Split: 10, Run: 03
None time:  2.5551745870616287
None Run 30:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 63.60
run time now: 5.278331518173218
total time:  50.29438336007297
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 58.80 ± 7.68
  Final Train: 100.00 ± 0.00
   Final Test: 58.24 ± 7.30
best run test_acc: 62.909996032714844
[I 2023-06-12 00:17:05,808] Trial 5 finished with value: 58.79999542236328 and parameters: {'Fwd': 0.004453069401183982, 'K': 4, 'alpha': 0.8, 'dropout': 0.2, 'gnnepoch': 50, 'lambda1': 0.9500000000000001, 'lambda2': 9.854081824557152, 'loop': 1, 'loss': 'MSE', 'lr': 0.0007120103007813908, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.0016420942117235816, 'weightedloss': False}. Best is trial 1 with value: 66.44666290283203.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.45
lr:  0.0009645439560450771
weight_decay:  2.422661600660516e-06
dropout:  0.7000000000000001
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.9429690600372851
None Run 01:
Highest Train: 100.00
Highest Valid: 50.20
  Final Train: 100.00
   Final Test: 52.60
Split: 01, Run: 02
None time:  0.9095268070232123
None Run 02:
Highest Train: 100.00
Highest Valid: 50.20
  Final Train: 100.00
   Final Test: 52.60
Split: 01, Run: 03
None time:  0.9584290808998048
None Run 03:
Highest Train: 100.00
Highest Valid: 50.20
  Final Train: 100.00
   Final Test: 52.60
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.9853626398835331
None Run 04:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 67.70
Split: 02, Run: 02
None time:  0.9068052328657359
None Run 05:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 67.70
Split: 02, Run: 03
None time:  0.9516722788102925
None Run 06:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 67.70
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.9427468369249254
None Run 07:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 60.80
Split: 03, Run: 02
None time:  1.3246306460350752
None Run 08:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 63.90
Split: 03, Run: 03
None time:  1.0759041639976203
None Run 09:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 66.00
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.9325815038755536
None Run 10:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 58.70
Split: 04, Run: 02
None time:  1.0453008231706917
None Run 11:
Highest Train: 100.00
Highest Valid: 58.00
  Final Train: 100.00
   Final Test: 55.20
Split: 04, Run: 03
None time:  1.7705010038334876
None Run 12:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 56.40
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.9230549999047071
None Run 13:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 59.60
Split: 05, Run: 02
None time:  0.7772398898378015
None Run 14:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 59.60
Split: 05, Run: 03
None time:  0.869301131926477
None Run 15:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 59.60
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.8837509460281581
None Run 16:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 67.80
Split: 06, Run: 02
None time:  0.8415751680731773
None Run 17:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 67.80
Split: 06, Run: 03
None time:  1.2976588748861104
None Run 18:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 66.90
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.8842021140735596
None Run 19:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 66.20
Split: 07, Run: 02
None time:  0.9758412009105086
None Run 20:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 65.10
Split: 07, Run: 03
None time:  1.0496513959951699
None Run 21:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 68.20
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.9018822889775038
None Run 22:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 73.10
Split: 08, Run: 02
None time:  0.9335541368927807
None Run 23:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 73.10
Split: 08, Run: 03
None time:  0.9105196360033005
None Run 24:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 73.10
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  0.887174324830994
None Run 25:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 69.60
Split: 09, Run: 02
None time:  0.8550397008657455
None Run 26:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 69.60
Split: 09, Run: 03
None time:  0.9153634621761739
None Run 27:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 72.30
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.8912539351731539
None Run 28:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 64.40
Split: 10, Run: 02
None time:  0.9154885339085013
None Run 29:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 64.40
Split: 10, Run: 03
None time:  0.8706391749437898
None Run 30:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 64.40
run time now: 2.724936008453369
total time:  30.447149771032855
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 63.93 ± 6.39
  Final Train: 100.00 ± 0.00
   Final Test: 64.22 ± 6.18
best run test_acc: 65.03999328613281
[I 2023-06-12 00:17:36,595] Trial 6 finished with value: 63.93333435058594 and parameters: {'Fwd': 3.7433893899106044e-06, 'K': 8, 'alpha': 0.45, 'dropout': 0.7000000000000001, 'gnnepoch': 70, 'lambda1': 0.30000000000000004, 'lambda2': 6.6378288466487305, 'loop': 1, 'loss': 'MSE', 'lr': 0.0009645439560450771, 'softmaxF': False, 'useGCN': False, 'weight_decay': 2.422661600660516e-06, 'weightedloss': False}. Best is trial 1 with value: 66.44666290283203.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  4
alpha:  0.45
lr:  0.0007668810089328686
weight_decay:  1.777868469749514e-06
dropout:  0.8
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.029907661024481
None Run 01:
Highest Train: 100.00
Highest Valid: 52.60
  Final Train: 100.00
   Final Test: 56.40
Split: 01, Run: 02
None time:  2.0962326540611684
None Run 02:
Highest Train: 100.00
Highest Valid: 50.00
  Final Train: 100.00
   Final Test: 50.80
Split: 01, Run: 03
None time:  2.0499546609353274
None Run 03:
Highest Train: 100.00
Highest Valid: 49.20
  Final Train: 100.00
   Final Test: 51.20
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  2.1262526591308415
None Run 04:
Highest Train: 100.00
Highest Valid: 60.20
  Final Train: 100.00
   Final Test: 64.70
Split: 02, Run: 02
None time:  2.1731869319919497
None Run 05:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 64.30
Split: 02, Run: 03
None time:  2.088513419032097
None Run 06:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 66.90
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  2.105392280034721
None Run 07:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 68.60
Split: 03, Run: 02
None time:  2.016591913998127
None Run 08:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 67.00
Split: 03, Run: 03
None time:  2.00662510888651
None Run 09:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 70.50
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.9826998098287731
None Run 10:
Highest Train: 100.00
Highest Valid: 57.40
  Final Train: 100.00
   Final Test: 54.20
Split: 04, Run: 02
None time:  2.273052060045302
None Run 11:
Highest Train: 100.00
Highest Valid: 57.40
  Final Train: 100.00
   Final Test: 54.50
Split: 04, Run: 03
None time:  2.153717814013362
None Run 12:
Highest Train: 100.00
Highest Valid: 55.80
  Final Train: 100.00
   Final Test: 52.50
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.9969503490719944
None Run 13:
Highest Train: 100.00
Highest Valid: 60.00
  Final Train: 100.00
   Final Test: 60.20
Split: 05, Run: 02
None time:  2.2380749119911343
None Run 14:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 64.80
Split: 05, Run: 03
None time:  2.265579632949084
None Run 15:
Highest Train: 100.00
Highest Valid: 60.40
  Final Train: 100.00
   Final Test: 62.20
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  2.0488722410518676
None Run 16:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 76.80
Split: 06, Run: 02
None time:  2.3283701320178807
None Run 17:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 79.80
Split: 06, Run: 03
None time:  2.1661481349729
None Run 18:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 78.20
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.9633786890190095
None Run 19:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 72.60
Split: 07, Run: 02
None time:  2.394040561048314
None Run 20:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 69.20
Split: 07, Run: 03
None time:  2.384834164986387
None Run 21:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 69.90
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.9108167509548366
None Run 22:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 63.20
Split: 08, Run: 02
None time:  2.0361900120042264
None Run 23:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 69.70
Split: 08, Run: 03
None time:  2.026044361991808
None Run 24:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 63.20
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.026826186105609
None Run 25:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 70.60
Split: 09, Run: 02
None time:  2.047429633093998
None Run 26:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 74.90
Split: 09, Run: 03
None time:  2.065572947030887
None Run 27:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 71.70
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  2.089532912010327
None Run 28:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 66.50
Split: 10, Run: 02
None time:  2.40423119883053
None Run 29:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 66.70
Split: 10, Run: 03
None time:  2.2240287440363318
None Run 30:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 65.30
run time now: 6.756820440292358
total time:  65.77094731084071
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 65.01 ± 7.62
  Final Train: 100.00 ± 0.00
   Final Test: 65.57 ± 7.79
best run test_acc: 67.68000030517578
[I 2023-06-12 00:18:42,739] Trial 7 finished with value: 65.0133285522461 and parameters: {'Fwd': 0.00016809315177591618, 'K': 4, 'alpha': 0.45, 'dropout': 0.8, 'gnnepoch': 110, 'lambda1': 0.1, 'lambda2': 9.319510680328433, 'loop': 1, 'loss': 'CE', 'lr': 0.0007668810089328686, 'softmaxF': True, 'useGCN': True, 'weight_decay': 1.777868469749514e-06, 'weightedloss': False}. Best is trial 1 with value: 66.44666290283203.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  1
alpha:  0.6000000000000001
lr:  0.00012398963076330793
weight_decay:  4.129015338215504e-06
dropout:  0.5
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.9888201730791479
None Run 01:
Highest Train: 100.00
Highest Valid: 52.40
  Final Train: 100.00
   Final Test: 50.90
Split: 01, Run: 02
None time:  0.9596622451208532
None Run 02:
Highest Train: 100.00
Highest Valid: 53.80
  Final Train: 100.00
   Final Test: 53.30
Split: 01, Run: 03
None time:  1.0095137439202517
None Run 03:
Highest Train: 100.00
Highest Valid: 53.40
  Final Train: 100.00
   Final Test: 52.40
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.0351338139735162
None Run 04:
Highest Train: 100.00
Highest Valid: 49.20
  Final Train: 100.00
   Final Test: 51.50
Split: 02, Run: 02
None time:  1.1125784788746387
None Run 05:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 61.60
Split: 02, Run: 03
None time:  1.1990128308534622
None Run 06:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 66.70
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.054851729888469
None Run 07:
Highest Train: 100.00
Highest Valid: 59.20
  Final Train: 100.00
   Final Test: 60.10
Split: 03, Run: 02
None time:  1.0771050010807812
None Run 08:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 65.60
Split: 03, Run: 03
None time:  1.0481596218887717
None Run 09:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 66.30
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.9138090668711811
None Run 10:
Highest Train: 100.00
Highest Valid: 56.20
  Final Train: 100.00
   Final Test: 52.60
Split: 04, Run: 02
None time:  1.1008641538210213
None Run 11:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 52.80
Split: 04, Run: 03
None time:  1.0696444190107286
None Run 12:
Highest Train: 100.00
Highest Valid: 57.60
  Final Train: 100.00
   Final Test: 53.60
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.1810092518571764
None Run 13:
Highest Train: 100.00
Highest Valid: 61.60
  Final Train: 100.00
   Final Test: 64.50
Split: 05, Run: 02
None time:  1.0929400990717113
None Run 14:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 66.90
Split: 05, Run: 03
None time:  1.1923060070257634
None Run 15:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 68.40
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.053957740077749
None Run 16:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 58.60
Split: 06, Run: 02
None time:  1.0512424008920789
None Run 17:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 67.70
Split: 06, Run: 03
None time:  1.079521510982886
None Run 18:
Highest Train: 100.00
Highest Valid: 62.20
  Final Train: 100.00
   Final Test: 67.80
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.1054107160307467
None Run 19:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 72.10
Split: 07, Run: 02
None time:  1.159323823172599
None Run 20:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 73.90
Split: 07, Run: 03
None time:  1.204017564887181
None Run 21:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 75.10
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.1610429361462593
None Run 22:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 71.80
Split: 08, Run: 02
None time:  1.0999571669381112
None Run 23:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 73.20
Split: 08, Run: 03
None time:  1.3386301358696073
None Run 24:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 75.40
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.0086827899795026
None Run 25:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 68.10
Split: 09, Run: 02
None time:  1.0471846112050116
None Run 26:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 73.20
Split: 09, Run: 03
None time:  1.016643940936774
None Run 27:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 73.10
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.9936458999291062
None Run 28:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 51.20
Split: 10, Run: 02
None time:  1.0502919319551438
None Run 29:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 58.90
Split: 10, Run: 03
None time:  1.0637409300543368
None Run 30:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 64.20
run time now: 3.1446831226348877
total time:  33.42179976217449
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 64.40 ± 8.02
  Final Train: 100.00 ± 0.00
   Final Test: 63.72 ± 8.30
best run test_acc: 66.4000015258789
[I 2023-06-12 00:19:16,623] Trial 8 finished with value: 64.4000015258789 and parameters: {'Fwd': 0.00023622573750903007, 'K': 1, 'alpha': 0.6000000000000001, 'dropout': 0.5, 'gnnepoch': 110, 'lambda1': 0.45, 'lambda2': 4.658173770980072, 'loop': 0, 'loss': 'CE', 'lr': 0.00012398963076330793, 'softmaxF': False, 'useGCN': False, 'weight_decay': 4.129015338215504e-06, 'weightedloss': True}. Best is trial 1 with value: 66.44666290283203.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  5
alpha:  0.8500000000000001
lr:  0.00034570736086613055
weight_decay:  1.1601002578195146e-06
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.1607932311017066
None Run 01:
Highest Train: 100.00
Highest Valid: 53.00
  Final Train: 100.00
   Final Test: 53.90
Split: 01, Run: 02
None time:  1.2512171769049019
None Run 02:
Highest Train: 100.00
Highest Valid: 52.20
  Final Train: 100.00
   Final Test: 56.60
Split: 01, Run: 03
None time:  1.402419356862083
None Run 03:
Highest Train: 100.00
Highest Valid: 50.60
  Final Train: 100.00
   Final Test: 55.40
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.1113333669491112
None Run 04:
Highest Train: 100.00
Highest Valid: 63.00
  Final Train: 100.00
   Final Test: 64.10
Split: 02, Run: 02
None time:  1.240381937008351
None Run 05:
Highest Train: 100.00
Highest Valid: 61.20
  Final Train: 100.00
   Final Test: 63.70
Split: 02, Run: 03
None time:  1.1028798308689147
None Run 06:
Highest Train: 100.00
Highest Valid: 60.80
  Final Train: 100.00
   Final Test: 64.10
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1007976280525327
None Run 07:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 68.10
Split: 03, Run: 02
None time:  1.0482759531587362
None Run 08:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 66.40
Split: 03, Run: 03
None time:  1.1742286121007055
None Run 09:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 64.30
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.101900177076459
None Run 10:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 58.20
Split: 04, Run: 02
None time:  1.1091230341698974
None Run 11:
Highest Train: 100.00
Highest Valid: 59.20
  Final Train: 100.00
   Final Test: 57.10
Split: 04, Run: 03
None time:  1.1335732119623572
None Run 12:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 56.30
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.2897195951081812
None Run 13:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 70.70
Split: 05, Run: 02
None time:  1.4527846069540828
None Run 14:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 67.90
Split: 05, Run: 03
None time:  1.5609116300474852
None Run 15:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 65.00
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.0899657919071615
None Run 16:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 75.10
Split: 06, Run: 02
None time:  1.1608160010073334
None Run 17:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 75.50
Split: 06, Run: 03
None time:  1.1893219400662929
None Run 18:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 72.90
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.212703718803823
None Run 19:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 74.60
Split: 07, Run: 02
None time:  1.3470873290207237
None Run 20:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 74.80
Split: 07, Run: 03
None time:  1.2786265357863158
None Run 21:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 75.00
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.0809292797930539
None Run 22:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 75.90
Split: 08, Run: 02
None time:  1.3457320109009743
None Run 23:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 76.50
Split: 08, Run: 03
None time:  1.288597720908001
None Run 24:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 76.80
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.1302864719182253
None Run 25:
Highest Train: 100.00
Highest Valid: 79.20
  Final Train: 100.00
   Final Test: 76.30
Split: 09, Run: 02
None time:  1.2292514068540186
None Run 26:
Highest Train: 100.00
Highest Valid: 80.40
  Final Train: 100.00
   Final Test: 77.40
Split: 09, Run: 03
None time:  1.291653519961983
None Run 27:
Highest Train: 100.00
Highest Valid: 80.20
  Final Train: 100.00
   Final Test: 77.10
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.4454217930324376
None Run 28:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 67.90
Split: 10, Run: 02
None time:  1.336259420029819
None Run 29:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 67.90
Split: 10, Run: 03
None time:  1.2244900539517403
None Run 30:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 67.10
run time now: 4.047917366027832
total time:  37.95050101587549
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 68.54 ± 8.20
  Final Train: 100.00 ± 0.00
   Final Test: 68.09 ± 7.53
best run test_acc: 69.02999877929688
[I 2023-06-12 00:19:54,946] Trial 9 finished with value: 68.54000091552734 and parameters: {'Fwd': 4.190547012413118e-06, 'K': 5, 'alpha': 0.8500000000000001, 'dropout': 0.0, 'gnnepoch': 120, 'lambda1': 0.15000000000000002, 'lambda2': 3.1654950177641252, 'loop': 0, 'loss': 'CE', 'lr': 0.00034570736086613055, 'softmaxF': True, 'useGCN': False, 'weight_decay': 1.1601002578195146e-06, 'weightedloss': True}. Best is trial 9 with value: 68.54000091552734.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.0
lr:  0.00010117830151641783
weight_decay:  5.826640262470204e-05
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.3715034381020814
None Run 01:
Highest Train: 100.00
Highest Valid: 49.60
  Final Train: 100.00
   Final Test: 51.80
Split: 01, Run: 02
None time:  0.33894035406410694
None Run 02:
Highest Train: 100.00
Highest Valid: 49.60
  Final Train: 100.00
   Final Test: 51.80
Split: 01, Run: 03
None time:  0.9761997819878161
None Run 03:
Highest Train: 100.00
Highest Valid: 52.80
  Final Train: 100.00
   Final Test: 48.70
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.33563604997470975
None Run 04:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 66.70
Split: 02, Run: 02
None time:  0.3606897920835763
None Run 05:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 66.70
Split: 02, Run: 03
None time:  0.35193369816988707
None Run 06:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 66.70
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.3710389160551131
None Run 07:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 60.40
Split: 03, Run: 02
None time:  0.32628527586348355
None Run 08:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 60.40
Split: 03, Run: 03
None time:  0.34872502693906426
None Run 09:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 60.40
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.3396847869735211
None Run 10:
Highest Train: 100.00
Highest Valid: 56.20
  Final Train: 100.00
   Final Test: 58.80
Split: 04, Run: 02
None time:  0.34718685410916805
None Run 11:
Highest Train: 100.00
Highest Valid: 56.20
  Final Train: 100.00
   Final Test: 58.80
Split: 04, Run: 03
None time:  0.3556260010227561
None Run 12:
Highest Train: 100.00
Highest Valid: 56.20
  Final Train: 100.00
   Final Test: 58.80
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.36502174590714276
None Run 13:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 59.50
Split: 05, Run: 02
None time:  0.3627692540176213
None Run 14:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 59.50
Split: 05, Run: 03
None time:  0.3650976500939578
None Run 15:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 59.50
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.35910192411392927
None Run 16:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 65.90
Split: 06, Run: 02
None time:  0.34364589117467403
None Run 17:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 65.90
Split: 06, Run: 03
None time:  0.35184403508901596
None Run 18:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 65.90
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.36415060702711344
None Run 19:
Highest Train: 100.00
Highest Valid: 63.00
  Final Train: 100.00
   Final Test: 65.20
Split: 07, Run: 02
None time:  0.3850937739480287
None Run 20:
Highest Train: 100.00
Highest Valid: 63.00
  Final Train: 100.00
   Final Test: 65.20
Split: 07, Run: 03
None time:  0.37721789604984224
None Run 21:
Highest Train: 100.00
Highest Valid: 63.00
  Final Train: 100.00
   Final Test: 65.20
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.3460937640629709
None Run 22:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 72.00
Split: 08, Run: 02
None time:  0.35467407410033047
None Run 23:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 72.00
Split: 08, Run: 03
None time:  0.3457290888763964
None Run 24:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 72.00
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  0.3515397438313812
None Run 25:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 68.10
Split: 09, Run: 02
None time:  0.3426335658878088
None Run 26:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 68.10
Split: 09, Run: 03
None time:  0.3573020091280341
None Run 27:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 68.10
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.36569501692429185
None Run 28:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 63.50
Split: 10, Run: 02
None time:  0.36341398605145514
None Run 29:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 63.50
Split: 10, Run: 03
None time:  0.3807504160795361
None Run 30:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 63.50
run time now: 1.1534948348999023
total time:  12.381189344916493
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 62.49 ± 6.23
  Final Train: 100.00 ± 0.00
   Final Test: 63.09 ± 5.78
best run test_acc: 63.18999481201172
[I 2023-06-12 00:20:07,726] Trial 10 finished with value: 62.48666763305664 and parameters: {'Fwd': 9.856022777122382e-06, 'K': 6, 'alpha': 0.0, 'dropout': 0.0, 'gnnepoch': 20, 'lambda1': 0.6000000000000001, 'lambda2': 2.8883002097105606, 'loop': 0, 'loss': 'CE', 'lr': 0.00010117830151641783, 'softmaxF': True, 'useGCN': False, 'weight_decay': 5.826640262470204e-05, 'weightedloss': True}. Best is trial 9 with value: 68.54000091552734.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  10
alpha:  0.9500000000000001
lr:  0.002548777300649295
weight_decay:  0.00018014064989133638
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.3918478870764375
None Run 01:
Highest Train: 100.00
Highest Valid: 49.80
  Final Train: 100.00
   Final Test: 53.20
Split: 01, Run: 02
None time:  0.40166246611624956
None Run 02:
Highest Train: 100.00
Highest Valid: 49.80
  Final Train: 100.00
   Final Test: 53.20
Split: 01, Run: 03
None time:  0.4053086710628122
None Run 03:
Highest Train: 100.00
Highest Valid: 49.80
  Final Train: 100.00
   Final Test: 53.20
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.4044137098826468
None Run 04:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 69.10
Split: 02, Run: 02
None time:  0.39125043991953135
None Run 05:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 69.10
Split: 02, Run: 03
None time:  0.4113580361008644
None Run 06:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 69.10
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.2818376070354134
None Run 07:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 61.40
Split: 03, Run: 02
None time:  0.29913795785978436
None Run 08:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 61.40
Split: 03, Run: 03
None time:  0.3888051360845566
None Run 09:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 61.40
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.388330842833966
None Run 10:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 58.40
Split: 04, Run: 02
None time:  0.3920849091373384
None Run 11:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 58.40
Split: 04, Run: 03
None time:  0.4119257649872452
None Run 12:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 58.40
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.4042546001728624
None Run 13:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 61.80
Split: 05, Run: 02
None time:  0.40716566797345877
None Run 14:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 61.80
Split: 05, Run: 03
None time:  0.41789556108415127
None Run 15:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 61.80
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.4130281489342451
None Run 16:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 69.20
Split: 06, Run: 02
None time:  0.3731510580983013
None Run 17:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 69.20
Split: 06, Run: 03
None time:  0.4023674891795963
None Run 18:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 69.20
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.4041666032280773
None Run 19:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 68.70
Split: 07, Run: 02
None time:  0.4019172550179064
None Run 20:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 68.70
Split: 07, Run: 03
None time:  0.41385404695756733
None Run 21:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 68.70
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.3869915287941694
None Run 22:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 74.10
Split: 08, Run: 02
None time:  0.39125416497699916
None Run 23:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 74.10
Split: 08, Run: 03
None time:  0.4104842799715698
None Run 24:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 74.10
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  0.3980676531791687
None Run 25:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 70.60
Split: 09, Run: 02
None time:  0.29487706790678203
None Run 26:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 70.60
Split: 09, Run: 03
None time:  0.23615176603198051
None Run 27:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 70.60
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.4015918879304081
None Run 28:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 64.80
Split: 10, Run: 02
None time:  0.3984131559263915
None Run 29:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 64.80
Split: 10, Run: 03
None time:  0.4067271128296852
None Run 30:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 64.80
run time now: 1.2569360733032227
total time:  12.610530799021944
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 63.42 ± 6.67
  Final Train: 100.00 ± 0.00
   Final Test: 65.13 ± 6.17
best run test_acc: 65.12998962402344
[I 2023-06-12 00:20:20,850] Trial 11 finished with value: 63.41999435424805 and parameters: {'Fwd': 1.2372815257184356e-06, 'K': 10, 'alpha': 0.9500000000000001, 'dropout': 0.0, 'gnnepoch': 0, 'lambda1': 0.7000000000000001, 'lambda2': 5.46003610681937, 'loop': 0, 'loss': 'CE', 'lr': 0.002548777300649295, 'softmaxF': False, 'useGCN': True, 'weight_decay': 0.00018014064989133638, 'weightedloss': False}. Best is trial 9 with value: 68.54000091552734.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  0.7000000000000001
lr:  0.002463609208544426
weight_decay:  6.243671296546353e-05
dropout:  0.6000000000000001
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.6193427420221269
None Run 01:
Highest Train: 100.00
Highest Valid: 52.80
  Final Train: 100.00
   Final Test: 57.60
Split: 01, Run: 02
None time:  0.5600442059803754
None Run 02:
Highest Train: 100.00
Highest Valid: 50.60
  Final Train: 100.00
   Final Test: 52.40
Split: 01, Run: 03
None time:  0.5837368189822882
None Run 03:
Highest Train: 100.00
Highest Valid: 50.60
  Final Train: 100.00
   Final Test: 52.40
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.5266733439639211
None Run 04:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 67.60
Split: 02, Run: 02
None time:  0.5275433189235628
None Run 05:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 67.60
Split: 02, Run: 03
None time:  0.5382065090816468
None Run 06:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 67.60
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.5469350619241595
None Run 07:
Highest Train: 100.00
Highest Valid: 57.80
  Final Train: 100.00
   Final Test: 60.90
Split: 03, Run: 02
None time:  0.7495349030941725
None Run 08:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 64.50
Split: 03, Run: 03
None time:  1.2805478621739894
None Run 09:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 69.70
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.5431198128499091
None Run 10:
Highest Train: 100.00
Highest Valid: 56.60
  Final Train: 100.00
   Final Test: 58.40
Split: 04, Run: 02
None time:  0.6169126508757472
None Run 11:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 100.00
   Final Test: 53.20
Split: 04, Run: 03
None time:  1.164781134109944
None Run 12:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 80.00
   Final Test: 63.50
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.5355256248731166
None Run 13:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 60.80
Split: 05, Run: 02
None time:  0.5690466130618006
None Run 14:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 60.80
Split: 05, Run: 03
None time:  0.5567127568647265
None Run 15:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 60.80
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.5784312600735575
None Run 16:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 67.60
Split: 06, Run: 02
None time:  0.5427352099213749
None Run 17:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 67.60
Split: 06, Run: 03
None time:  0.5803263729903847
None Run 18:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 67.60
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.5895300719421357
None Run 19:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 66.00
Split: 07, Run: 02
None time:  0.6125434099230915
None Run 20:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 73.50
Split: 07, Run: 03
None time:  0.6982229519635439
None Run 21:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 71.30
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.5426026480272412
None Run 22:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 72.80
Split: 08, Run: 02
None time:  0.6224182068835944
None Run 23:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 74.60
Split: 08, Run: 03
None time:  0.6881003940943629
None Run 24:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 76.10
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  0.5301631779875606
None Run 25:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 70.00
Split: 09, Run: 02
None time:  0.5411844931077212
None Run 26:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 70.00
Split: 09, Run: 03
None time:  0.6866999419871718
None Run 27:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 71.70
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.558806971879676
None Run 28:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 64.90
Split: 10, Run: 02
None time:  0.5462298621423542
None Run 29:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 64.90
Split: 10, Run: 03
None time:  0.5974971128161997
None Run 30:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 64.90
run time now: 1.7498080730438232
total time:  19.940102396998554
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 64.70 ± 6.98
  Final Train: 99.33 ± 3.65
   Final Test: 65.38 ± 6.35
best run test_acc: 67.30000305175781
[I 2023-06-12 00:20:41,356] Trial 12 finished with value: 64.69999694824219 and parameters: {'Fwd': 1.4301077716504025e-06, 'K': 7, 'alpha': 0.7000000000000001, 'dropout': 0.6000000000000001, 'gnnepoch': 40, 'lambda1': 0.8, 'lambda2': 5.155962717152535, 'loop': 0, 'loss': 'CE', 'lr': 0.002463609208544426, 'softmaxF': False, 'useGCN': False, 'weight_decay': 6.243671296546353e-05, 'weightedloss': True}. Best is trial 9 with value: 68.54000091552734.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  4
alpha:  1.0
lr:  0.0003729800545174708
weight_decay:  0.07520769310718672
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.7202630469109863
None Run 01:
Highest Train: 100.00
Highest Valid: 50.80
  Final Train: 100.00
   Final Test: 54.00
Split: 01, Run: 02
None time:  1.736366491066292
None Run 02:
Highest Train: 100.00
Highest Valid: 54.80
  Final Train: 100.00
   Final Test: 55.40
Split: 01, Run: 03
None time:  1.7571069169789553
None Run 03:
Highest Train: 100.00
Highest Valid: 52.40
  Final Train: 100.00
   Final Test: 55.00
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.9022585600614548
None Run 04:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 63.20
Split: 02, Run: 02
None time:  1.7770277059171349
None Run 05:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 63.00
Split: 02, Run: 03
None time:  1.7675515660084784
None Run 06:
Highest Train: 100.00
Highest Valid: 56.40
  Final Train: 100.00
   Final Test: 60.60
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.7436830170918256
None Run 07:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 67.60
Split: 03, Run: 02
None time:  1.7289872409310192
None Run 08:
Highest Train: 100.00
Highest Valid: 67.40
  Final Train: 100.00
   Final Test: 68.60
Split: 03, Run: 03
None time:  1.7282882169820368
None Run 09:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 66.00
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.8250941459555179
None Run 10:
Highest Train: 100.00
Highest Valid: 59.80
  Final Train: 100.00
   Final Test: 57.50
Split: 04, Run: 02
None time:  1.7583109398838133
None Run 11:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 55.10
Split: 04, Run: 03
None time:  1.727346285013482
None Run 12:
Highest Train: 100.00
Highest Valid: 61.00
  Final Train: 100.00
   Final Test: 57.10
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.6863123399671167
None Run 13:
Highest Train: 100.00
Highest Valid: 48.00
  Final Train: 100.00
   Final Test: 45.60
Split: 05, Run: 02
None time:  1.7304195270407945
None Run 14:
Highest Train: 100.00
Highest Valid: 54.60
  Final Train: 100.00
   Final Test: 56.80
Split: 05, Run: 03
None time:  1.8085076829884201
None Run 15:
Highest Train: 100.00
Highest Valid: 57.40
  Final Train: 100.00
   Final Test: 57.00
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.8441095168236643
None Run 16:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 74.90
Split: 06, Run: 02
None time:  1.734926407923922
None Run 17:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 75.60
Split: 06, Run: 03
None time:  1.7224813848733902
None Run 18:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 74.10
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.47031035204418
None Run 19:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 71.50
Split: 07, Run: 02
None time:  2.029482644982636
None Run 20:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.80
Split: 07, Run: 03
None time:  1.861051315907389
None Run 21:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 63.30
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.7032626769505441
None Run 22:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 63.20
Split: 08, Run: 02
None time:  1.7000079159624875
None Run 23:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 63.20
Split: 08, Run: 03
None time:  1.4752025729976594
None Run 24:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 63.20
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.7146143619902432
None Run 25:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 72.40
Split: 09, Run: 02
None time:  1.7801399938762188
None Run 26:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 73.90
Split: 09, Run: 03
None time:  1.7301415370311588
None Run 27:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 71.60
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.6960923839360476
None Run 28:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 64.70
Split: 10, Run: 02
None time:  1.9497295641340315
None Run 29:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 66.20
Split: 10, Run: 03
None time:  1.9430184001103044
None Run 30:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 64.20
run time now: 5.628286361694336
total time:  54.72252744692378
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 63.79 ± 7.61
  Final Train: 100.00 ± 0.00
   Final Test: 63.88 ± 7.48
best run test_acc: 65.24000549316406
[I 2023-06-12 00:21:36,537] Trial 13 finished with value: 63.7933349609375 and parameters: {'Fwd': 1.2558325227820881e-05, 'K': 4, 'alpha': 1.0, 'dropout': 0.30000000000000004, 'gnnepoch': 80, 'lambda1': 0.55, 'lambda2': 8.132080188305848, 'loop': 1, 'loss': 'CE', 'lr': 0.0003729800545174708, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.07520769310718672, 'weightedloss': False}. Best is trial 9 with value: 68.54000091552734.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  10
alpha:  0.15000000000000002
lr:  0.004583997271230455
weight_decay:  1.9786200246152024e-05
dropout:  0.4
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.8755041100084782
None Run 01:
Highest Train: 100.00
Highest Valid: 49.80
  Final Train: 100.00
   Final Test: 53.20
Split: 01, Run: 02
None time:  0.9313903599977493
None Run 02:
Highest Train: 100.00
Highest Valid: 52.80
  Final Train: 100.00
   Final Test: 58.40
Split: 01, Run: 03
None time:  1.0677491559181362
None Run 03:
Highest Train: 100.00
Highest Valid: 51.80
  Final Train: 100.00
   Final Test: 56.00
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.8593428919557482
None Run 04:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 69.10
Split: 02, Run: 02
None time:  0.8551960960030556
None Run 05:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 69.10
Split: 02, Run: 03
None time:  0.8859782759100199
None Run 06:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 69.10
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.9243576100561768
None Run 07:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 69.20
Split: 03, Run: 02
None time:  0.9379284391179681
None Run 08:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 69.40
Split: 03, Run: 03
None time:  0.8629411070141941
None Run 09:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 65.40
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.8972679190337658
None Run 10:
Highest Train: 100.00
Highest Valid: 60.40
  Final Train: 100.00
   Final Test: 56.40
Split: 04, Run: 02
None time:  0.9676334061659873
None Run 11:
Highest Train: 100.00
Highest Valid: 60.20
  Final Train: 100.00
   Final Test: 57.90
Split: 04, Run: 03
None time:  0.9018440779764205
None Run 12:
Highest Train: 100.00
Highest Valid: 61.60
  Final Train: 100.00
   Final Test: 57.60
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.0610041348263621
None Run 13:
Highest Train: 100.00
Highest Valid: 63.00
  Final Train: 100.00
   Final Test: 64.00
Split: 05, Run: 02
None time:  0.8457463290542364
None Run 14:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 61.90
Split: 05, Run: 03
None time:  0.8561341669410467
None Run 15:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 61.90
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.8877978709060699
None Run 16:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 79.70
Split: 06, Run: 02
None time:  1.1133820109535009
None Run 17:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 79.20
Split: 06, Run: 03
None time:  1.0358261070214212
None Run 18:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 78.40
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.1178297651931643
None Run 19:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 73.10
Split: 07, Run: 02
None time:  1.1337760158348829
None Run 20:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 69.50
Split: 07, Run: 03
None time:  1.0607333129737526
None Run 21:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 68.60
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.8639325611293316
None Run 22:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 74.10
Split: 08, Run: 02
None time:  0.8498431129846722
None Run 23:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 74.10
Split: 08, Run: 03
None time:  1.0449984159786254
None Run 24:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 72.40
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  0.9292467990890145
None Run 25:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 72.80
Split: 09, Run: 02
None time:  0.8419864198658615
None Run 26:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 70.60
Split: 09, Run: 03
None time:  0.9253783910535276
None Run 27:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 74.80
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.979191173100844
None Run 28:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 65.00
Split: 10, Run: 02
None time:  0.9642716620583087
None Run 29:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 66.00
Split: 10, Run: 03
None time:  0.9522523509804159
None Run 30:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 68.60
run time now: 2.94315767288208
total time:  29.535926330834627
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 66.64 ± 7.09
  Final Train: 100.00 ± 0.00
   Final Test: 67.52 ± 7.14
best run test_acc: 68.90998840332031
[I 2023-06-12 00:22:06,607] Trial 14 finished with value: 66.63999938964844 and parameters: {'Fwd': 2.2888532780832207e-05, 'K': 10, 'alpha': 0.15000000000000002, 'dropout': 0.4, 'gnnepoch': 30, 'lambda1': 0.8500000000000001, 'lambda2': 6.428475343948481, 'loop': 0, 'loss': 'CE', 'lr': 0.004583997271230455, 'softmaxF': False, 'useGCN': True, 'weight_decay': 1.9786200246152024e-05, 'weightedloss': False}. Best is trial 9 with value: 68.54000091552734.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.05
lr:  0.006602318315783475
weight_decay:  9.430541847176234e-06
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.05)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.5240575720090419
None Run 01:
Highest Train: 100.00
Highest Valid: 49.80
  Final Train: 100.00
   Final Test: 52.40
Split: 01, Run: 02
None time:  0.5554678009357303
None Run 02:
Highest Train: 100.00
Highest Valid: 49.80
  Final Train: 100.00
   Final Test: 52.40
Split: 01, Run: 03
None time:  0.5393693591468036
None Run 03:
Highest Train: 100.00
Highest Valid: 49.80
  Final Train: 100.00
   Final Test: 52.40
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.05)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.5243389701936394
None Run 04:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 68.20
Split: 02, Run: 02
None time:  0.5153454821556807
None Run 05:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 68.20
Split: 02, Run: 03
None time:  0.5337348119355738
None Run 06:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 68.20
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.05)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.5468076770193875
None Run 07:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 61.00
Split: 03, Run: 02
None time:  0.5447410270571709
None Run 08:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 61.00
Split: 03, Run: 03
None time:  0.5164722688496113
None Run 09:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 61.00
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.05)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.5449638781137764
None Run 10:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 58.60
Split: 04, Run: 02
None time:  0.5432455518748611
None Run 11:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 58.60
Split: 04, Run: 03
None time:  0.5440023939590901
None Run 12:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 58.60
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.05)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.5294956408906728
None Run 13:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 60.20
Split: 05, Run: 02
None time:  0.5303115998394787
None Run 14:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 60.20
Split: 05, Run: 03
None time:  0.5190303400158882
None Run 15:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 60.20
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.05)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.5018589571118355
None Run 16:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 68.20
Split: 06, Run: 02
None time:  0.4560519400984049
None Run 17:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 68.20
Split: 06, Run: 03
None time:  0.5052652191370726
None Run 18:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 68.20
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.05)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.5077844269108027
None Run 19:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 67.30
Split: 07, Run: 02
None time:  0.5123006240464747
None Run 20:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 67.30
Split: 07, Run: 03
None time:  0.5446591309737414
None Run 21:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 67.30
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.05)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.5457174489274621
None Run 22:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 73.70
Split: 08, Run: 02
None time:  0.5449671500828117
None Run 23:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 73.70
Split: 08, Run: 03
None time:  0.5247971778735518
None Run 24:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 73.70
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.05)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  0.5160148339346051
None Run 25:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 69.90
Split: 09, Run: 02
None time:  0.5649915370158851
None Run 26:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 69.90
Split: 09, Run: 03
None time:  0.5153528000228107
None Run 27:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 69.90
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.05)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.5260545730125159
None Run 28:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 64.80
Split: 10, Run: 02
None time:  0.5205065018963069
None Run 29:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 64.80
Split: 10, Run: 03
None time:  0.5319977591279894
None Run 30:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 64.80
run time now: 1.625854253768921
total time:  17.036795421037823
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 63.02 ± 6.58
  Final Train: 100.00 ± 0.00
   Final Test: 64.43 ± 6.11
best run test_acc: 64.43000030517578
[I 2023-06-12 00:22:24,044] Trial 15 finished with value: 63.02000045776367 and parameters: {'Fwd': 2.0288718470451464e-05, 'K': 8, 'alpha': 0.05, 'dropout': 0.1, 'gnnepoch': 20, 'lambda1': 1.0, 'lambda2': 3.89837544224505, 'loop': 1, 'loss': 'CE', 'lr': 0.006602318315783475, 'softmaxF': True, 'useGCN': False, 'weight_decay': 9.430541847176234e-06, 'weightedloss': True}. Best is trial 9 with value: 68.54000091552734.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  5
alpha:  0.15000000000000002
lr:  0.0050533517744895135
weight_decay:  1.0761611936293483e-06
dropout:  0.9
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.7522225880529732
None Run 01:
Highest Train: 100.00
Highest Valid: 55.60
  Final Train: 100.00
   Final Test: 59.00
Split: 01, Run: 02
None time:  1.733122554142028
None Run 02:
Highest Train: 100.00
Highest Valid: 56.00
  Final Train: 100.00
   Final Test: 59.30
Split: 01, Run: 03
None time:  1.6836149799637496
None Run 03:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 59.90
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.7036796079482883
None Run 04:
Highest Train: 100.00
Highest Valid: 61.60
  Final Train: 100.00
   Final Test: 64.00
Split: 02, Run: 02
None time:  1.6902523960452527
None Run 05:
Highest Train: 100.00
Highest Valid: 61.00
  Final Train: 100.00
   Final Test: 63.90
Split: 02, Run: 03
None time:  1.7138803550042212
None Run 06:
Highest Train: 100.00
Highest Valid: 61.20
  Final Train: 100.00
   Final Test: 64.60
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.7230093218386173
None Run 07:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 69.70
Split: 03, Run: 02
None time:  1.6040463908575475
None Run 08:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 69.80
Split: 03, Run: 03
None time:  1.4772999631240964
None Run 09:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 69.40
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.6805298728868365
None Run 10:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 58.60
Split: 04, Run: 02
None time:  1.7352823270484805
None Run 11:
Highest Train: 100.00
Highest Valid: 55.40
  Final Train: 100.00
   Final Test: 56.50
Split: 04, Run: 03
None time:  1.8841059659607708
None Run 12:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 55.30
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.9072937788441777
None Run 13:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 65.40
Split: 05, Run: 02
None time:  1.958538749953732
None Run 14:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 65.30
Split: 05, Run: 03
None time:  1.725737967994064
None Run 15:
Highest Train: 100.00
Highest Valid: 60.80
  Final Train: 100.00
   Final Test: 62.90
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.6221561299171299
None Run 16:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 78.90
Split: 06, Run: 02
None time:  1.7166495299898088
None Run 17:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 79.10
Split: 06, Run: 03
None time:  1.7126803330611438
None Run 18:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 79.00
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.8873079160694033
None Run 19:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 70.00
Split: 07, Run: 02
None time:  1.8030120918992907
None Run 20:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 70.40
Split: 07, Run: 03
None time:  2.034430465195328
None Run 21:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 72.30
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.805717479903251
None Run 22:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 75.90
Split: 08, Run: 02
None time:  1.8715078900568187
None Run 23:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 77.50
Split: 08, Run: 03
None time:  1.7678105821833014
None Run 24:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 76.50
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.7432742682285607
None Run 25:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 70.60
Split: 09, Run: 02
None time:  1.7609592929948121
None Run 26:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 75.80
Split: 09, Run: 03
None time:  1.7455777178984135
None Run 27:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 74.70
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.15000000000000002)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.6938865568954498
None Run 28:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 67.70
Split: 10, Run: 02
None time:  1.6410149240400642
None Run 29:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 66.20
Split: 10, Run: 03
None time:  1.746734308078885
None Run 30:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 68.90
run time now: 5.122920751571655
total time:  53.59478030214086
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 67.84 ± 7.37
  Final Train: 100.00 ± 0.00
   Final Test: 68.24 ± 7.02
best run test_acc: 69.18999481201172
[I 2023-06-12 00:23:18,148] Trial 16 finished with value: 67.84000396728516 and parameters: {'Fwd': 3.152553995620677e-05, 'K': 5, 'alpha': 0.15000000000000002, 'dropout': 0.9, 'gnnepoch': 90, 'lambda1': 0.8500000000000001, 'lambda2': 6.232777915405972, 'loop': 0, 'loss': 'CE', 'lr': 0.0050533517744895135, 'softmaxF': False, 'useGCN': True, 'weight_decay': 1.0761611936293483e-06, 'weightedloss': True}. Best is trial 9 with value: 68.54000091552734.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  5
alpha:  0.8500000000000001
lr:  0.009426570078021569
weight_decay:  1.0059672416071243e-06
dropout:  0.9
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.1606956420000643
None Run 01:
Highest Train: 100.00
Highest Valid: 52.20
  Final Train: 100.00
   Final Test: 54.20
Split: 01, Run: 02
None time:  1.2840418571140617
None Run 02:
Highest Train: 100.00
Highest Valid: 52.20
  Final Train: 100.00
   Final Test: 54.20
Split: 01, Run: 03
None time:  1.252116644056514
None Run 03:
Highest Train: 100.00
Highest Valid: 52.20
  Final Train: 100.00
   Final Test: 54.20
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.3969381570350379
None Run 04:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 69.60
Split: 02, Run: 02
None time:  1.5066783961374313
None Run 05:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 69.60
Split: 02, Run: 03
None time:  1.4541867380030453
None Run 06:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 69.60
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.3215056869667023
None Run 07:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 63.50
Split: 03, Run: 02
None time:  1.4344701410736889
None Run 08:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 63.50
Split: 03, Run: 03
None time:  1.3179585859179497
None Run 09:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 63.50
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.1425961218774319
None Run 10:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 58.60
Split: 04, Run: 02
None time:  1.2452473910525441
None Run 11:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 58.60
Split: 04, Run: 03
None time:  1.1948849158361554
None Run 12:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 58.60
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.5344142611138523
None Run 13:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 71.30
Split: 05, Run: 02
None time:  1.6266794439870864
None Run 14:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 71.30
Split: 05, Run: 03
None time:  1.5113592729903758
None Run 15:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 71.30
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  2.052991342963651
None Run 16:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 71.40
Split: 06, Run: 02
None time:  2.1738450811244547
None Run 17:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 71.40
Split: 06, Run: 03
None time:  2.089021557942033
None Run 18:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 71.40
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.4528752171900123
None Run 19:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 72.50
Split: 07, Run: 02
None time:  1.444679883075878
None Run 20:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 72.50
Split: 07, Run: 03
None time:  1.3969364049844444
None Run 21:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 72.50
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.3213727630209178
None Run 22:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 74.60
Split: 08, Run: 02
None time:  1.1975997749250382
None Run 23:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 74.60
Split: 08, Run: 03
None time:  1.255731004057452
None Run 24:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 74.60
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.2084761729929596
None Run 25:
Highest Train: 100.00
Highest Valid: 78.80
  Final Train: 100.00
   Final Test: 74.40
Split: 09, Run: 02
None time:  2.3094961680471897
None Run 26:
Highest Train: 100.00
Highest Valid: 78.80
  Final Train: 100.00
   Final Test: 74.40
Split: 09, Run: 03
None time:  2.3629397640470415
None Run 27:
Highest Train: 100.00
Highest Valid: 78.80
  Final Train: 100.00
   Final Test: 74.40
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.3925760879646987
None Run 28:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 66.20
Split: 10, Run: 02
None time:  1.344963851151988
None Run 29:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 66.20
Split: 10, Run: 03
None time:  1.3059826828539371
None Run 30:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 66.20
run time now: 4.086456298828125
total time:  46.98875642800704
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 67.04 ± 7.71
  Final Train: 100.00 ± 0.00
   Final Test: 67.63 ± 6.67
best run test_acc: 67.62999725341797
[I 2023-06-12 00:24:05,677] Trial 17 finished with value: 67.04000091552734 and parameters: {'Fwd': 6.947013830902677e-05, 'K': 5, 'alpha': 0.8500000000000001, 'dropout': 0.9, 'gnnepoch': 90, 'lambda1': 0.0, 'lambda2': 1.786937887348523, 'loop': 2, 'loss': 'CE', 'lr': 0.009426570078021569, 'softmaxF': True, 'useGCN': False, 'weight_decay': 1.0059672416071243e-06, 'weightedloss': True}. Best is trial 9 with value: 68.54000091552734.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  3
alpha:  0.2
lr:  0.004526990291509667
weight_decay:  3.7671824264622772e-06
dropout:  0.9
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.061173730995506
None Run 01:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 62.60
Split: 01, Run: 02
None time:  2.159697514027357
None Run 02:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 61.70
Split: 01, Run: 03
None time:  2.4812721938360482
None Run 03:
Highest Train: 100.00
Highest Valid: 62.00
  Final Train: 100.00
   Final Test: 61.70
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.9842488400172442
None Run 04:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 67.40
Split: 02, Run: 02
None time:  2.180933275958523
None Run 05:
Highest Train: 100.00
Highest Valid: 60.20
  Final Train: 100.00
   Final Test: 64.70
Split: 02, Run: 03
None time:  2.0793376120273024
None Run 06:
Highest Train: 100.00
Highest Valid: 62.20
  Final Train: 100.00
   Final Test: 67.00
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  2.1056780950166285
None Run 07:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 70.50
Split: 03, Run: 02
None time:  2.156838280148804
None Run 08:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 70.10
Split: 03, Run: 03
None time:  2.1457731910049915
None Run 09:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 70.20
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  2.066428337013349
None Run 10:
Highest Train: 100.00
Highest Valid: 55.80
  Final Train: 100.00
   Final Test: 55.10
Split: 04, Run: 02
None time:  2.1875570458360016
None Run 11:
Highest Train: 100.00
Highest Valid: 58.00
  Final Train: 100.00
   Final Test: 58.80
Split: 04, Run: 03
None time:  2.172420456074178
None Run 12:
Highest Train: 100.00
Highest Valid: 60.40
  Final Train: 100.00
   Final Test: 58.20
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  2.172757449094206
None Run 13:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 67.00
Split: 05, Run: 02
None time:  2.507389541948214
None Run 14:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 68.60
Split: 05, Run: 03
None time:  2.4598200148902833
None Run 15:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 66.20
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  2.0785120090004057
None Run 16:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 80.20
Split: 06, Run: 02
None time:  1.860776538029313
None Run 17:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 76.10
Split: 06, Run: 03
None time:  2.1120560171548277
None Run 18:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 79.70
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.3655226649716496
None Run 19:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 70.10
Split: 07, Run: 02
None time:  2.5655892118811607
None Run 20:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 69.70
Split: 07, Run: 03
None time:  3.1469154360238463
None Run 21:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 70.90
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  2.3781116551253945
None Run 22:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 77.40
Split: 08, Run: 02
None time:  2.343106823042035
None Run 23:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 77.20
Split: 08, Run: 03
None time:  2.268355834065005
None Run 24:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 76.20
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.2354977619834244
None Run 25:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 76.20
Split: 09, Run: 02
None time:  2.0782493848819286
None Run 26:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 73.90
Split: 09, Run: 03
None time:  2.103202108060941
None Run 27:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 74.60
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  2.214944653213024
None Run 28:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 69.20
Split: 10, Run: 02
None time:  2.1692356928251684
None Run 29:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 68.60
Split: 10, Run: 03
None time:  2.094245917862281
None Run 30:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 66.90
run time now: 6.51622462272644
total time:  68.00167677295394
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 68.84 ± 6.69
  Final Train: 100.00 ± 0.00
   Final Test: 69.22 ± 6.43
best run test_acc: 70.18000793457031
[I 2023-06-12 00:25:14,117] Trial 18 finished with value: 68.83999633789062 and parameters: {'Fwd': 5.579919607764107e-06, 'K': 3, 'alpha': 0.2, 'dropout': 0.9, 'gnnepoch': 120, 'lambda1': 0.45, 'lambda2': 5.885789018934359, 'loop': 0, 'loss': 'CE', 'lr': 0.004526990291509667, 'softmaxF': True, 'useGCN': True, 'weight_decay': 3.7671824264622772e-06, 'weightedloss': True}. Best is trial 18 with value: 68.83999633789062.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  3
alpha:  0.25
lr:  0.0037754030688246106
weight_decay:  4.753280476936219e-06
dropout:  0.7000000000000001
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.2482018570881337
None Run 01:
Highest Train: 100.00
Highest Valid: 57.80
  Final Train: 100.00
   Final Test: 58.20
Split: 01, Run: 02
None time:  1.282561605097726
None Run 02:
Highest Train: 100.00
Highest Valid: 58.00
  Final Train: 100.00
   Final Test: 60.30
Split: 01, Run: 03
None time:  1.3230235818773508
None Run 03:
Highest Train: 100.00
Highest Valid: 55.00
  Final Train: 100.00
   Final Test: 58.60
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.3182559709530324
None Run 04:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 62.50
Split: 02, Run: 02
None time:  1.2588102060835809
None Run 05:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 60.80
Split: 02, Run: 03
None time:  1.3224516049958766
None Run 06:
Highest Train: 100.00
Highest Valid: 58.20
  Final Train: 93.33
   Final Test: 63.60
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.349237646907568
None Run 07:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 64.20
Split: 03, Run: 02
None time:  1.4607910988852382
None Run 08:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 65.40
Split: 03, Run: 03
None time:  1.2987187739927322
None Run 09:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.00
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.343722727149725
None Run 10:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 55.90
Split: 04, Run: 02
None time:  1.347337630810216
None Run 11:
Highest Train: 100.00
Highest Valid: 55.40
  Final Train: 100.00
   Final Test: 53.40
Split: 04, Run: 03
None time:  1.2878844838123769
None Run 12:
Highest Train: 100.00
Highest Valid: 58.20
  Final Train: 100.00
   Final Test: 56.60
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.505989306839183
None Run 13:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 71.80
Split: 05, Run: 02
None time:  1.320422989083454
None Run 14:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 69.40
Split: 05, Run: 03
None time:  1.2655902949627489
None Run 15:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 67.50
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.485652495874092
None Run 16:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 78.10
Split: 06, Run: 02
None time:  1.3372227891813964
None Run 17:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 80.50
Split: 06, Run: 03
None time:  1.283703143009916
None Run 18:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 79.20
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.6498546190559864
None Run 19:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 93.33
   Final Test: 73.40
Split: 07, Run: 02
None time:  1.4248379259370267
None Run 20:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 74.20
Split: 07, Run: 03
None time:  1.331695717992261
None Run 21:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 76.10
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.465892578009516
None Run 22:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 67.50
Split: 08, Run: 02
None time:  1.4257928680162877
None Run 23:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 69.70
Split: 08, Run: 03
None time:  1.2675870549865067
None Run 24:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 72.00
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.246893378905952
None Run 25:
Highest Train: 100.00
Highest Valid: 79.20
  Final Train: 100.00
   Final Test: 73.70
Split: 09, Run: 02
None time:  1.352777061983943
None Run 26:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 74.10
Split: 09, Run: 03
None time:  1.2333702868781984
None Run 27:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.10
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.4189309608191252
None Run 28:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 69.80
Split: 10, Run: 02
None time:  1.6596440959256142
None Run 29:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 80.00
   Final Test: 70.20
Split: 10, Run: 03
None time:  1.3381934359204024
None Run 30:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 70.30
run time now: 4.4544947147369385
total time:  41.87297403300181
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 68.30 ± 7.99
  Final Train: 98.89 ± 3.95
   Final Test: 67.97 ± 7.22
best run test_acc: 69.62999725341797
[I 2023-06-12 00:25:56,505] Trial 19 finished with value: 68.30000305175781 and parameters: {'Fwd': 4.954160818895868e-06, 'K': 3, 'alpha': 0.25, 'dropout': 0.7000000000000001, 'gnnepoch': 120, 'lambda1': 0.45, 'lambda2': 4.224530618709653, 'loop': 1, 'loss': 'CE', 'lr': 0.0037754030688246106, 'softmaxF': True, 'useGCN': False, 'weight_decay': 4.753280476936219e-06, 'weightedloss': True}. Best is trial 18 with value: 68.83999633789062.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  3
alpha:  0.65
lr:  0.0013336524842399848
weight_decay:  2.3062742467665403e-05
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.1462158630602062
None Run 01:
Highest Train: 100.00
Highest Valid: 52.60
  Final Train: 100.00
   Final Test: 54.80
Split: 01, Run: 02
None time:  1.2037153760902584
None Run 02:
Highest Train: 100.00
Highest Valid: 46.00
  Final Train: 100.00
   Final Test: 51.60
Split: 01, Run: 03
None time:  1.236978200962767
None Run 03:
Highest Train: 100.00
Highest Valid: 46.00
  Final Train: 100.00
   Final Test: 50.90
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.2012420080136508
None Run 04:
Highest Train: 100.00
Highest Valid: 63.00
  Final Train: 100.00
   Final Test: 65.20
Split: 02, Run: 02
None time:  1.1943388599902391
None Run 05:
Highest Train: 100.00
Highest Valid: 60.40
  Final Train: 100.00
   Final Test: 65.70
Split: 02, Run: 03
None time:  1.246040094876662
None Run 06:
Highest Train: 100.00
Highest Valid: 58.20
  Final Train: 100.00
   Final Test: 63.30
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.3227502130903304
None Run 07:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 69.70
Split: 03, Run: 02
None time:  1.1841320618987083
None Run 08:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 63.30
Split: 03, Run: 03
None time:  1.2177204748149961
None Run 09:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 63.40
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.0690700560808182
None Run 10:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 54.30
Split: 04, Run: 02
None time:  1.0788365569896996
None Run 11:
Highest Train: 100.00
Highest Valid: 56.40
  Final Train: 100.00
   Final Test: 52.90
Split: 04, Run: 03
None time:  1.1802288859616965
None Run 12:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 100.00
   Final Test: 53.90
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.1774441320449114
None Run 13:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 60.20
Split: 05, Run: 02
None time:  1.479607661953196
None Run 14:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 64.90
Split: 05, Run: 03
None time:  1.5733626359142363
None Run 15:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 68.90
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.1100428791251034
None Run 16:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 71.50
Split: 06, Run: 02
None time:  1.2540078689344227
None Run 17:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 69.60
Split: 06, Run: 03
None time:  1.1962325479835272
None Run 18:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 66.80
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.3635257401037961
None Run 19:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 74.80
Split: 07, Run: 02
None time:  1.2897204388864338
None Run 20:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 74.40
Split: 07, Run: 03
None time:  1.2999699439387769
None Run 21:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 72.10
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.1398573231417686
None Run 22:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 76.40
Split: 08, Run: 02
None time:  1.3999768740031868
None Run 23:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 75.50
Split: 08, Run: 03
None time:  1.2923089100513607
None Run 24:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 74.60
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.1139849920291454
None Run 25:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 76.10
Split: 09, Run: 02
None time:  1.1893008819315583
None Run 26:
Highest Train: 100.00
Highest Valid: 80.20
  Final Train: 100.00
   Final Test: 76.20
Split: 09, Run: 03
None time:  1.1753088140394539
None Run 27:
Highest Train: 100.00
Highest Valid: 80.40
  Final Train: 100.00
   Final Test: 75.30
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.2304178930353373
None Run 28:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 69.20
Split: 10, Run: 02
None time:  1.2796758839394897
None Run 29:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 68.80
Split: 10, Run: 03
None time:  1.5193464029580355
None Run 30:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 70.20
run time now: 4.068203926086426
total time:  38.394969541113824
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 66.87 ± 9.28
  Final Train: 100.00 ± 0.00
   Final Test: 66.48 ± 8.13
best run test_acc: 68.25000762939453
[I 2023-06-12 00:26:35,447] Trial 20 finished with value: 66.87333679199219 and parameters: {'Fwd': 4.767003153321901e-06, 'K': 3, 'alpha': 0.65, 'dropout': 0.1, 'gnnepoch': 120, 'lambda1': 0.2, 'lambda2': 5.305749989458677, 'loop': 0, 'loss': 'CE', 'lr': 0.0013336524842399848, 'softmaxF': True, 'useGCN': False, 'weight_decay': 2.3062742467665403e-05, 'weightedloss': True}. Best is trial 18 with value: 68.83999633789062.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  3
alpha:  0.2
lr:  0.003541261226115547
weight_decay:  3.886274565224732e-06
dropout:  0.7000000000000001
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.3047873061150312
None Run 01:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 59.50
Split: 01, Run: 02
None time:  1.2589143719524145
None Run 02:
Highest Train: 100.00
Highest Valid: 54.20
  Final Train: 100.00
   Final Test: 57.60
Split: 01, Run: 03
None time:  1.1614274908788502
None Run 03:
Highest Train: 100.00
Highest Valid: 47.60
  Final Train: 100.00
   Final Test: 51.80
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.3938714449759573
None Run 04:
Highest Train: 100.00
Highest Valid: 58.20
  Final Train: 93.33
   Final Test: 60.70
Split: 02, Run: 02
None time:  1.7103386449161917
None Run 05:
Highest Train: 100.00
Highest Valid: 55.80
  Final Train: 86.67
   Final Test: 59.90
Split: 02, Run: 03
None time:  1.3963193739764392
None Run 06:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 93.33
   Final Test: 63.20
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.3756699981167912
None Run 07:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 61.00
Split: 03, Run: 02
None time:  1.227363440906629
None Run 08:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 57.70
Split: 03, Run: 03
None time:  1.2112548870500177
None Run 09:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 61.00
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.2867232661228627
None Run 10:
Highest Train: 100.00
Highest Valid: 57.40
  Final Train: 100.00
   Final Test: 53.70
Split: 04, Run: 02
None time:  1.2848459279630333
None Run 11:
Highest Train: 100.00
Highest Valid: 57.60
  Final Train: 100.00
   Final Test: 53.90
Split: 04, Run: 03
None time:  1.2972278429660946
None Run 12:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 54.90
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.4133902080357075
None Run 13:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 62.70
Split: 05, Run: 02
None time:  1.495377338025719
None Run 14:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 80.00
   Final Test: 67.60
Split: 05, Run: 03
None time:  1.0293390059377998
None Run 15:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 70.30
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.5304505750536919
None Run 16:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 80.00
Split: 06, Run: 02
None time:  1.1723966300487518
None Run 17:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 70.20
Split: 06, Run: 03
None time:  1.3856659829616547
None Run 18:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 74.60
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.3875221230555326
None Run 19:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 86.67
   Final Test: 73.30
Split: 07, Run: 02
None time:  1.7839495611842722
None Run 20:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 86.67
   Final Test: 73.40
Split: 07, Run: 03
None time:  1.3789678760804236
None Run 21:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 75.30
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.7373901309911162
None Run 22:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 73.50
Split: 08, Run: 02
None time:  1.3216364670079201
None Run 23:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 75.20
Split: 08, Run: 03
None time:  1.1699595630634576
None Run 24:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 73.90
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.3341208698693663
None Run 25:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 70.90
Split: 09, Run: 02
None time:  1.3162066990043968
None Run 26:
Highest Train: 100.00
Highest Valid: 78.80
  Final Train: 100.00
   Final Test: 73.90
Split: 09, Run: 03
None time:  1.3283835910260677
None Run 27:
Highest Train: 100.00
Highest Valid: 79.40
  Final Train: 100.00
   Final Test: 74.10
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.3858834549319
None Run 28:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 65.80
Split: 10, Run: 02
None time:  1.3336180709302425
None Run 29:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 69.20
Split: 10, Run: 03
None time:  1.2870646249502897
None Run 30:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 71.30
run time now: 4.046044826507568
total time:  42.737169465981424
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 67.44 ± 8.49
  Final Train: 97.56 ± 5.39
   Final Test: 66.34 ± 7.95
best run test_acc: 68.47999572753906
[I 2023-06-12 00:27:18,663] Trial 21 finished with value: 67.43999481201172 and parameters: {'Fwd': 4.26822475154697e-06, 'K': 3, 'alpha': 0.2, 'dropout': 0.7000000000000001, 'gnnepoch': 120, 'lambda1': 0.45, 'lambda2': 3.5612571970229885, 'loop': 1, 'loss': 'CE', 'lr': 0.003541261226115547, 'softmaxF': True, 'useGCN': False, 'weight_decay': 3.886274565224732e-06, 'weightedloss': True}. Best is trial 18 with value: 68.83999633789062.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  3
alpha:  0.30000000000000004
lr:  0.003921576514619994
weight_decay:  4.366859303601523e-06
dropout:  0.7000000000000001
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.4517830810509622
None Run 01:
Highest Train: 100.00
Highest Valid: 55.80
  Final Train: 100.00
   Final Test: 55.00
Split: 01, Run: 02
None time:  1.302734007826075
None Run 02:
Highest Train: 100.00
Highest Valid: 49.40
  Final Train: 100.00
   Final Test: 51.30
Split: 01, Run: 03
None time:  1.3448918408248574
None Run 03:
Highest Train: 100.00
Highest Valid: 49.40
  Final Train: 100.00
   Final Test: 49.00
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.463022158946842
None Run 04:
Highest Train: 100.00
Highest Valid: 56.00
  Final Train: 100.00
   Final Test: 58.10
Split: 02, Run: 02
None time:  1.3328999429941177
None Run 05:
Highest Train: 100.00
Highest Valid: 55.60
  Final Train: 100.00
   Final Test: 56.10
Split: 02, Run: 03
None time:  1.3841554599348456
None Run 06:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 64.50
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.7068023669999093
None Run 07:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 86.67
   Final Test: 62.20
Split: 03, Run: 02
None time:  1.4124115069862455
None Run 08:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 65.10
Split: 03, Run: 03
None time:  1.5122057171538472
None Run 09:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 65.30
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.5178115519229323
None Run 10:
Highest Train: 100.00
Highest Valid: 57.60
  Final Train: 100.00
   Final Test: 57.80
Split: 04, Run: 02
None time:  1.9467429390642792
None Run 11:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 80.00
   Final Test: 59.50
Split: 04, Run: 03
None time:  1.389957904117182
None Run 12:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 63.70
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  2.019242957001552
None Run 13:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 68.10
Split: 05, Run: 02
None time:  1.4189945759717375
None Run 14:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 69.10
Split: 05, Run: 03
None time:  1.3784292680211365
None Run 15:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 68.70
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.6712295031175017
None Run 16:
Highest Train: 100.00
Highest Valid: 61.60
  Final Train: 100.00
   Final Test: 65.50
Split: 06, Run: 02
None time:  2.3032893259078264
None Run 17:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 66.67
   Final Test: 71.00
Split: 06, Run: 03
None time:  1.3674210337921977
None Run 18:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 74.10
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.4503097338601947
None Run 19:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 68.30
Split: 07, Run: 02
None time:  1.4114366460125893
None Run 20:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 74.30
Split: 07, Run: 03
None time:  1.5309157480951399
None Run 21:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 75.40
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.4062442351132631
None Run 22:
Highest Train: 100.00
Highest Valid: 60.20
  Final Train: 100.00
   Final Test: 58.20
Split: 08, Run: 02
None time:  1.3821295569650829
None Run 23:
Highest Train: 100.00
Highest Valid: 61.40
  Final Train: 100.00
   Final Test: 60.20
Split: 08, Run: 03
None time:  1.4011350830551237
None Run 24:
Highest Train: 100.00
Highest Valid: 60.80
  Final Train: 100.00
   Final Test: 60.80
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.3092673351056874
None Run 25:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 65.90
Split: 09, Run: 02
None time:  1.3567211381159723
None Run 26:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 63.80
Split: 09, Run: 03
None time:  1.3142402542289346
None Run 27:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 63.20
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  2.159784866962582
None Run 28:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 80.00
   Final Test: 68.50
Split: 10, Run: 02
None time:  1.5394892930053174
None Run 29:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 71.10
Split: 10, Run: 03
None time:  1.3497621838469058
None Run 30:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 69.10
run time now: 5.108063459396362
total time:  46.63806636095978
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 65.67 ± 7.63
  Final Train: 97.11 ± 7.96
   Final Test: 64.10 ± 6.60
best run test_acc: 66.49000549316406
[I 2023-06-12 00:28:05,846] Trial 22 finished with value: 65.67333221435547 and parameters: {'Fwd': 6.677831564681879e-06, 'K': 3, 'alpha': 0.30000000000000004, 'dropout': 0.7000000000000001, 'gnnepoch': 120, 'lambda1': 0.4, 'lambda2': 4.321576589497344, 'loop': 2, 'loss': 'CE', 'lr': 0.003921576514619994, 'softmaxF': True, 'useGCN': False, 'weight_decay': 4.366859303601523e-06, 'weightedloss': True}. Best is trial 18 with value: 68.83999633789062.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  2
alpha:  0.25
lr:  0.006364214575865707
weight_decay:  1.140105463196551e-06
dropout:  0.8
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.0940554689150304
None Run 01:
Highest Train: 100.00
Highest Valid: 56.20
  Final Train: 100.00
   Final Test: 54.20
Split: 01, Run: 02
None time:  0.9982359251007438
None Run 02:
Highest Train: 100.00
Highest Valid: 52.60
  Final Train: 100.00
   Final Test: 54.10
Split: 01, Run: 03
None time:  1.0821339669637382
None Run 03:
Highest Train: 100.00
Highest Valid: 46.20
  Final Train: 100.00
   Final Test: 49.30
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.1509643059689552
None Run 04:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 62.30
Split: 02, Run: 02
None time:  1.1463381201028824
None Run 05:
Highest Train: 100.00
Highest Valid: 53.40
  Final Train: 100.00
   Final Test: 57.90
Split: 02, Run: 03
None time:  1.060746599920094
None Run 06:
Highest Train: 100.00
Highest Valid: 54.40
  Final Train: 100.00
   Final Test: 58.00
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1721803511027247
None Run 07:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 64.00
Split: 03, Run: 02
None time:  1.3651059530675411
None Run 08:
Highest Train: 100.00
Highest Valid: 81.80
  Final Train: 93.33
   Final Test: 80.40
Split: 03, Run: 03
None time:  1.2557350869756192
None Run 09:
Highest Train: 100.00
Highest Valid: 81.60
  Final Train: 93.33
   Final Test: 81.30
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.1172953671775758
None Run 10:
Highest Train: 100.00
Highest Valid: 58.00
  Final Train: 100.00
   Final Test: 54.20
Split: 04, Run: 02
None time:  1.186607746174559
None Run 11:
Highest Train: 100.00
Highest Valid: 56.20
  Final Train: 100.00
   Final Test: 52.20
Split: 04, Run: 03
None time:  1.0848699400667101
None Run 12:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 54.40
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.313146447064355
None Run 13:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 93.33
   Final Test: 66.80
Split: 05, Run: 02
None time:  1.6260809400118887
None Run 14:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 66.67
   Final Test: 70.90
Split: 05, Run: 03
None time:  1.1404866289813071
None Run 15:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 71.60
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.2007828708738089
None Run 16:
Highest Train: 100.00
Highest Valid: 62.40
  Final Train: 100.00
   Final Test: 63.40
Split: 06, Run: 02
None time:  1.5752345828805119
None Run 17:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 93.33
   Final Test: 74.10
Split: 06, Run: 03
None time:  1.1123626860789955
None Run 18:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 76.10
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.2680710409767926
None Run 19:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 68.60
Split: 07, Run: 02
None time:  1.385316336993128
None Run 20:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 68.50
Split: 07, Run: 03
None time:  1.2558505339547992
None Run 21:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 66.70
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.4915370622184128
None Run 22:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 72.00
Split: 08, Run: 02
None time:  1.0597837748937309
None Run 23:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 73.00
Split: 08, Run: 03
None time:  1.0917453069705516
None Run 24:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 74.10
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.0698279268108308
None Run 25:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 66.50
Split: 09, Run: 02
None time:  1.0278065190650523
None Run 26:
Highest Train: 100.00
Highest Valid: 56.40
  Final Train: 100.00
   Final Test: 54.50
Split: 09, Run: 03
None time:  1.0276905240025371
None Run 27:
Highest Train: 100.00
Highest Valid: 62.20
  Final Train: 100.00
   Final Test: 61.70
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.7277840070892125
None Run 28:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 80.00
   Final Test: 68.90
Split: 10, Run: 02
None time:  1.1568821968976408
None Run 29:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 71.80
Split: 10, Run: 03
None time:  1.2256133230403066
None Run 30:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 71.30
run time now: 4.147360801696777
total time:  37.47769333003089
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 65.94 ± 9.38
  Final Train: 97.33 ± 7.13
   Final Test: 65.43 ± 8.75
best run test_acc: 68.08999633789062
[I 2023-06-12 00:28:43,750] Trial 23 finished with value: 65.93999481201172 and parameters: {'Fwd': 3.042790005978152e-06, 'K': 2, 'alpha': 0.25, 'dropout': 0.8, 'gnnepoch': 100, 'lambda1': 0.55, 'lambda2': 4.433644533214264, 'loop': 1, 'loss': 'CE', 'lr': 0.006364214575865707, 'softmaxF': True, 'useGCN': False, 'weight_decay': 1.140105463196551e-06, 'weightedloss': True}. Best is trial 18 with value: 68.83999633789062.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  2
alpha:  0.1
lr:  0.0029900930145514717
weight_decay:  8.207468961245999e-06
dropout:  0.9
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.8356330348178744
None Run 01:
Highest Train: 100.00
Highest Valid: 57.60
  Final Train: 100.00
   Final Test: 56.70
Split: 01, Run: 02
None time:  0.9823302491568029
None Run 02:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 63.70
Split: 01, Run: 03
None time:  0.909229690907523
None Run 03:
Highest Train: 100.00
Highest Valid: 55.80
  Final Train: 100.00
   Final Test: 56.30
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.9962794210296124
None Run 04:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 56.70
Split: 02, Run: 02
None time:  0.749998491955921
None Run 05:
Highest Train: 100.00
Highest Valid: 48.40
  Final Train: 100.00
   Final Test: 47.40
Split: 02, Run: 03
None time:  1.0514758189674467
None Run 06:
Highest Train: 100.00
Highest Valid: 61.40
  Final Train: 100.00
   Final Test: 65.30
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.9459513700567186
None Run 07:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 64.40
Split: 03, Run: 02
None time:  0.9220903031527996
None Run 08:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 66.80
Split: 03, Run: 03
None time:  0.9797288379631937
None Run 09:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 63.60
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.935383150819689
None Run 10:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 54.20
Split: 04, Run: 02
None time:  0.8215930820442736
None Run 11:
Highest Train: 100.00
Highest Valid: 52.00
  Final Train: 100.00
   Final Test: 51.10
Split: 04, Run: 03
None time:  1.1787041008938104
None Run 12:
Highest Train: 100.00
Highest Valid: 52.60
  Final Train: 100.00
   Final Test: 51.40
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.01355633395724
None Run 13:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 68.60
Split: 05, Run: 02
None time:  1.2471360168419778
None Run 14:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 64.20
Split: 05, Run: 03
None time:  1.04342495999299
None Run 15:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 67.90
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.9954424889292568
None Run 16:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 72.60
Split: 06, Run: 02
None time:  0.9031985860783607
None Run 17:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 65.10
Split: 06, Run: 03
None time:  0.8524506129324436
None Run 18:
Highest Train: 100.00
Highest Valid: 51.20
  Final Train: 100.00
   Final Test: 50.90
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.9422453069128096
None Run 19:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 71.70
Split: 07, Run: 02
None time:  0.9761744041461498
None Run 20:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 71.30
Split: 07, Run: 03
None time:  1.0194468670524657
None Run 21:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 64.80
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.070795765845105
None Run 22:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 70.10
Split: 08, Run: 02
None time:  1.1876164569985121
None Run 23:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 75.70
Split: 08, Run: 03
None time:  0.8473737242165953
None Run 24:
Highest Train: 100.00
Highest Valid: 61.40
  Final Train: 100.00
   Final Test: 62.90
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.0807541380636394
None Run 25:
Highest Train: 100.00
Highest Valid: 80.00
  Final Train: 100.00
   Final Test: 74.80
Split: 09, Run: 02
None time:  1.003424407914281
None Run 26:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 71.50
Split: 09, Run: 03
None time:  0.8752614250406623
None Run 27:
Highest Train: 100.00
Highest Valid: 52.80
  Final Train: 100.00
   Final Test: 52.40
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.9306099181994796
None Run 28:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 67.10
Split: 10, Run: 02
None time:  0.8848275300115347
None Run 29:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 55.80
Split: 10, Run: 03
None time:  0.9070286040659994
None Run 30:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 52.00
run time now: 2.759270429611206
total time:  30.271827172022313
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 63.75 ± 8.12
  Final Train: 100.00 ± 0.00
   Final Test: 62.57 ± 8.12
best run test_acc: 68.05000305175781
[I 2023-06-12 00:29:14,629] Trial 24 finished with value: 63.746665954589844 and parameters: {'Fwd': 8.277235543788908e-06, 'K': 2, 'alpha': 0.1, 'dropout': 0.9, 'gnnepoch': 90, 'lambda1': 0.2, 'lambda2': 2.2558720796306364, 'loop': 0, 'loss': 'CE', 'lr': 0.0029900930145514717, 'softmaxF': True, 'useGCN': False, 'weight_decay': 8.207468961245999e-06, 'weightedloss': True}. Best is trial 18 with value: 68.83999633789062.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  5
alpha:  0.25
lr:  0.005043176808611302
weight_decay:  2.830401992645805e-06
dropout:  0.6000000000000001
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.169360504951328
None Run 01:
Highest Train: 100.00
Highest Valid: 52.20
  Final Train: 100.00
   Final Test: 49.70
Split: 01, Run: 02
None time:  1.2609463869594038
None Run 02:
Highest Train: 100.00
Highest Valid: 51.40
  Final Train: 100.00
   Final Test: 51.40
Split: 01, Run: 03
None time:  1.1078234850428998
None Run 03:
Highest Train: 100.00
Highest Valid: 49.20
  Final Train: 100.00
   Final Test: 47.40
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.116015172097832
None Run 04:
Highest Train: 100.00
Highest Valid: 60.80
  Final Train: 100.00
   Final Test: 64.00
Split: 02, Run: 02
None time:  1.1354288579896092
None Run 05:
Highest Train: 100.00
Highest Valid: 60.80
  Final Train: 100.00
   Final Test: 64.00
Split: 02, Run: 03
None time:  1.1493458568584174
None Run 06:
Highest Train: 100.00
Highest Valid: 60.80
  Final Train: 100.00
   Final Test: 64.00
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1849817889742553
None Run 07:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 65.60
Split: 03, Run: 02
None time:  1.1600202769041061
None Run 08:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 62.70
Split: 03, Run: 03
None time:  1.1255155869293958
None Run 09:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 58.30
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.3941887370310724
None Run 10:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 57.00
Split: 04, Run: 02
None time:  1.1441117899958044
None Run 11:
Highest Train: 100.00
Highest Valid: 57.60
  Final Train: 100.00
   Final Test: 55.90
Split: 04, Run: 03
None time:  1.172922891099006
None Run 12:
Highest Train: 100.00
Highest Valid: 57.80
  Final Train: 100.00
   Final Test: 55.80
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.4183019460178912
None Run 13:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 93.33
   Final Test: 74.90
Split: 05, Run: 02
None time:  1.4539796160534024
None Run 14:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 93.33
   Final Test: 71.80
Split: 05, Run: 03
None time:  1.4417031880002469
None Run 15:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 73.80
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.299956426024437
None Run 16:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 78.30
Split: 06, Run: 02
None time:  1.4821470871102065
None Run 17:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 79.90
Split: 06, Run: 03
None time:  1.1234244420193136
None Run 18:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 77.40
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.6895748130045831
None Run 19:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 93.33
   Final Test: 73.80
Split: 07, Run: 02
None time:  1.1446846548933536
None Run 20:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 75.20
Split: 07, Run: 03
None time:  1.3292542579583824
None Run 21:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 73.00
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.8821559441275895
None Run 22:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 74.10
Split: 08, Run: 02
None time:  1.3802053409162909
None Run 23:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 77.20
Split: 08, Run: 03
None time:  1.2022185190580785
None Run 24:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 76.80
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.329250878887251
None Run 25:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 100.00
   Final Test: 73.70
Split: 09, Run: 02
None time:  1.2226744638755918
None Run 26:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 71.70
Split: 09, Run: 03
None time:  1.1242172750644386
None Run 27:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 69.00
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.3653156319633126
None Run 28:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 64.20
Split: 10, Run: 02
None time:  1.2504275850951672
None Run 29:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 66.20
Split: 10, Run: 03
None time:  1.6757607029285282
None Run 30:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 80.00
   Final Test: 69.10
run time now: 4.332474946975708
total time:  40.09695178293623
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 68.61 ± 8.89
  Final Train: 98.67 ± 4.07
   Final Test: 67.20 ± 9.13
best run test_acc: 68.80000305175781
[I 2023-06-12 00:29:55,332] Trial 25 finished with value: 68.6066665649414 and parameters: {'Fwd': 4.629408243236882e-05, 'K': 5, 'alpha': 0.25, 'dropout': 0.6000000000000001, 'gnnepoch': 100, 'lambda1': 0.35000000000000003, 'lambda2': 3.5471827410771732, 'loop': 1, 'loss': 'CE', 'lr': 0.005043176808611302, 'softmaxF': True, 'useGCN': False, 'weight_decay': 2.830401992645805e-06, 'weightedloss': True}. Best is trial 18 with value: 68.83999633789062.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  5
alpha:  0.8
lr:  0.007417224758331155
weight_decay:  2.4012437980227545e-06
dropout:  0.6000000000000001
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.9164863789919764
None Run 01:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 61.40
Split: 01, Run: 02
None time:  1.94977469695732
None Run 02:
Highest Train: 100.00
Highest Valid: 58.00
  Final Train: 100.00
   Final Test: 58.90
Split: 01, Run: 03
None time:  1.8198813321068883
None Run 03:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 61.20
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.6718495190143585
None Run 04:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 68.40
Split: 02, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 63.20% Test: 67.70%
Split: 02, Run: 02
None time:  3.52654596301727
None Run 05:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 67.60
Split: 02, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 61.20% Test: 67.30%
Split: 02, Run: 03
None time:  3.38924069609493
None Run 06:
Highest Train: 100.00
Highest Valid: 61.20
  Final Train: 100.00
   Final Test: 67.30
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.925147183937952
None Run 07:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 67.70
Split: 03, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 68.00% Test: 68.10%
Split: 03, Run: 02
None time:  3.632314383983612
None Run 08:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 68.30
Split: 03, Run: 03
None time:  1.884668743936345
None Run 09:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 68.60
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.946162231033668
None Run 10:
Highest Train: 100.00
Highest Valid: 60.20
  Final Train: 100.00
   Final Test: 60.70
Split: 04, Run: 02
None time:  1.8793146850075573
None Run 11:
Highest Train: 100.00
Highest Valid: 61.60
  Final Train: 100.00
   Final Test: 60.20
Split: 04, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 61.80% Test: 62.10%
Split: 04, Run: 03
None time:  3.6007356350310147
None Run 12:
Highest Train: 100.00
Highest Valid: 61.80
  Final Train: 100.00
   Final Test: 62.20
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 64.60% Test: 61.10%
Split: 05, Run: 01
None time:  3.558423409005627
None Run 13:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 61.20
Split: 05, Run: 02
None time:  1.9093124701175839
None Run 14:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 59.90
Split: 05, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 63.80% Test: 57.80%
Split: 05, Run: 03
None time:  3.580544091993943
None Run 15:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 58.20
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.9160067508928478
None Run 16:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 76.20
Split: 06, Run: 02
None time:  1.855299400165677
None Run 17:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 77.60
Split: 06, Run: 03
None time:  1.9594611411448568
None Run 18:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 76.40
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.8854814840015024
None Run 19:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 70.70
Split: 07, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 69.80% Test: 71.30%
Split: 07, Run: 02
None time:  3.5514973488170654
None Run 20:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 71.30
Split: 07, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 69.40% Test: 71.30%
Split: 07, Run: 03
None time:  3.685552047099918
None Run 21:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 71.30
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.9274059059098363
None Run 22:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 70.60
Split: 08, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 73.60% Test: 72.20%
Split: 08, Run: 02
None time:  3.5290497420355678
None Run 23:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 72.60
Split: 08, Run: 03
None time:  1.950919633032754
None Run 24:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 71.90
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.8138737231492996
None Run 25:
Highest Train: 100.00
Highest Valid: 79.40
  Final Train: 100.00
   Final Test: 78.00
Split: 09, Run: 02
None time:  1.9033958641812205
None Run 26:
Highest Train: 100.00
Highest Valid: 80.80
  Final Train: 100.00
   Final Test: 77.80
Split: 09, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 79.40% Test: 78.30%
Split: 09, Run: 03
None time:  3.5365776971448213
None Run 27:
Highest Train: 100.00
Highest Valid: 79.40
  Final Train: 100.00
   Final Test: 78.20
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 68.00% Test: 66.20%
Split: 10, Run: 01
None time:  3.551318527199328
None Run 28:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 66.20
Split: 10, Run: 02
None time:  1.9193477479275316
None Run 29:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 66.80
Split: 10, Run: 03
None time:  1.848967860918492
None Run 30:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 64.70
run time now: 7.36230206489563
total time:  76.0190194719471
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 67.95 ± 6.34
  Final Train: 100.00 ± 0.00
   Final Test: 68.07 ± 6.29
best run test_acc: 68.83000183105469
[I 2023-06-12 00:31:11,794] Trial 26 finished with value: 67.94666290283203 and parameters: {'Fwd': 6.0838664318540596e-05, 'K': 5, 'alpha': 0.8, 'dropout': 0.6000000000000001, 'gnnepoch': 100, 'lambda1': 0.35000000000000003, 'lambda2': 5.684076589621465, 'loop': 0, 'loss': 'MSE', 'lr': 0.007417224758331155, 'softmaxF': True, 'useGCN': True, 'weight_decay': 2.4012437980227545e-06, 'weightedloss': True}. Best is trial 18 with value: 68.83999633789062.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  0.55
lr:  0.005296378256664913
weight_decay:  1.4429463012213373e-05
dropout:  0.6000000000000001
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.7030602928716689
None Run 01:
Highest Train: 100.00
Highest Valid: 52.00
  Final Train: 100.00
   Final Test: 55.00
Split: 01, Run: 02
None time:  1.1740632401779294
None Run 02:
Highest Train: 100.00
Highest Valid: 52.00
  Final Train: 100.00
   Final Test: 55.00
Split: 01, Run: 03
None time:  1.2301963709760457
None Run 03:
Highest Train: 100.00
Highest Valid: 52.00
  Final Train: 100.00
   Final Test: 55.00
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.3283391180448234
None Run 04:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 69.20
Split: 02, Run: 02
None time:  1.2811887338757515
None Run 05:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 69.20
Split: 02, Run: 03
None time:  1.2327842069789767
None Run 06:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 69.20
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.2254991331137717
None Run 07:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 63.50
Split: 03, Run: 02
None time:  1.3096989679615945
None Run 08:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 63.50
Split: 03, Run: 03
None time:  1.3063581800088286
None Run 09:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 63.50
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.1893339189700782
None Run 10:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 57.00
Split: 04, Run: 02
None time:  1.1352127818390727
None Run 11:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 57.00
Split: 04, Run: 03
None time:  1.2528771869838238
None Run 12:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 57.00
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.612596037099138
None Run 13:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 71.50
Split: 05, Run: 02
None time:  1.5327539569698274
None Run 14:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 71.50
Split: 05, Run: 03
None time:  1.5280111730098724
None Run 15:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 71.50
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.7554658339358866
None Run 16:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 71.60
Split: 06, Run: 02
None time:  1.7342541229445487
None Run 17:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 71.60
Split: 06, Run: 03
None time:  1.7091925700660795
None Run 18:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 71.60
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.1933527200017124
None Run 19:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 72.40
Split: 07, Run: 02
None time:  1.2678764190059155
None Run 20:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 72.40
Split: 07, Run: 03
None time:  1.2979563327971846
None Run 21:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 72.40
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.1704901659395546
None Run 22:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 74.60
Split: 08, Run: 02
None time:  1.1758637381717563
None Run 23:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 74.60
Split: 08, Run: 03
None time:  1.1730956491082907
None Run 24:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 74.60
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.4675384319853038
None Run 25:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 74.30
Split: 09, Run: 02
None time:  2.409003126202151
None Run 26:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 74.30
Split: 09, Run: 03
None time:  2.471587846055627
None Run 27:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 74.30
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.2343725028913468
None Run 28:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 66.10
Split: 10, Run: 02
None time:  1.204359631985426
None Run 29:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 66.10
Split: 10, Run: 03
None time:  1.1240523499436677
None Run 30:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 66.10
run time now: 3.6059353351593018
total time:  43.732545303180814
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 67.02 ± 7.77
  Final Train: 100.00 ± 0.00
   Final Test: 67.52 ± 6.75
best run test_acc: 67.5199966430664
[I 2023-06-12 00:31:56,033] Trial 27 finished with value: 67.0199966430664 and parameters: {'Fwd': 0.0005599967821654912, 'K': 7, 'alpha': 0.55, 'dropout': 0.6000000000000001, 'gnnepoch': 80, 'lambda1': 0.0, 'lambda2': 3.4922294789030137, 'loop': 2, 'loss': 'CE', 'lr': 0.005296378256664913, 'softmaxF': True, 'useGCN': False, 'weight_decay': 1.4429463012213373e-05, 'weightedloss': True}. Best is trial 18 with value: 68.83999633789062.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.35000000000000003
lr:  0.00543380267860329
weight_decay:  2.4799817106049746e-06
dropout:  0.4
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.211326560936868
None Run 01:
Highest Train: 100.00
Highest Valid: 60.40
  Final Train: 100.00
   Final Test: 63.10
Split: 01, Run: 02
None time:  2.201449621003121
None Run 02:
Highest Train: 100.00
Highest Valid: 59.60
  Final Train: 100.00
   Final Test: 62.60
Split: 01, Run: 03
None time:  2.1515107499435544
None Run 03:
Highest Train: 100.00
Highest Valid: 60.60
  Final Train: 100.00
   Final Test: 62.50
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  2.1111809639260173
None Run 04:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 66.70
Split: 02, Run: 02
None time:  2.09432918112725
None Run 05:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 66.70
Split: 02, Run: 03
None time:  1.9670276520773768
None Run 06:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 66.70
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  2.1177873329725116
None Run 07:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 69.50
Split: 03, Run: 02
None time:  2.046407582005486
None Run 08:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 68.50
Split: 03, Run: 03
None time:  1.9556666458956897
None Run 09:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 69.70
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  2.1748326309025288
None Run 10:
Highest Train: 100.00
Highest Valid: 61.80
  Final Train: 100.00
   Final Test: 59.80
Split: 04, Run: 02
None time:  2.281853176886216
None Run 11:
Highest Train: 100.00
Highest Valid: 61.60
  Final Train: 100.00
   Final Test: 59.30
Split: 04, Run: 03
None time:  2.250102411955595
None Run 12:
Highest Train: 100.00
Highest Valid: 61.80
  Final Train: 100.00
   Final Test: 59.30
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  2.171142318053171
None Run 13:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 58.70
Split: 05, Run: 02
None time:  2.17019303701818
None Run 14:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 59.20
Split: 05, Run: 03
None time:  2.21152500086464
None Run 15:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 57.60
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  2.1153505390975624
None Run 16:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 76.80
Split: 06, Run: 02
None time:  2.088903115130961
None Run 17:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 78.40
Split: 06, Run: 03
None time:  2.2163241028320044
None Run 18:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 75.40
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.515777711989358
None Run 19:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 70.70
Split: 07, Run: 02
None time:  2.5098369638435543
None Run 20:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 70.60
Split: 07, Run: 03
None time:  2.3687760911416262
None Run 21:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 70.60
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  2.1496122339740396
None Run 22:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 76.40
Split: 08, Run: 02
None time:  2.23747498402372
None Run 23:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 74.70
Split: 08, Run: 03
None time:  2.2552318279631436
None Run 24:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 75.90
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.144434768939391
None Run 25:
Highest Train: 100.00
Highest Valid: 79.80
  Final Train: 100.00
   Final Test: 77.50
Split: 09, Run: 02
None time:  2.1183876008726656
None Run 26:
Highest Train: 100.00
Highest Valid: 80.00
  Final Train: 100.00
   Final Test: 76.70
Split: 09, Run: 03
None time:  2.1111950369086117
None Run 27:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 76.90
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  2.1187508208677173
None Run 28:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 65.90
Split: 10, Run: 02
None time:  2.472254362888634
None Run 29:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 66.40
Split: 10, Run: 03
None time:  2.0878994839731604
None Run 30:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 66.60
run time now: 6.718751907348633
total time:  66.74024489405565
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 68.91 ± 6.15
  Final Train: 100.00 ± 0.00
   Final Test: 68.31 ± 6.63
best run test_acc: 68.81001281738281
[I 2023-06-12 00:33:03,214] Trial 28 finished with value: 68.90666198730469 and parameters: {'Fwd': 1.5108411434101786e-05, 'K': 6, 'alpha': 0.35000000000000003, 'dropout': 0.4, 'gnnepoch': 100, 'lambda1': 0.2, 'lambda2': 4.923107635604232, 'loop': 1, 'loss': 'CE', 'lr': 0.00543380267860329, 'softmaxF': True, 'useGCN': True, 'weight_decay': 2.4799817106049746e-06, 'weightedloss': True}. Best is trial 28 with value: 68.90666198730469.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.35000000000000003
lr:  0.005824282672335211
weight_decay:  3.546377270856751e-05
dropout:  0.4
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.4521769229322672
None Run 01:
Highest Train: 100.00
Highest Valid: 59.80
  Final Train: 100.00
   Final Test: 61.00
Split: 01, Run: 02
None time:  1.540267826989293
None Run 02:
Highest Train: 100.00
Highest Valid: 59.20
  Final Train: 100.00
   Final Test: 60.90
Split: 01, Run: 03
None time:  1.6041353740729392
None Run 03:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 60.50
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  2.990120575996116
None Run 04:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 70.80
Split: 02, Run: 02
None time:  1.6219104770570993
None Run 05:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 68.90
Split: 02, Run: 03
None time:  1.6040184628218412
None Run 06:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 68.30
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.5061654991004616
None Run 07:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 69.70
Split: 03, Run: 02
None time:  1.5373379909433424
None Run 08:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 70.60
Split: 03, Run: 03
None time:  1.4487088869791478
None Run 09:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 69.00
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.594096088083461
None Run 10:
Highest Train: 100.00
Highest Valid: 59.20
  Final Train: 100.00
   Final Test: 59.00
Split: 04, Run: 02
None time:  1.6117449100129306
None Run 11:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 59.30
Split: 04, Run: 03
None time:  1.5776185360737145
None Run 12:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 59.90
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.7186979230027646
None Run 13:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 58.30
Split: 05, Run: 02
None time:  1.646909438073635
None Run 14:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 59.70
Split: 05, Run: 03
None time:  1.586217150092125
None Run 15:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 59.60
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.784870488801971
None Run 16:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 77.60
Split: 06, Run: 02
None time:  2.264469969784841
None Run 17:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 75.80
Split: 06, Run: 03
None time:  2.1914488368202
None Run 18:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 78.50
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.788237462984398
None Run 19:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 72.90
Split: 07, Run: 02
None time:  2.670487174997106
None Run 20:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 75.10
Split: 07, Run: 03
None time:  3.0294847721233964
None Run 21:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 72.90
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  2.270118616055697
None Run 22:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 75.90
Split: 08, Run: 02
None time:  2.093659444944933
None Run 23:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 75.10
Split: 08, Run: 03
None time:  1.8201278210617602
None Run 24:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 77.00
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.9732853351160884
None Run 25:
Highest Train: 100.00
Highest Valid: 80.80
  Final Train: 100.00
   Final Test: 78.10
Split: 09, Run: 02
None time:  1.4572313691023737
None Run 26:
Highest Train: 100.00
Highest Valid: 81.00
  Final Train: 100.00
   Final Test: 78.90
Split: 09, Run: 03
None time:  2.292192469118163
None Run 27:
Highest Train: 100.00
Highest Valid: 81.20
  Final Train: 100.00
   Final Test: 78.20
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.6894325818866491
None Run 28:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 68.90
Split: 10, Run: 02
None time:  1.679487963905558
None Run 29:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 68.90
Split: 10, Run: 03
None time:  2.0474728939589113
None Run 30:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 65.70
run time now: 5.460418939590454
total time:  58.34690176998265
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.43 ± 7.18
  Final Train: 100.00 ± 0.00
   Final Test: 69.17 ± 7.14
best run test_acc: 70.03999328613281
[I 2023-06-12 00:34:02,035] Trial 29 finished with value: 69.43333435058594 and parameters: {'Fwd': 4.312273978609015e-05, 'K': 6, 'alpha': 0.35000000000000003, 'dropout': 0.4, 'gnnepoch': 60, 'lambda1': 0.25, 'lambda2': 5.891457410129755, 'loop': 1, 'loss': 'MSE', 'lr': 0.005824282672335211, 'softmaxF': True, 'useGCN': True, 'weight_decay': 3.546377270856751e-05, 'weightedloss': True}. Best is trial 29 with value: 69.43333435058594.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  0.35000000000000003
lr:  0.008653304586418407
weight_decay:  4.147425561987331e-05
dropout:  0.4
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.53619423112832
None Run 01:
Highest Train: 100.00
Highest Valid: 60.80
  Final Train: 100.00
   Final Test: 61.40
Split: 01, Run: 02
None time:  2.107072384096682
None Run 02:
Highest Train: 100.00
Highest Valid: 60.00
  Final Train: 100.00
   Final Test: 60.40
Split: 01, Run: 03
None time:  2.1412371010519564
None Run 03:
Highest Train: 100.00
Highest Valid: 59.60
  Final Train: 100.00
   Final Test: 60.90
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.8433443359099329
None Run 04:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 68.90
Split: 02, Run: 02
None time:  1.8649176720064133
None Run 05:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 68.50
Split: 02, Run: 03
None time:  3.055117112118751
None Run 06:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 71.20
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.8187855680007488
None Run 07:
Highest Train: 100.00
Highest Valid: 67.40
  Final Train: 100.00
   Final Test: 68.90
Split: 03, Run: 02
None time:  1.5794345699250698
None Run 08:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 68.70
Split: 03, Run: 03
None time:  1.8394822268746793
None Run 09:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 69.70
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.7922146199271083
None Run 10:
Highest Train: 100.00
Highest Valid: 60.80
  Final Train: 100.00
   Final Test: 60.90
Split: 04, Run: 02
None time:  1.7012244849465787
None Run 11:
Highest Train: 100.00
Highest Valid: 59.20
  Final Train: 100.00
   Final Test: 59.30
Split: 04, Run: 03
None time:  1.6810725182294846
None Run 12:
Highest Train: 100.00
Highest Valid: 61.00
  Final Train: 100.00
   Final Test: 61.20
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.807192225009203
None Run 13:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 58.90
Split: 05, Run: 02
None time:  1.7072264349553734
None Run 14:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 57.00
Split: 05, Run: 03
None time:  1.8192435938399285
None Run 15:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 59.40
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.8105511849280447
None Run 16:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 76.20
Split: 06, Run: 02
None time:  1.7080521830357611
None Run 17:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 78.10
Split: 06, Run: 03
None time:  1.7693525729700923
None Run 18:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 74.50
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.7142692820634693
None Run 19:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 74.60
Split: 07, Run: 02
None time:  2.2246585418470204
None Run 20:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 74.30
Split: 07, Run: 03
None time:  2.4948536020237952
None Run 21:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 71.60
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  2.0780515549704432
None Run 22:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 75.50
Split: 08, Run: 02
None time:  2.080649866955355
None Run 23:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 75.10
Split: 08, Run: 03
None time:  1.8688474108930677
None Run 24:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 75.10
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.9817291658837348
None Run 25:
Highest Train: 100.00
Highest Valid: 80.60
  Final Train: 100.00
   Final Test: 78.10
Split: 09, Run: 02
None time:  2.3419477918650955
None Run 26:
Highest Train: 100.00
Highest Valid: 81.20
  Final Train: 100.00
   Final Test: 78.30
Split: 09, Run: 03
None time:  1.916863244958222
None Run 27:
Highest Train: 100.00
Highest Valid: 80.40
  Final Train: 100.00
   Final Test: 76.80
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.9358541020192206
None Run 28:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 68.10
Split: 10, Run: 02
None time:  2.061193526023999
None Run 29:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 67.80
Split: 10, Run: 03
None time:  2.0297654420137405
None Run 30:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 67.60
run time now: 6.07045316696167
total time:  61.683192817959934
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.41 ± 6.56
  Final Train: 100.00 ± 0.00
   Final Test: 68.90 ± 6.81
best run test_acc: 69.75
[I 2023-06-12 00:35:04,108] Trial 30 finished with value: 69.40666198730469 and parameters: {'Fwd': 1.529710808647735e-05, 'K': 7, 'alpha': 0.35000000000000003, 'dropout': 0.4, 'gnnepoch': 70, 'lambda1': 0.25, 'lambda2': 6.849970642034789, 'loop': 1, 'loss': 'MSE', 'lr': 0.008653304586418407, 'softmaxF': True, 'useGCN': True, 'weight_decay': 4.147425561987331e-05, 'weightedloss': True}. Best is trial 29 with value: 69.43333435058594.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  0.4
lr:  0.008656729889333635
weight_decay:  3.6267051245812596e-05
dropout:  0.4
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.7325055210385472
None Run 01:
Highest Train: 100.00
Highest Valid: 58.20
  Final Train: 100.00
   Final Test: 60.90
Split: 01, Run: 02
None time:  1.6175623070448637
None Run 02:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 61.00
Split: 01, Run: 03
None time:  1.4619479579851031
None Run 03:
Highest Train: 100.00
Highest Valid: 56.00
  Final Train: 100.00
   Final Test: 58.70
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.6846324689686298
None Run 04:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 68.90
Split: 02, Run: 02
None time:  1.664799279998988
None Run 05:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 67.30
Split: 02, Run: 03
None time:  1.7355691210832447
None Run 06:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 68.30
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.3529932738747448
None Run 07:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 68.40
Split: 03, Run: 02
None time:  2.5091047699097544
None Run 08:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 69.30
Split: 03, Run: 03
None time:  1.7677384049165994
None Run 09:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 70.30
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.604244344169274
None Run 10:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 59.70
Split: 04, Run: 02
None time:  1.6213017348200083
None Run 11:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 59.90
Split: 04, Run: 03
None time:  1.6015521939843893
None Run 12:
Highest Train: 100.00
Highest Valid: 57.80
  Final Train: 100.00
   Final Test: 57.90
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.686929747927934
None Run 13:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 59.30
Split: 05, Run: 02
None time:  1.69639404816553
None Run 14:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 57.30
Split: 05, Run: 03
None time:  1.6480373269878328
None Run 15:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 59.20
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.614635628182441
None Run 16:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 75.50
Split: 06, Run: 02
None time:  1.6199845110531896
None Run 17:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 76.50
Split: 06, Run: 03
None time:  1.6755066229961812
None Run 18:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 77.30
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.4052145399618894
None Run 19:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 73.30
Split: 07, Run: 02
None time:  1.7681942810304463
None Run 20:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 71.10
Split: 07, Run: 03
None time:  2.530723146861419
None Run 21:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 72.80
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.9702351100277156
None Run 22:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 75.60
Split: 08, Run: 02
None time:  1.9951817109249532
None Run 23:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 74.50
Split: 08, Run: 03
None time:  1.7901873330119997
None Run 24:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 75.40
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.0384640160482377
None Run 25:
Highest Train: 100.00
Highest Valid: 81.20
  Final Train: 100.00
   Final Test: 78.80
Split: 09, Run: 02
None time:  1.6036529690027237
None Run 26:
Highest Train: 100.00
Highest Valid: 81.40
  Final Train: 100.00
   Final Test: 77.50
Split: 09, Run: 03
None time:  1.581063289893791
None Run 27:
Highest Train: 100.00
Highest Valid: 81.00
  Final Train: 100.00
   Final Test: 78.40
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.6296865199692547
None Run 28:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 68.00
Split: 10, Run: 02
None time:  1.766690274933353
None Run 29:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 68.30
Split: 10, Run: 03
None time:  1.8725803908891976
None Run 30:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 67.20
run time now: 5.313179016113281
total time:  54.38697332981974
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 68.64 ± 7.26
  Final Train: 100.00 ± 0.00
   Final Test: 68.55 ± 7.04
best run test_acc: 69.2699966430664
[I 2023-06-12 00:35:59,032] Trial 31 finished with value: 68.63999938964844 and parameters: {'Fwd': 1.3591001198362809e-05, 'K': 7, 'alpha': 0.4, 'dropout': 0.4, 'gnnepoch': 60, 'lambda1': 0.25, 'lambda2': 6.867577081254019, 'loop': 1, 'loss': 'MSE', 'lr': 0.008656729889333635, 'softmaxF': True, 'useGCN': True, 'weight_decay': 3.6267051245812596e-05, 'weightedloss': True}. Best is trial 29 with value: 69.43333435058594.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.35000000000000003
lr:  0.006222548135430654
weight_decay:  8.782417370306112e-05
dropout:  0.4
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.505458417814225
None Run 01:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 60.60
Split: 01, Run: 02
None time:  1.5066629929933697
None Run 02:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 61.20
Split: 01, Run: 03
None time:  1.5545861469581723
None Run 03:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 60.30
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.7493980729486793
None Run 04:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 68.90
Split: 02, Run: 02
None time:  1.7274255079682916
None Run 05:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 69.10
Split: 02, Run: 03
None time:  2.5860155490227044
None Run 06:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 70.20
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.5204337681643665
None Run 07:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 69.70
Split: 03, Run: 02
None time:  1.493912662146613
None Run 08:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 69.40
Split: 03, Run: 03
None time:  1.4990209760144353
None Run 09:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 69.40
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.3680014058481902
None Run 10:
Highest Train: 100.00
Highest Valid: 60.40
  Final Train: 100.00
   Final Test: 60.40
Split: 04, Run: 02
None time:  1.387735336087644
None Run 11:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 60.50
Split: 04, Run: 03
None time:  1.6161874099634588
None Run 12:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 59.60
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.662255928851664
None Run 13:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 58.60
Split: 05, Run: 02
None time:  1.8186845849268138
None Run 14:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 60.40
Split: 05, Run: 03
None time:  1.714458490954712
None Run 15:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 60.40
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.497416527941823
None Run 16:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 77.60
Split: 06, Run: 02
None time:  1.6967846951447427
None Run 17:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 77.80
Split: 06, Run: 03
None time:  1.590072758961469
None Run 18:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 77.30
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.0567846240010113
None Run 19:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 71.60
Split: 07, Run: 02
None time:  2.1344413119368255
None Run 20:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 71.10
Split: 07, Run: 03
None time:  2.1070844728965312
None Run 21:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 73.60
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  2.0202114628627896
None Run 22:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 78.10
Split: 08, Run: 02
None time:  2.071437011938542
None Run 23:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 77.60
Split: 08, Run: 03
None time:  1.8425940650049597
None Run 24:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 77.20
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.135993642034009
None Run 25:
Highest Train: 100.00
Highest Valid: 81.60
  Final Train: 100.00
   Final Test: 78.10
Split: 09, Run: 02
None time:  1.6192906880751252
None Run 26:
Highest Train: 100.00
Highest Valid: 81.20
  Final Train: 100.00
   Final Test: 78.70
Split: 09, Run: 03
None time:  1.7404198800213635
None Run 27:
Highest Train: 100.00
Highest Valid: 81.60
  Final Train: 100.00
   Final Test: 78.50
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  2.382106751902029
None Run 28:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 67.70
Split: 10, Run: 02
None time:  1.671952717937529
None Run 29:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 69.10
Split: 10, Run: 03
None time:  1.6963521579746157
None Run 30:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 68.80
run time now: 5.820510149002075
total time:  54.085221773944795
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.49 ± 7.10
  Final Train: 100.00 ± 0.00
   Final Test: 69.38 ± 7.05
best run test_acc: 69.92999267578125
[I 2023-06-12 00:36:53,585] Trial 32 finished with value: 69.49333190917969 and parameters: {'Fwd': 2.0080562096379307e-05, 'K': 6, 'alpha': 0.35000000000000003, 'dropout': 0.4, 'gnnepoch': 60, 'lambda1': 0.1, 'lambda2': 5.861416199661658, 'loop': 1, 'loss': 'MSE', 'lr': 0.006222548135430654, 'softmaxF': True, 'useGCN': True, 'weight_decay': 8.782417370306112e-05, 'weightedloss': True}. Best is trial 32 with value: 69.49333190917969.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.35000000000000003
lr:  0.009826505582143636
weight_decay:  0.00014011272173716297
dropout:  0.4
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.116457124007866
None Run 01:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 61.70
Split: 01, Run: 02
None time:  1.4807735199574381
None Run 02:
Highest Train: 100.00
Highest Valid: 55.40
  Final Train: 100.00
   Final Test: 59.20
Split: 01, Run: 03
None time:  2.020595649955794
None Run 03:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 60.70
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  2.1614916529506445
None Run 04:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 71.80
Split: 02, Run: 02
None time:  1.6844155879225582
None Run 05:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 71.00
Split: 02, Run: 03
None time:  1.6219435359816998
None Run 06:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 69.10
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.9808025709353387
None Run 07:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 71.20
Split: 03, Run: 02
None time:  2.154281446011737
None Run 08:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.70
Split: 03, Run: 03
None time:  1.5441188169643283
None Run 09:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 69.70
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.4868436269462109
None Run 10:
Highest Train: 100.00
Highest Valid: 61.40
  Final Train: 100.00
   Final Test: 60.40
Split: 04, Run: 02
None time:  1.5725996459368616
None Run 11:
Highest Train: 100.00
Highest Valid: 60.20
  Final Train: 100.00
   Final Test: 61.10
Split: 04, Run: 03
None time:  1.4344115010462701
None Run 12:
Highest Train: 100.00
Highest Valid: 58.20
  Final Train: 100.00
   Final Test: 58.20
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.61709892610088
None Run 13:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 62.40
Split: 05, Run: 02
None time:  1.632220630068332
None Run 14:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 62.40
Split: 05, Run: 03
None time:  1.8373832409270108
None Run 15:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 63.30
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.4762932870071381
None Run 16:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 77.90
Split: 06, Run: 02
None time:  1.5024747140705585
None Run 17:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 76.20
Split: 06, Run: 03
None time:  1.6847134879790246
None Run 18:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 76.40
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.8816254599951208
None Run 19:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 73.10
Split: 07, Run: 02
None time:  2.0863406900316477
None Run 20:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 72.40
Split: 07, Run: 03
None time:  1.985544668044895
None Run 21:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 75.20
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.847502418095246
None Run 22:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 75.60
Split: 08, Run: 02
None time:  1.8612023680470884
None Run 23:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 74.40
Split: 08, Run: 03
None time:  1.8136626470368356
None Run 24:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 75.20
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.5289831508416682
None Run 25:
Highest Train: 100.00
Highest Valid: 81.40
  Final Train: 100.00
   Final Test: 79.00
Split: 09, Run: 02
None time:  1.617224076995626
None Run 26:
Highest Train: 100.00
Highest Valid: 80.40
  Final Train: 100.00
   Final Test: 78.00
Split: 09, Run: 03
None time:  1.8589942811522633
None Run 27:
Highest Train: 100.00
Highest Valid: 81.20
  Final Train: 100.00
   Final Test: 77.80
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.6836638180539012
None Run 28:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 66.20
Split: 10, Run: 02
None time:  1.738714270060882
None Run 29:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 67.80
Split: 10, Run: 03
None time:  1.8077803330961615
None Run 30:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 69.30
run time now: 5.275320529937744
total time:  53.85442700004205
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.69 ± 6.90
  Final Train: 100.00 ± 0.00
   Final Test: 69.61 ± 6.53
best run test_acc: 70.66000366210938
[I 2023-06-12 00:37:47,970] Trial 33 finished with value: 69.69332885742188 and parameters: {'Fwd': 0.00010847202804534143, 'K': 6, 'alpha': 0.35000000000000003, 'dropout': 0.4, 'gnnepoch': 60, 'lambda1': 0.05, 'lambda2': 7.1506542342133015, 'loop': 1, 'loss': 'MSE', 'lr': 0.009826505582143636, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.00014011272173716297, 'weightedloss': True}. Best is trial 33 with value: 69.69332885742188.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.4
lr:  0.009302641828832002
weight_decay:  0.00018516249166168353
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.4843834510538727
None Run 01:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 61.10
Split: 01, Run: 02
None time:  1.685854879906401
None Run 02:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 60.70
Split: 01, Run: 03
None time:  2.2112139898817986
None Run 03:
Highest Train: 100.00
Highest Valid: 59.20
  Final Train: 100.00
   Final Test: 61.70
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.7217161748558283
None Run 04:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 69.20
Split: 02, Run: 02
None time:  1.627084027044475
None Run 05:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 69.70
Split: 02, Run: 03
None time:  1.6679276891518384
None Run 06:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 69.30
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  2.000368158798665
None Run 07:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 69.30
Split: 03, Run: 02
None time:  2.814264218090102
None Run 08:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 71.80
Split: 03, Run: 03
None time:  1.4762114891782403
None Run 09:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 68.10
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.6601843868847936
None Run 10:
Highest Train: 100.00
Highest Valid: 60.40
  Final Train: 100.00
   Final Test: 59.70
Split: 04, Run: 02
None time:  1.5990500489715487
None Run 11:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 59.10
Split: 04, Run: 03
None time:  1.6481146370060742
None Run 12:
Highest Train: 100.00
Highest Valid: 57.40
  Final Train: 100.00
   Final Test: 57.50
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.7701418369542807
None Run 13:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 59.80
Split: 05, Run: 02
None time:  1.7902525989338756
None Run 14:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 60.50
Split: 05, Run: 03
None time:  2.0013330730143934
None Run 15:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 59.40
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.4715745828580111
None Run 16:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 75.00
Split: 06, Run: 02
None time:  1.5093753598630428
None Run 17:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 76.40
Split: 06, Run: 03
None time:  1.5072969167958945
None Run 18:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 76.30
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.9113589019980282
None Run 19:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 74.80
Split: 07, Run: 02
None time:  2.2015025711152703
None Run 20:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 75.20
Split: 07, Run: 03
None time:  2.2260688410606235
None Run 21:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 75.90
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.4515772599261254
None Run 22:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 71.80
Split: 08, Run: 02
None time:  2.0583546140696853
None Run 23:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 74.70
Split: 08, Run: 03
None time:  1.7615335250739008
None Run 24:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 100.00
   Final Test: 77.90
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.1610986781306565
None Run 25:
Highest Train: 100.00
Highest Valid: 81.80
  Final Train: 100.00
   Final Test: 77.40
Split: 09, Run: 02
None time:  1.7327057539951056
None Run 26:
Highest Train: 100.00
Highest Valid: 81.00
  Final Train: 100.00
   Final Test: 78.70
Split: 09, Run: 03
None time:  1.7185519360937178
None Run 27:
Highest Train: 100.00
Highest Valid: 81.20
  Final Train: 100.00
   Final Test: 78.90
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.874806054867804
None Run 28:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 70.00
Split: 10, Run: 02
None time:  1.8199847540818155
None Run 29:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 69.00
Split: 10, Run: 03
None time:  2.229709174949676
None Run 30:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 69.90
run time now: 5.971267938613892
total time:  55.90313849202357
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.63 ± 7.12
  Final Train: 100.00 ± 0.00
   Final Test: 69.29 ± 6.96
best run test_acc: 70.25000762939453
[I 2023-06-12 00:38:44,396] Trial 34 finished with value: 69.62667083740234 and parameters: {'Fwd': 0.00010095658025901838, 'K': 6, 'alpha': 0.4, 'dropout': 0.30000000000000004, 'gnnepoch': 60, 'lambda1': 0.05, 'lambda2': 7.061190046689018, 'loop': 1, 'loss': 'MSE', 'lr': 0.009302641828832002, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.00018516249166168353, 'weightedloss': True}. Best is trial 33 with value: 69.69332885742188.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.5
lr:  0.006702407717494414
weight_decay:  0.0001504676721145407
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.5275473068468273
None Run 01:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 60.30
Split: 01, Run: 02
None time:  1.487433094996959
None Run 02:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 59.70
Split: 01, Run: 03
None time:  1.4569435310550034
None Run 03:
Highest Train: 100.00
Highest Valid: 59.80
  Final Train: 100.00
   Final Test: 61.10
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.749197538010776
None Run 04:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 69.10
Split: 02, Run: 02
None time:  1.5563329770229757
None Run 05:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 69.10
Split: 02, Run: 03
None time:  1.7134411740116775
None Run 06:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 70.10
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.507713122991845
None Run 07:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 68.50
Split: 03, Run: 02
None time:  1.4740485060028732
None Run 08:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 69.50
Split: 03, Run: 03
None time:  1.5167838749475777
None Run 09:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 69.90
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.6834622519090772
None Run 10:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 59.50
Split: 04, Run: 02
None time:  1.6412767050787807
None Run 11:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 59.20
Split: 04, Run: 03
None time:  1.6882506150286645
None Run 12:
Highest Train: 100.00
Highest Valid: 60.40
  Final Train: 100.00
   Final Test: 62.10
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.6174322559963912
None Run 13:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 60.30
Split: 05, Run: 02
None time:  1.585810171905905
None Run 14:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 57.80
Split: 05, Run: 03
None time:  1.5576041450258344
None Run 15:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 59.80
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.4991117711178958
None Run 16:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 75.90
Split: 06, Run: 02
None time:  2.0431118588894606
None Run 17:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 75.30
Split: 06, Run: 03
None time:  1.5408771121874452
None Run 18:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 76.20
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  3.087788910139352
None Run 19:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 77.10
Split: 07, Run: 02
None time:  2.187608087901026
None Run 20:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 74.60
Split: 07, Run: 03
None time:  2.674217547988519
None Run 21:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 73.30
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.9477272150106728
None Run 22:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 74.10
Split: 08, Run: 02
None time:  1.8724741719197482
None Run 23:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 77.90
Split: 08, Run: 03
None time:  2.1318009248934686
None Run 24:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 78.40
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.0432110209949315
None Run 25:
Highest Train: 100.00
Highest Valid: 81.80
  Final Train: 100.00
   Final Test: 78.20
Split: 09, Run: 02
None time:  1.5542992840055376
None Run 26:
Highest Train: 100.00
Highest Valid: 81.60
  Final Train: 100.00
   Final Test: 78.60
Split: 09, Run: 03
None time:  1.486473066965118
None Run 27:
Highest Train: 100.00
Highest Valid: 79.80
  Final Train: 100.00
   Final Test: 77.10
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.753040943061933
None Run 28:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 68.50
Split: 10, Run: 02
None time:  1.891269318992272
None Run 29:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 69.20
Split: 10, Run: 03
None time:  2.381817761110142
None Run 30:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 69.10
run time now: 6.086294412612915
total time:  55.158215343020856
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.53 ± 7.04
  Final Train: 100.00 ± 0.00
   Final Test: 69.32 ± 7.03
best run test_acc: 70.30000305175781
[I 2023-06-12 00:39:40,110] Trial 35 finished with value: 69.53333282470703 and parameters: {'Fwd': 0.0001587389396914552, 'K': 6, 'alpha': 0.5, 'dropout': 0.30000000000000004, 'gnnepoch': 60, 'lambda1': 0.05, 'lambda2': 7.4083283577576635, 'loop': 1, 'loss': 'MSE', 'lr': 0.006702407717494414, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.0001504676721145407, 'weightedloss': True}. Best is trial 33 with value: 69.69332885742188.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.5
lr:  0.007176873672582551
weight_decay:  0.00018158629487558423
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.367467052070424
None Run 01:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 61.20
Split: 01, Run: 02
None time:  1.6337549430318177
None Run 02:
Highest Train: 100.00
Highest Valid: 58.00
  Final Train: 100.00
   Final Test: 61.00
Split: 01, Run: 03
None time:  1.4126089259516448
None Run 03:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 60.60
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.5979475199710578
None Run 04:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 69.90
Split: 02, Run: 02
None time:  1.5246611800976098
None Run 05:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 69.80
Split: 02, Run: 03
None time:  1.605077323038131
None Run 06:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 69.70
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.3547476939857006
None Run 07:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 69.30
Split: 03, Run: 02
None time:  1.822038158075884
None Run 08:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 70.50
Split: 03, Run: 03
None time:  1.3966260110028088
None Run 09:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 69.50
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.5339938988909125
None Run 10:
Highest Train: 100.00
Highest Valid: 59.20
  Final Train: 100.00
   Final Test: 60.60
Split: 04, Run: 02
None time:  1.4633136650081724
None Run 11:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 59.20
Split: 04, Run: 03
None time:  1.4752350160852075
None Run 12:
Highest Train: 100.00
Highest Valid: 59.20
  Final Train: 100.00
   Final Test: 60.90
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.5740494069177657
None Run 13:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 58.40
Split: 05, Run: 02
None time:  1.6060480901505798
None Run 14:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 59.10
Split: 05, Run: 03
None time:  1.5431891370099038
None Run 15:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 59.90
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.375453650020063
None Run 16:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 77.50
Split: 06, Run: 02
None time:  1.400057028979063
None Run 17:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 76.20
Split: 06, Run: 03
None time:  1.4328412408940494
None Run 18:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 75.80
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.5412281109020114
None Run 19:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 77.40
Split: 07, Run: 02
None time:  2.878589509986341
None Run 20:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 76.00
Split: 07, Run: 03
None time:  2.067186370957643
None Run 21:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 73.00
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.8537044578697532
None Run 22:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 75.20
Split: 08, Run: 02
None time:  1.9668534190859646
None Run 23:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 76.80
Split: 08, Run: 03
None time:  2.056287891929969
None Run 24:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 77.70
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.6051007569767535
None Run 25:
Highest Train: 100.00
Highest Valid: 82.00
  Final Train: 100.00
   Final Test: 79.00
Split: 09, Run: 02
None time:  1.768658674089238
None Run 26:
Highest Train: 100.00
Highest Valid: 80.80
  Final Train: 100.00
   Final Test: 77.00
Split: 09, Run: 03
None time:  2.1575516080483794
None Run 27:
Highest Train: 100.00
Highest Valid: 81.80
  Final Train: 100.00
   Final Test: 78.20
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.6802193301264197
None Run 28:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 68.10
Split: 10, Run: 02
None time:  2.152334754122421
None Run 29:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 68.50
Split: 10, Run: 03
None time:  1.8362292798701674
None Run 30:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 67.90
run time now: 5.727497339248657
total time:  52.83022310701199
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.50 ± 7.19
  Final Train: 100.00 ± 0.00
   Final Test: 69.46 ± 7.07
best run test_acc: 70.25000762939453
[I 2023-06-12 00:40:33,548] Trial 36 finished with value: 69.5 and parameters: {'Fwd': 0.00014671054543716625, 'K': 8, 'alpha': 0.5, 'dropout': 0.30000000000000004, 'gnnepoch': 50, 'lambda1': 0.05, 'lambda2': 7.747289640436248, 'loop': 1, 'loss': 'MSE', 'lr': 0.007176873672582551, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.00018158629487558423, 'weightedloss': True}. Best is trial 33 with value: 69.69332885742188.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.55
lr:  0.009132559871897252
weight_decay:  0.0003369094899123305
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.1526997168548405
None Run 01:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 62.60
Split: 01, Run: 02
None time:  1.5476694330573082
None Run 02:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 62.70
Split: 01, Run: 03
None time:  1.3942250669933856
None Run 03:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 61.00
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.613403992028907
None Run 04:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 70.30
Split: 02, Run: 02
None time:  1.5094717349857092
None Run 05:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 69.70
Split: 02, Run: 03
None time:  1.565946846967563
None Run 06:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 69.60
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.3590955878607929
None Run 07:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 69.40
Split: 03, Run: 02
None time:  1.4100623710546643
None Run 08:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 67.90
Split: 03, Run: 03
None time:  1.3902809440623969
None Run 09:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 69.00
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.44945731991902
None Run 10:
Highest Train: 100.00
Highest Valid: 61.20
  Final Train: 100.00
   Final Test: 61.10
Split: 04, Run: 02
None time:  1.2998187621124089
None Run 11:
Highest Train: 100.00
Highest Valid: 59.60
  Final Train: 100.00
   Final Test: 60.20
Split: 04, Run: 03
None time:  1.499020610935986
None Run 12:
Highest Train: 100.00
Highest Valid: 60.60
  Final Train: 100.00
   Final Test: 62.90
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.6572211789898574
None Run 13:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 60.90
Split: 05, Run: 02
None time:  1.6375033918302506
None Run 14:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 59.50
Split: 05, Run: 03
None time:  1.4202155550010502
None Run 15:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 58.10
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  2.0026326361112297
None Run 16:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 77.10
Split: 06, Run: 02
None time:  1.3054662661161274
None Run 17:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 77.20
Split: 06, Run: 03
None time:  1.433717000996694
None Run 18:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 76.70
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.3491886681877077
None Run 19:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 76.30
Split: 07, Run: 02
None time:  2.5404367009177804
None Run 20:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 76.70
Split: 07, Run: 03
None time:  2.373092863941565
None Run 21:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 75.20
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.5597509080544114
None Run 22:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 74.60
Split: 08, Run: 02
None time:  1.8682915929239243
None Run 23:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 78.00
Split: 08, Run: 03
None time:  1.8187328649219126
None Run 24:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 76.50
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.6688795580994338
None Run 25:
Highest Train: 100.00
Highest Valid: 81.40
  Final Train: 100.00
   Final Test: 78.90
Split: 09, Run: 02
None time:  1.6561943001579493
None Run 26:
Highest Train: 100.00
Highest Valid: 79.60
  Final Train: 100.00
   Final Test: 76.40
Split: 09, Run: 03
None time:  1.549788226839155
None Run 27:
Highest Train: 100.00
Highest Valid: 81.60
  Final Train: 100.00
   Final Test: 78.80
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.5809744999278337
None Run 28:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 68.00
Split: 10, Run: 02
None time:  2.5976389690767974
None Run 29:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 70.10
Split: 10, Run: 03
None time:  1.727033656090498
None Run 30:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 69.70
run time now: 5.95561957359314
total time:  52.18985282210633
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.89 ± 6.93
  Final Train: 100.00 ± 0.00
   Final Test: 69.84 ± 6.80
best run test_acc: 70.70999908447266
[I 2023-06-12 00:41:26,183] Trial 37 finished with value: 69.8933334350586 and parameters: {'Fwd': 0.0005171888894129924, 'K': 8, 'alpha': 0.55, 'dropout': 0.30000000000000004, 'gnnepoch': 50, 'lambda1': 0.05, 'lambda2': 7.544438111512503, 'loop': 1, 'loss': 'MSE', 'lr': 0.009132559871897252, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.0003369094899123305, 'weightedloss': True}. Best is trial 37 with value: 69.8933334350586.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  9
alpha:  0.55
lr:  0.008089237059683008
weight_decay:  0.0006103041054261711
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.668598245130852
None Run 01:
Highest Train: 100.00
Highest Valid: 58.20
  Final Train: 100.00
   Final Test: 61.50
Split: 01, Run: 02
None time:  3.1306763431057334
None Run 02:
Highest Train: 100.00
Highest Valid: 60.20
  Final Train: 100.00
   Final Test: 62.70
Split: 01, Run: 03
None time:  2.036795562133193
None Run 03:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 60.60
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  2.164888668805361
None Run 04:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 70.50
Split: 02, Run: 02
None time:  1.709650075994432
None Run 05:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 70.40
Split: 02, Run: 03
None time:  1.6410284938756377
None Run 06:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 69.30
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.6471476389560848
None Run 07:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 69.80
Split: 03, Run: 02
None time:  1.656939976848662
None Run 08:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 68.70
Split: 03, Run: 03
None time:  1.5961723939981312
None Run 09:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 69.40
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.6727633990813047
None Run 10:
Highest Train: 100.00
Highest Valid: 59.80
  Final Train: 100.00
   Final Test: 60.80
Split: 04, Run: 02
None time:  2.105970756150782
None Run 11:
Highest Train: 100.00
Highest Valid: 60.60
  Final Train: 100.00
   Final Test: 61.30
Split: 04, Run: 03
None time:  1.7162348218262196
None Run 12:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 57.80
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.9429775751195848
None Run 13:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 58.40
Split: 05, Run: 02
None time:  1.8111373391002417
None Run 14:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 61.10
Split: 05, Run: 03
None time:  1.8032253989949822
None Run 15:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 57.90
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.6560722298454493
None Run 16:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 75.70
Split: 06, Run: 02
None time:  1.6664029071107507
None Run 17:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 76.10
Split: 06, Run: 03
None time:  1.6459790389053524
None Run 18:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 77.90
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.4552308139391243
None Run 19:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 76.00
Split: 07, Run: 02
None time:  2.3737213199492544
None Run 20:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 74.30
Split: 07, Run: 03
None time:  3.0377025508787483
None Run 21:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 75.70
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.9455818820279092
None Run 22:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 73.70
Split: 08, Run: 02
None time:  1.9432533921208233
None Run 23:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 76.20
Split: 08, Run: 03
None time:  2.0889147978741676
None Run 24:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 71.40
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.3438741548452526
None Run 25:
Highest Train: 100.00
Highest Valid: 81.00
  Final Train: 100.00
   Final Test: 77.40
Split: 09, Run: 02
None time:  2.019915547920391
None Run 26:
Highest Train: 100.00
Highest Valid: 81.80
  Final Train: 100.00
   Final Test: 77.80
Split: 09, Run: 03
None time:  2.2444346719421446
None Run 27:
Highest Train: 100.00
Highest Valid: 81.40
  Final Train: 100.00
   Final Test: 78.80
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  2.387960884021595
None Run 28:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 68.70
Split: 10, Run: 02
None time:  1.7834842349402606
None Run 29:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 67.00
Split: 10, Run: 03
None time:  2.2702925610356033
None Run 30:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 70.10
run time now: 6.490469217300415
total time:  62.30244585219771
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.24 ± 6.84
  Final Train: 100.00 ± 0.00
   Final Test: 69.23 ± 6.81
best run test_acc: 70.43999481201172
[I 2023-06-12 00:42:28,928] Trial 38 finished with value: 69.23999786376953 and parameters: {'Fwd': 0.000558343188167386, 'K': 9, 'alpha': 0.55, 'dropout': 0.2, 'gnnepoch': 50, 'lambda1': 0.05, 'lambda2': 8.554520907195563, 'loop': 2, 'loss': 'MSE', 'lr': 0.008089237059683008, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.0006103041054261711, 'weightedloss': True}. Best is trial 37 with value: 69.8933334350586.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  9
alpha:  0.7000000000000001
lr:  0.00993553368879708
weight_decay:  0.0005563891265886494
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.2239392211195081
None Run 01:
Highest Train: 100.00
Highest Valid: 59.80
  Final Train: 100.00
   Final Test: 61.50
Split: 01, Run: 02
None time:  1.2021033049095422
None Run 02:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 61.20
Split: 01, Run: 03
None time:  1.388243282912299
None Run 03:
Highest Train: 100.00
Highest Valid: 59.60
  Final Train: 100.00
   Final Test: 62.20
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.2202877411618829
None Run 04:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 68.60
Split: 02, Run: 02
None time:  1.1946148280985653
None Run 05:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 68.60
Split: 02, Run: 03
None time:  1.189052256057039
None Run 06:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 68.60
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1946701018605381
None Run 07:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 69.50
Split: 03, Run: 02
None time:  1.2025851048529148
None Run 08:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 70.40
Split: 03, Run: 03
None time:  1.260715447133407
None Run 09:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 70.00
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  2.1424954540561885
None Run 10:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 60.90
Split: 04, Run: 02
None time:  1.3201046220492572
None Run 11:
Highest Train: 100.00
Highest Valid: 57.80
  Final Train: 100.00
   Final Test: 60.30
Split: 04, Run: 03
None time:  1.4346298170275986
None Run 12:
Highest Train: 100.00
Highest Valid: 62.20
  Final Train: 100.00
   Final Test: 60.70
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.193638565018773
None Run 13:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 60.60
Split: 05, Run: 02
None time:  1.2140797718893737
None Run 14:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 56.20
Split: 05, Run: 03
None time:  1.4970741709694266
None Run 15:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 58.70
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.2072506858967245
None Run 16:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 77.90
Split: 06, Run: 02
None time:  1.1802041449118406
None Run 17:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 74.20
Split: 06, Run: 03
None time:  1.2987603128422052
None Run 18:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 76.40
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.2297295141033828
None Run 19:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 69.70
Split: 07, Run: 02
None time:  1.4365870968904346
None Run 20:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 71.30
Split: 07, Run: 03
None time:  2.8884906340390444
None Run 21:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 71.70
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.2679104711860418
None Run 22:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 75.70
Split: 08, Run: 02
None time:  1.2290357709862292
None Run 23:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 72.80
Split: 08, Run: 03
None time:  1.7451592669822276
None Run 24:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 72.80
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.2096470000687987
None Run 25:
Highest Train: 100.00
Highest Valid: 78.80
  Final Train: 100.00
   Final Test: 76.10
Split: 09, Run: 02
None time:  1.17853904212825
None Run 26:
Highest Train: 100.00
Highest Valid: 80.40
  Final Train: 100.00
   Final Test: 78.80
Split: 09, Run: 03
None time:  1.2251163918990642
None Run 27:
Highest Train: 100.00
Highest Valid: 79.20
  Final Train: 100.00
   Final Test: 76.90
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.211212701862678
None Run 28:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 64.90
Split: 10, Run: 02
None time:  1.2422027681022882
None Run 29:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 64.30
Split: 10, Run: 03
None time:  1.269207642879337
None Run 30:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 69.10
run time now: 3.7705142498016357
total time:  41.83794410293922
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 68.39 ± 6.32
  Final Train: 100.00 ± 0.00
   Final Test: 68.35 ± 6.43
best run test_acc: 69.59000396728516
[I 2023-06-12 00:43:11,205] Trial 39 finished with value: 68.38667297363281 and parameters: {'Fwd': 0.0005092114212791579, 'K': 9, 'alpha': 0.7000000000000001, 'dropout': 0.30000000000000004, 'gnnepoch': 40, 'lambda1': 0.05, 'lambda2': 7.29962292567518, 'loop': 1, 'loss': 'MSE', 'lr': 0.00993553368879708, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.0005563891265886494, 'weightedloss': False}. Best is trial 37 with value: 69.8933334350586.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.45
lr:  0.007009619676116144
weight_decay:  0.000254891779592055
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.877023598179221
None Run 01:
Highest Train: 100.00
Highest Valid: 60.60
  Final Train: 100.00
   Final Test: 62.20
Split: 01, Run: 02
None time:  1.7143583938013762
None Run 02:
Highest Train: 100.00
Highest Valid: 56.20
  Final Train: 100.00
   Final Test: 58.60
Split: 01, Run: 03
None time:  1.8164406691212207
None Run 03:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 59.60
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.8172946048434824
None Run 04:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 68.90
Split: 02, Run: 02
None time:  1.909252603072673
None Run 05:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 68.60
Split: 02, Run: 03
None time:  1.9009082128759474
None Run 06:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 68.70
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  3.680081047816202
None Run 07:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 70.50
Split: 03, Run: 02
None time:  1.804867688100785
None Run 08:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 69.40
Split: 03, Run: 03
None time:  2.3404182430822402
None Run 09:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 68.80
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.593211135128513
None Run 10:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 60.10
Split: 04, Run: 02
None time:  1.8665544330142438
None Run 11:
Highest Train: 100.00
Highest Valid: 61.00
  Final Train: 100.00
   Final Test: 60.50
Split: 04, Run: 03
None time:  1.835857582045719
None Run 12:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 59.50
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.9017754350788891
None Run 13:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 59.60
Split: 05, Run: 02
None time:  1.9098364249803126
None Run 14:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 62.90
Split: 05, Run: 03
None time:  1.8685675680171698
None Run 15:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 64.30
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  2.3919896921142936
None Run 16:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 77.50
Split: 06, Run: 02
None time:  1.6455152600537986
None Run 17:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 77.20
Split: 06, Run: 03
None time:  1.6851690078619868
None Run 18:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 76.30
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.7442453410476446
None Run 19:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 75.90
Split: 07, Run: 02
None time:  3.176661411067471
None Run 20:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 73.10
Split: 07, Run: 03
None time:  2.706937479088083
None Run 21:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 75.50
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  2.1060310539323837
None Run 22:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 76.00
Split: 08, Run: 02
None time:  2.067543925018981
None Run 23:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 76.80
Split: 08, Run: 03
None time:  2.2839153229724616
None Run 24:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 75.60
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.2098303160164505
None Run 25:
Highest Train: 100.00
Highest Valid: 81.80
  Final Train: 100.00
   Final Test: 78.00
Split: 09, Run: 02
None time:  2.563600525027141
None Run 26:
Highest Train: 100.00
Highest Valid: 81.60
  Final Train: 100.00
   Final Test: 77.80
Split: 09, Run: 03
None time:  2.3501783120445907
None Run 27:
Highest Train: 100.00
Highest Valid: 81.00
  Final Train: 100.00
   Final Test: 77.80
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.8922248799353838
None Run 28:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 68.30
Split: 10, Run: 02
None time:  2.075194298988208
None Run 29:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 69.90
Split: 10, Run: 03
None time:  1.9641698731575161
None Run 30:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 66.20
run time now: 5.979745388031006
total time:  65.78197478805669
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.49 ± 7.41
  Final Train: 100.00 ± 0.00
   Final Test: 69.47 ± 6.76
best run test_acc: 70.44999694824219
[I 2023-06-12 00:44:17,439] Trial 40 finished with value: 69.4866714477539 and parameters: {'Fwd': 0.0011538427961057958, 'K': 8, 'alpha': 0.45, 'dropout': 0.2, 'gnnepoch': 70, 'lambda1': 0.15000000000000002, 'lambda2': 7.3506625936527925, 'loop': 1, 'loss': 'MSE', 'lr': 0.007009619676116144, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.000254891779592055, 'weightedloss': True}. Best is trial 37 with value: 69.8933334350586.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.5
lr:  0.009704801217840975
weight_decay:  0.00014609696292172653
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.3557342030107975
None Run 01:
Highest Train: 100.00
Highest Valid: 58.20
  Final Train: 100.00
   Final Test: 61.10
Split: 01, Run: 02
None time:  2.2626765880268067
None Run 02:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 61.70
Split: 01, Run: 03
None time:  1.3757016588933766
None Run 03:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 59.70
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.5462997548747808
None Run 04:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 70.70
Split: 02, Run: 02
None time:  1.5048342389054596
None Run 05:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 69.50
Split: 02, Run: 03
None time:  1.6329731340520084
None Run 06:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 69.70
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.346520972903818
None Run 07:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 68.30
Split: 03, Run: 02
None time:  1.8085652738809586
None Run 08:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 69.40
Split: 03, Run: 03
None time:  1.3142473718617111
None Run 09:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 68.80
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.5760117419995368
None Run 10:
Highest Train: 100.00
Highest Valid: 60.40
  Final Train: 100.00
   Final Test: 61.40
Split: 04, Run: 02
None time:  1.3748345039784908
None Run 11:
Highest Train: 100.00
Highest Valid: 60.20
  Final Train: 100.00
   Final Test: 60.40
Split: 04, Run: 03
None time:  1.4358978420495987
None Run 12:
Highest Train: 100.00
Highest Valid: 60.20
  Final Train: 100.00
   Final Test: 61.30
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.707707597874105
None Run 13:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 58.00
Split: 05, Run: 02
None time:  1.7008974431082606
None Run 14:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 61.50
Split: 05, Run: 03
None time:  1.5546576180495322
None Run 15:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 60.20
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.6577017828822136
None Run 16:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 75.80
Split: 06, Run: 02
None time:  1.43453992693685
None Run 17:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 78.20
Split: 06, Run: 03
None time:  1.4431355730630457
None Run 18:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 76.30
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.7947387560270727
None Run 19:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 73.40
Split: 07, Run: 02
None time:  1.6542723118327558
None Run 20:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 72.80
Split: 07, Run: 03
None time:  2.1506510379258543
None Run 21:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 75.40
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.8319200698751956
None Run 22:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 74.20
Split: 08, Run: 02
None time:  1.9001768887974322
None Run 23:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 75.40
Split: 08, Run: 03
None time:  2.2156440559774637
None Run 24:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 78.40
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.4151911160442978
None Run 25:
Highest Train: 100.00
Highest Valid: 80.80
  Final Train: 100.00
   Final Test: 78.50
Split: 09, Run: 02
None time:  1.4323167859110981
None Run 26:
Highest Train: 100.00
Highest Valid: 79.80
  Final Train: 100.00
   Final Test: 77.50
Split: 09, Run: 03
None time:  1.4599307840690017
None Run 27:
Highest Train: 100.00
Highest Valid: 81.20
  Final Train: 100.00
   Final Test: 78.80
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.5)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.431514744879678
None Run 28:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 69.20
Split: 10, Run: 02
None time:  1.556419478962198
None Run 29:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 69.00
Split: 10, Run: 03
None time:  2.540387324988842
None Run 30:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 70.10
run time now: 5.5774781703948975
total time:  50.565662782872096
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.29 ± 6.91
  Final Train: 100.00 ± 0.00
   Final Test: 69.49 ± 6.75
best run test_acc: 70.56000518798828
[I 2023-06-12 00:45:08,457] Trial 41 finished with value: 69.2933349609375 and parameters: {'Fwd': 0.00011396649940967541, 'K': 8, 'alpha': 0.5, 'dropout': 0.30000000000000004, 'gnnepoch': 50, 'lambda1': 0.05, 'lambda2': 7.846006147767736, 'loop': 1, 'loss': 'MSE', 'lr': 0.009704801217840975, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.00014609696292172653, 'weightedloss': True}. Best is trial 37 with value: 69.8933334350586.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  0.55
lr:  0.007385690509322174
weight_decay:  0.00036648102609537027
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.3907250710763037
None Run 01:
Highest Train: 100.00
Highest Valid: 52.20
  Final Train: 100.00
   Final Test: 55.20
Split: 01, Run: 02
None time:  1.4210148309357464
None Run 02:
Highest Train: 100.00
Highest Valid: 52.20
  Final Train: 100.00
   Final Test: 55.20
Split: 01, Run: 03
None time:  1.3890188988298178
None Run 03:
Highest Train: 100.00
Highest Valid: 52.20
  Final Train: 100.00
   Final Test: 55.20
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.4583678739145398
None Run 04:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 69.20
Split: 02, Run: 02
None time:  1.45396613702178
None Run 05:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 69.20
Split: 02, Run: 03
None time:  1.4141074889339507
None Run 06:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 69.20
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.4527641560416669
None Run 07:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 63.00
Split: 03, Run: 02
None time:  1.4586395148653537
None Run 08:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 63.00
Split: 03, Run: 03
None time:  1.4940105120185763
None Run 09:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 63.00
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.348715536063537
None Run 10:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 100.00
   Final Test: 56.90
Split: 04, Run: 02
None time:  1.3096468620933592
None Run 11:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 100.00
   Final Test: 56.90
Split: 04, Run: 03
None time:  1.3632800648920238
None Run 12:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 100.00
   Final Test: 56.90
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.7976350341923535
None Run 13:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.50
Split: 05, Run: 02
None time:  1.7285989259835333
None Run 14:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.50
Split: 05, Run: 03
None time:  1.7185549570713192
None Run 15:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.50
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.8818542880471796
None Run 16:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 71.70
Split: 06, Run: 02
None time:  1.959928510012105
None Run 17:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 71.70
Split: 06, Run: 03
None time:  1.946722320979461
None Run 18:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 71.70
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.5059105560649186
None Run 19:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 72.40
Split: 07, Run: 02
None time:  1.5935549759306014
None Run 20:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 72.40
Split: 07, Run: 03
None time:  1.5167174299713224
None Run 21:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 72.40
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.3764807609841228
None Run 22:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 74.60
Split: 08, Run: 02
None time:  1.3338540978729725
None Run 23:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 74.60
Split: 08, Run: 03
None time:  1.412955075968057
None Run 24:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 74.60
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.252379841869697
None Run 25:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 74.40
Split: 09, Run: 02
None time:  2.2430651909671724
None Run 26:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 74.40
Split: 09, Run: 03
None time:  2.2770515161100775
None Run 27:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 74.40
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.4057144951075315
None Run 28:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 65.90
Split: 10, Run: 02
None time:  1.3759720409289002
None Run 29:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 65.90
Split: 10, Run: 03
None time:  1.3748523339163512
None Run 30:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 65.90
run time now: 4.201579570770264
total time:  48.70934435003437
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 67.06 ± 7.81
  Final Train: 100.00 ± 0.00
   Final Test: 67.48 ± 6.78
best run test_acc: 67.47999572753906
[I 2023-06-12 00:45:57,607] Trial 42 finished with value: 67.05999755859375 and parameters: {'Fwd': 0.00013410563457354766, 'K': 7, 'alpha': 0.55, 'dropout': 0.30000000000000004, 'gnnepoch': 50, 'lambda1': 0.0, 'lambda2': 8.448706460796583, 'loop': 1, 'loss': 'MSE', 'lr': 0.007385690509322174, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.00036648102609537027, 'weightedloss': True}. Best is trial 37 with value: 69.8933334350586.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  9
alpha:  0.45
lr:  0.007291849378176715
weight_decay:  0.0001118324337524286
dropout:  0.5
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.6891687819734216
None Run 01:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 61.20
Split: 01, Run: 02
None time:  1.5660671729128808
None Run 02:
Highest Train: 100.00
Highest Valid: 57.40
  Final Train: 100.00
   Final Test: 59.80
Split: 01, Run: 03
None time:  1.6350390629377216
None Run 03:
Highest Train: 100.00
Highest Valid: 59.20
  Final Train: 100.00
   Final Test: 61.20
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.87360425805673
None Run 04:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 70.30
Split: 02, Run: 02
None time:  1.5867960499599576
None Run 05:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 68.40
Split: 02, Run: 03
None time:  1.8400641940534115
None Run 06:
Highest Train: 100.00
Highest Valid: 67.40
  Final Train: 100.00
   Final Test: 67.90
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.5542142309714109
None Run 07:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 69.10
Split: 03, Run: 02
None time:  2.8234782440122217
None Run 08:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 69.20
Split: 03, Run: 03
None time:  1.5484856117982417
None Run 09:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 69.70
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.5748745349701494
None Run 10:
Highest Train: 100.00
Highest Valid: 59.20
  Final Train: 100.00
   Final Test: 60.70
Split: 04, Run: 02
None time:  1.6527804778888822
None Run 11:
Highest Train: 100.00
Highest Valid: 58.20
  Final Train: 100.00
   Final Test: 58.80
Split: 04, Run: 03
None time:  1.518742399988696
None Run 12:
Highest Train: 100.00
Highest Valid: 61.80
  Final Train: 100.00
   Final Test: 60.50
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.911151710897684
None Run 13:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 57.70
Split: 05, Run: 02
None time:  1.6334495421033353
None Run 14:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 61.70
Split: 05, Run: 03
None time:  1.7083252298180014
None Run 15:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 60.10
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  2.32823192817159
None Run 16:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 78.30
Split: 06, Run: 02
None time:  1.566837432095781
None Run 17:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 75.80
Split: 06, Run: 03
None time:  3.039929111022502
None Run 18:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 75.80
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.794187312014401
None Run 19:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 71.70
Split: 07, Run: 02
None time:  1.703260475071147
None Run 20:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 69.90
Split: 07, Run: 03
None time:  1.8108612231444567
None Run 21:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 71.50
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  2.509625277016312
None Run 22:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 77.90
Split: 08, Run: 02
None time:  2.33376075909473
None Run 23:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 77.10
Split: 08, Run: 03
None time:  2.465828093001619
None Run 24:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 76.40
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.4493214779067785
None Run 25:
Highest Train: 100.00
Highest Valid: 80.80
  Final Train: 100.00
   Final Test: 77.30
Split: 09, Run: 02
None time:  2.126353479921818
None Run 26:
Highest Train: 100.00
Highest Valid: 81.40
  Final Train: 100.00
   Final Test: 78.00
Split: 09, Run: 03
None time:  1.5992625849321485
None Run 27:
Highest Train: 100.00
Highest Valid: 80.00
  Final Train: 100.00
   Final Test: 77.30
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  2.708862255094573
None Run 28:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 68.80
Split: 10, Run: 02
None time:  1.8990559049416333
None Run 29:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 68.70
Split: 10, Run: 03
None time:  1.837023685919121
None Run 30:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 68.60
run time now: 6.498281240463257
total time:  59.46091763116419
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.15 ± 6.92
  Final Train: 100.00 ± 0.00
   Final Test: 68.98 ± 6.77
best run test_acc: 69.83000183105469
[I 2023-06-12 00:46:57,687] Trial 43 finished with value: 69.15333557128906 and parameters: {'Fwd': 0.0003179211478294751, 'K': 9, 'alpha': 0.45, 'dropout': 0.5, 'gnnepoch': 60, 'lambda1': 0.15000000000000002, 'lambda2': 7.495573608621894, 'loop': 1, 'loss': 'MSE', 'lr': 0.007291849378176715, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.0001118324337524286, 'weightedloss': True}. Best is trial 37 with value: 69.8933334350586.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.6000000000000001
lr:  0.009732183322588997
weight_decay:  0.0002488273090755528
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.0706768401432782
None Run 01:
Highest Train: 100.00
Highest Valid: 60.00
  Final Train: 100.00
   Final Test: 62.40
Split: 01, Run: 02
None time:  2.31201896793209
None Run 02:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 66.60
Split: 01, Run: 03
None time:  2.688900392036885
None Run 03:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 64.90
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.2307217679917812
None Run 04:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 67.50
Split: 02, Run: 02
None time:  2.0810801261104643
None Run 05:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 71.30
Split: 02, Run: 03
None time:  1.109380521113053
None Run 06:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 69.40
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.6496614979114383
None Run 07:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 71.30
Split: 03, Run: 02
None time:  0.9687525262124836
None Run 08:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 70.30
Split: 03, Run: 03
None time:  1.7480275030247867
None Run 09:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 70.70
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.0535652399994433
None Run 10:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 58.00
Split: 04, Run: 02
None time:  1.0854562418535352
None Run 11:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 59.40
Split: 04, Run: 03
None time:  1.0193506840150803
None Run 12:
Highest Train: 100.00
Highest Valid: 61.00
  Final Train: 100.00
   Final Test: 60.30
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.2806793400086462
None Run 13:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 58.20
Split: 05, Run: 02
None time:  1.053381553152576
None Run 14:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 59.20
Split: 05, Run: 03
None time:  1.154058980057016
None Run 15:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 57.80
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.137776300078258
None Run 16:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 77.00
Split: 06, Run: 02
None time:  1.04080545110628
None Run 17:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 78.20
Split: 06, Run: 03
None time:  1.274260976118967
None Run 18:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 77.90
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.6542729809880257
None Run 19:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 72.20
Split: 07, Run: 02
None time:  1.726079171989113
None Run 20:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 73.10
Split: 07, Run: 03
None time:  1.5136942800600082
None Run 21:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 70.30
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.5843509519472718
None Run 22:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 74.80
Split: 08, Run: 02
None time:  1.4570945389568806
None Run 23:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 77.40
Split: 08, Run: 03
None time:  1.4704852171707898
None Run 24:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 76.30
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.7287529581226408
None Run 25:
Highest Train: 100.00
Highest Valid: 81.60
  Final Train: 100.00
   Final Test: 78.40
Split: 09, Run: 02
None time:  1.7291157839354128
None Run 26:
Highest Train: 100.00
Highest Valid: 81.00
  Final Train: 100.00
   Final Test: 77.30
Split: 09, Run: 03
None time:  1.878847368992865
None Run 27:
Highest Train: 100.00
Highest Valid: 80.80
  Final Train: 100.00
   Final Test: 78.20
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.2558508559595793
None Run 28:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 68.30
Split: 10, Run: 02
None time:  1.3136386980768293
None Run 29:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 67.80
Split: 10, Run: 03
None time:  1.2515968019142747
None Run 30:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 68.90
run time now: 3.879471778869629
total time:  44.844674149062485
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.85 ± 6.35
  Final Train: 100.00 ± 0.00
   Final Test: 69.45 ± 6.85
best run test_acc: 70.47000122070312
[I 2023-06-12 00:47:43,002] Trial 44 finished with value: 69.85334014892578 and parameters: {'Fwd': 0.00012974952086810854, 'K': 8, 'alpha': 0.6000000000000001, 'dropout': 0.1, 'gnnepoch': 30, 'lambda1': 0.1, 'lambda2': 8.936164831599509, 'loop': 1, 'loss': 'MSE', 'lr': 0.009732183322588997, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.0002488273090755528, 'weightedloss': True}. Best is trial 37 with value: 69.8933334350586.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  0.6000000000000001
lr:  0.009980000771641753
weight_decay:  0.0009657180469771238
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.0155728028621525
None Run 01:
Highest Train: 100.00
Highest Valid: 59.80
  Final Train: 100.00
   Final Test: 62.30
Split: 01, Run: 02
None time:  1.1383367718663067
None Run 02:
Highest Train: 100.00
Highest Valid: 59.20
  Final Train: 100.00
   Final Test: 62.20
Split: 01, Run: 03
None time:  2.745123450877145
None Run 03:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 64.30
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.2335038620512933
None Run 04:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 67.70
Split: 02, Run: 02
None time:  1.7212494499981403
None Run 05:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 69.60
Split: 02, Run: 03
None time:  1.2087457550223917
None Run 06:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 68.50
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  2.1246241480112076
None Run 07:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 71.40
Split: 03, Run: 02
None time:  1.4328793729655445
None Run 08:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 70.20
Split: 03, Run: 03
None time:  1.1789764259010553
None Run 09:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 71.00
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.1295974480453879
None Run 10:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 60.00
Split: 04, Run: 02
None time:  1.06430485798046
None Run 11:
Highest Train: 100.00
Highest Valid: 60.40
  Final Train: 100.00
   Final Test: 60.30
Split: 04, Run: 03
None time:  1.1226418840233237
None Run 12:
Highest Train: 100.00
Highest Valid: 58.00
  Final Train: 100.00
   Final Test: 58.30
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.0096942740492523
None Run 13:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 58.60
Split: 05, Run: 02
None time:  1.0663682350423187
None Run 14:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 59.00
Split: 05, Run: 03
None time:  1.1296914680860937
None Run 15:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 57.90
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.036023115972057
None Run 16:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 78.30
Split: 06, Run: 02
None time:  1.0419523168820888
None Run 17:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 77.90
Split: 06, Run: 03
None time:  1.73639450292103
None Run 18:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 76.80
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.7764126600231975
None Run 19:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 76.50
Split: 07, Run: 02
None time:  2.42108146706596
None Run 20:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 76.90
Split: 07, Run: 03
None time:  2.5661330609582365
None Run 21:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 77.40
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.2406528459396213
None Run 22:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 73.50
Split: 08, Run: 02
None time:  1.4411330008879304
None Run 23:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 77.30
Split: 08, Run: 03
None time:  1.3201688290573657
None Run 24:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 77.60
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.597850905964151
None Run 25:
Highest Train: 100.00
Highest Valid: 81.00
  Final Train: 100.00
   Final Test: 78.00
Split: 09, Run: 02
None time:  1.5434607099741697
None Run 26:
Highest Train: 100.00
Highest Valid: 81.40
  Final Train: 100.00
   Final Test: 78.20
Split: 09, Run: 03
None time:  1.521843490190804
None Run 27:
Highest Train: 100.00
Highest Valid: 81.20
  Final Train: 100.00
   Final Test: 78.30
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.254111316986382
None Run 28:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 69.20
Split: 10, Run: 02
None time:  1.502217415953055
None Run 29:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 68.40
Split: 10, Run: 03
None time:  1.0682179420255125
None Run 30:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 68.50
run time now: 3.868635892868042
total time:  45.47799549996853
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 70.00 ± 6.93
  Final Train: 100.00 ± 0.00
   Final Test: 69.80 ± 7.29
best run test_acc: 70.54000091552734
[I 2023-06-12 00:48:29,015] Trial 45 finished with value: 70.0 and parameters: {'Fwd': 8.40713911990114e-05, 'K': 7, 'alpha': 0.6000000000000001, 'dropout': 0.1, 'gnnepoch': 30, 'lambda1': 0.1, 'lambda2': 9.014086924038754, 'loop': 1, 'loss': 'MSE', 'lr': 0.009980000771641753, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.0009657180469771238, 'weightedloss': True}. Best is trial 45 with value: 70.0.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  0.6000000000000001
lr:  0.008783192664265742
weight_decay:  0.0011421322267365587
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.2827660779003054
None Run 01:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 63.20
Split: 01, Run: 02
None time:  1.076832580147311
None Run 02:
Highest Train: 100.00
Highest Valid: 59.60
  Final Train: 100.00
   Final Test: 63.00
Split: 01, Run: 03
None time:  1.0573018670547754
None Run 03:
Highest Train: 100.00
Highest Valid: 59.60
  Final Train: 100.00
   Final Test: 62.30
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.8375084460712969
None Run 04:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 67.40
Split: 02, Run: 02
None time:  0.9100138351786882
None Run 05:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 67.40
Split: 02, Run: 03
None time:  0.9179490657988936
None Run 06:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 67.40
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.3137695139739662
None Run 07:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 72.30
Split: 03, Run: 02
None time:  0.9428246489260346
None Run 08:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 71.00
Split: 03, Run: 03
None time:  0.9551864811219275
None Run 09:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 69.50
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.113737623905763
None Run 10:
Highest Train: 100.00
Highest Valid: 57.40
  Final Train: 100.00
   Final Test: 58.80
Split: 04, Run: 02
None time:  1.5212395580019802
None Run 11:
Highest Train: 100.00
Highest Valid: 60.20
  Final Train: 100.00
   Final Test: 58.00
Split: 04, Run: 03
None time:  0.7364971779752523
None Run 12:
Highest Train: 100.00
Highest Valid: 56.40
  Final Train: 100.00
   Final Test: 58.40
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.0576252269092947
None Run 13:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 57.80
Split: 05, Run: 02
None time:  1.3628212709445506
None Run 14:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 57.00
Split: 05, Run: 03
None time:  1.5717822089791298
None Run 15:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 58.30
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.0463848889339715
None Run 16:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 79.60
Split: 06, Run: 02
None time:  1.1922830981202424
None Run 17:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 79.20
Split: 06, Run: 03
None time:  1.2547978579532355
None Run 18:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 79.60
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.268523800885305
None Run 19:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 70.50
Split: 07, Run: 02
None time:  1.2628892019856721
None Run 20:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 69.40
Split: 07, Run: 03
None time:  3.788843653863296
None Run 21:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 73.10
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.9670942451339215
None Run 22:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 72.50
Split: 08, Run: 02
None time:  0.9899333629291505
None Run 23:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 72.50
Split: 08, Run: 03
None time:  1.0100938379764557
None Run 24:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 72.50
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.5559963951818645
None Run 25:
Highest Train: 100.00
Highest Valid: 79.60
  Final Train: 100.00
   Final Test: 77.80
Split: 09, Run: 02
None time:  1.4639896878506988
None Run 26:
Highest Train: 100.00
Highest Valid: 80.00
  Final Train: 100.00
   Final Test: 78.00
Split: 09, Run: 03
None time:  1.1860255028586835
None Run 27:
Highest Train: 100.00
Highest Valid: 78.80
  Final Train: 100.00
   Final Test: 77.30
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.927551053930074
None Run 28:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 66.40
Split: 10, Run: 02
None time:  0.9331401449162513
None Run 29:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 66.80
Split: 10, Run: 03
None time:  1.00576539686881
None Run 30:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 66.70
run time now: 2.920894145965576
total time:  38.65555379004218
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 68.41 ± 6.76
  Final Train: 100.00 ± 0.00
   Final Test: 68.46 ± 7.14
best run test_acc: 68.99999237060547
[I 2023-06-12 00:49:08,204] Trial 46 finished with value: 68.413330078125 and parameters: {'Fwd': 7.27085647066984e-05, 'K': 7, 'alpha': 0.6000000000000001, 'dropout': 0.1, 'gnnepoch': 30, 'lambda1': 0.1, 'lambda2': 9.052440091347147, 'loop': 1, 'loss': 'MSE', 'lr': 0.008783192664265742, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.0011421322267365587, 'weightedloss': False}. Best is trial 45 with value: 70.0.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.7000000000000001
lr:  0.009760140972571855
weight_decay:  0.0027081248595890737
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.4871859580744058
None Run 01:
Highest Train: 100.00
Highest Valid: 49.80
  Final Train: 100.00
   Final Test: 52.60
Split: 01, Run: 02
None time:  0.5026709090452641
None Run 02:
Highest Train: 100.00
Highest Valid: 49.80
  Final Train: 100.00
   Final Test: 52.60
Split: 01, Run: 03
None time:  1.7136285149026662
None Run 03:
Highest Train: 100.00
Highest Valid: 60.80
  Final Train: 100.00
   Final Test: 62.10
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.085059697041288
None Run 04:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 68.00
Split: 02, Run: 02
None time:  0.9109420739114285
None Run 05:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 68.60
Split: 02, Run: 03
None time:  1.0558477940503508
None Run 06:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 67.30
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.5721914269961417
None Run 07:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 70.70
Split: 03, Run: 02
None time:  0.9225750740151852
None Run 08:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 69.80
Split: 03, Run: 03
None time:  0.8589802999049425
None Run 09:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 69.20
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.5213699347805232
None Run 10:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 58.50
Split: 04, Run: 02
None time:  0.5284470098558813
None Run 11:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 58.50
Split: 04, Run: 03
None time:  0.5168117410503328
None Run 12:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 58.50
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.49572804919444025
None Run 13:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 60.00
Split: 05, Run: 02
None time:  0.5041058310307562
None Run 14:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 60.00
Split: 05, Run: 03
None time:  0.5168598110321909
None Run 15:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 60.00
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.2382290200330317
None Run 16:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 75.20
Split: 06, Run: 02
None time:  1.0422105907928199
None Run 17:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 79.60
Split: 06, Run: 03
None time:  1.2978776439558715
None Run 18:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 77.50
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.7213493108283728
None Run 19:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 66.90
Split: 07, Run: 02
None time:  1.260948003968224
None Run 20:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 70.30
Split: 07, Run: 03
None time:  1.7069679840933532
None Run 21:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 70.30
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.5118574160151184
None Run 22:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 73.10
Split: 08, Run: 02
None time:  0.9995778300799429
None Run 23:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 69.00
Split: 08, Run: 03
None time:  0.5028863069601357
None Run 24:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 73.10
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.1672937381081283
None Run 25:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 74.50
Split: 09, Run: 02
None time:  0.5033517489209771
None Run 26:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 69.80
Split: 09, Run: 03
None time:  0.9650191848631948
None Run 27:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 72.80
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.0717381332069635
None Run 28:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 67.30
Split: 10, Run: 02
None time:  1.074886301998049
None Run 29:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 63.70
Split: 10, Run: 03
None time:  0.8534850929863751
None Run 30:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 68.80
run time now: 3.0798730850219727
total time:  28.33746393606998
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 67.09 ± 7.38
  Final Train: 100.00 ± 0.00
   Final Test: 66.94 ± 6.90
best run test_acc: 68.6199951171875
[I 2023-06-12 00:49:37,091] Trial 47 finished with value: 67.09333801269531 and parameters: {'Fwd': 0.00026239376986279096, 'K': 8, 'alpha': 0.7000000000000001, 'dropout': 0.1, 'gnnepoch': 0, 'lambda1': 0.15000000000000002, 'lambda2': 9.884447402345884, 'loop': 1, 'loss': 'MSE', 'lr': 0.009760140972571855, 'softmaxF': False, 'useGCN': True, 'weight_decay': 0.0027081248595890737, 'weightedloss': True}. Best is trial 45 with value: 70.0.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  0.6000000000000001
lr:  0.005832633577534377
weight_decay:  0.00027906686573251065
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.8725979048758745
None Run 01:
Highest Train: 100.00
Highest Valid: 50.80
  Final Train: 100.00
   Final Test: 52.50
Split: 01, Run: 02
None time:  0.8465433230157942
None Run 02:
Highest Train: 100.00
Highest Valid: 50.80
  Final Train: 100.00
   Final Test: 52.50
Split: 01, Run: 03
None time:  0.8518269099295139
None Run 03:
Highest Train: 100.00
Highest Valid: 50.80
  Final Train: 100.00
   Final Test: 52.50
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.8326084739528596
None Run 04:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 67.40
Split: 02, Run: 02
None time:  0.8775757220573723
None Run 05:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 66.50
Split: 02, Run: 03
None time:  1.042471859138459
None Run 06:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 66.90
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.828897648025304
None Run 07:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 70.00
Split: 03, Run: 02
None time:  0.8467131939250976
None Run 08:
Highest Train: 100.00
Highest Valid: 57.60
  Final Train: 100.00
   Final Test: 60.60
Split: 03, Run: 03
None time:  1.702731576981023
None Run 09:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 65.00
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.2563110319897532
None Run 10:
Highest Train: 100.00
Highest Valid: 58.00
  Final Train: 100.00
   Final Test: 54.60
Split: 04, Run: 02
None time:  2.345763781107962
None Run 11:
Highest Train: 100.00
Highest Valid: 58.00
  Final Train: 100.00
   Final Test: 54.70
Split: 04, Run: 03
None time:  0.8665360040031374
None Run 12:
Highest Train: 100.00
Highest Valid: 56.40
  Final Train: 100.00
   Final Test: 58.40
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.8977019428275526
None Run 13:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 60.40
Split: 05, Run: 02
None time:  0.86748380609788
None Run 14:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 60.40
Split: 05, Run: 03
None time:  0.8361110799014568
None Run 15:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 60.40
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.9303468551952392
None Run 16:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 78.20
Split: 06, Run: 02
None time:  3.8097511071246117
None Run 17:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 76.90
Split: 06, Run: 03
None time:  0.9488207870163023
None Run 18:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 74.70
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  3.1070538519416004
None Run 19:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 70.60
Split: 07, Run: 02
None time:  1.0992900670971721
None Run 20:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 68.30
Split: 07, Run: 03
None time:  2.793794584926218
None Run 21:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 70.20
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.8337336140684783
None Run 22:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 72.50
Split: 08, Run: 02
None time:  0.8145195059478283
None Run 23:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 72.50
Split: 08, Run: 03
None time:  0.7711932079400867
None Run 24:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 72.50
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.7455035680904984
None Run 25:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 72.70
Split: 09, Run: 02
None time:  0.8343878958839923
None Run 26:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 69.80
Split: 09, Run: 03
None time:  0.8083576920907944
None Run 27:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 69.80
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.2665156130678952
None Run 28:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 70.80
Split: 10, Run: 02
None time:  1.5352509450167418
None Run 29:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 67.20
Split: 10, Run: 03
None time:  1.0258719390258193
None Run 30:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 67.90
run time now: 3.8789453506469727
total time:  40.24670596816577
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 66.02 ± 7.74
  Final Train: 100.00 ± 0.00
   Final Test: 65.91 ± 7.48
best run test_acc: 67.34999084472656
[I 2023-06-12 00:50:17,880] Trial 48 finished with value: 66.02000427246094 and parameters: {'Fwd': 9.650055098494681e-05, 'K': 7, 'alpha': 0.6000000000000001, 'dropout': 0.2, 'gnnepoch': 10, 'lambda1': 0.1, 'lambda2': 9.35457479869902, 'loop': 2, 'loss': 'MSE', 'lr': 0.005832633577534377, 'softmaxF': False, 'useGCN': True, 'weight_decay': 0.00027906686573251065, 'weightedloss': False}. Best is trial 45 with value: 70.0.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  9
alpha:  0.65
lr:  0.004066670731302219
weight_decay:  0.0008210409775578447
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.9919131209608167
None Run 01:
Highest Train: 100.00
Highest Valid: 52.20
  Final Train: 100.00
   Final Test: 54.40
Split: 01, Run: 02
None time:  1.0055608658585697
None Run 02:
Highest Train: 100.00
Highest Valid: 52.20
  Final Train: 100.00
   Final Test: 54.40
Split: 01, Run: 03
None time:  1.0062522650696337
None Run 03:
Highest Train: 100.00
Highest Valid: 52.20
  Final Train: 100.00
   Final Test: 54.40
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.069045637967065
None Run 04:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 69.00
Split: 02, Run: 02
None time:  1.0125762128736824
None Run 05:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 69.00
Split: 02, Run: 03
None time:  1.0640361241530627
None Run 06:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 69.00
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1644532710779458
None Run 07:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 63.30
Split: 03, Run: 02
None time:  1.1228565480560064
None Run 08:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 63.30
Split: 03, Run: 03
None time:  1.1128769139759243
None Run 09:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 63.30
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.0120367349591106
None Run 10:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 58.40
Split: 04, Run: 02
None time:  1.0327418488450348
None Run 11:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 58.40
Split: 04, Run: 03
None time:  1.0192628188524395
None Run 12:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 58.40
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.4145216061733663
None Run 13:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.50
Split: 05, Run: 02
None time:  1.3499515540897846
None Run 14:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.50
Split: 05, Run: 03
None time:  1.3814872209914029
None Run 15:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.50
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.5593608061317354
None Run 16:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 71.60
Split: 06, Run: 02
None time:  1.5133657869882882
None Run 17:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 71.60
Split: 06, Run: 03
None time:  1.4799884078092873
None Run 18:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 71.60
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.2539974038954824
None Run 19:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 72.40
Split: 07, Run: 02
None time:  1.2512752749025822
None Run 20:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 72.40
Split: 07, Run: 03
None time:  1.2126244029495865
None Run 21:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 72.40
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.9545759079046547
None Run 22:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 74.90
Split: 08, Run: 02
None time:  1.106054857838899
None Run 23:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 74.90
Split: 08, Run: 03
None time:  1.1007144250907004
None Run 24:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 74.90
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.8156456002034247
None Run 25:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 74.40
Split: 09, Run: 02
None time:  1.7802337859757245
None Run 26:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 74.40
Split: 09, Run: 03
None time:  1.8016125708818436
None Run 27:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 74.40
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.0673277389723808
None Run 28:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 65.50
Split: 10, Run: 02
None time:  1.0274605890735984
None Run 29:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 65.50
Split: 10, Run: 03
None time:  1.0591626418754458
None Run 30:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 65.50
run time now: 3.2287397384643555
total time:  37.90181129798293
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 66.96 ± 7.83
  Final Train: 100.00 ± 0.00
   Final Test: 67.54 ± 6.73
best run test_acc: 67.54000091552734
[I 2023-06-12 00:50:56,410] Trial 49 finished with value: 66.95999908447266 and parameters: {'Fwd': 0.0001968314959267419, 'K': 9, 'alpha': 0.65, 'dropout': 0.0, 'gnnepoch': 30, 'lambda1': 0.0, 'lambda2': 8.33807577001147, 'loop': 1, 'loss': 'MSE', 'lr': 0.004066670731302219, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.0008210409775578447, 'weightedloss': True}. Best is trial 45 with value: 70.0.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.4
lr:  0.007786114051202382
weight_decay:  0.0003935221364193099
dropout:  0.5
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.1677065920084715
None Run 01:
Highest Train: 100.00
Highest Valid: 54.60
  Final Train: 100.00
   Final Test: 60.30
Split: 01, Run: 02
None time:  1.1348260000813752
None Run 02:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 63.30
Split: 01, Run: 03
None time:  0.8980507960077375
None Run 03:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 60.30
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  2.602404813049361
None Run 04:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 67.90
Split: 02, Run: 02
None time:  3.0083062949124724
None Run 05:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 70.40
Split: 02, Run: 03
None time:  2.4696310670115054
None Run 06:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 69.80
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.8528654221445322
None Run 07:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 70.00
Split: 03, Run: 02
None time:  0.8598616279195994
None Run 08:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 72.20
Split: 03, Run: 03
None time:  1.6361787349451333
None Run 09:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 69.60
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.9040570869110525
None Run 10:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 58.90
Split: 04, Run: 02
None time:  1.5244822248350829
None Run 11:
Highest Train: 100.00
Highest Valid: 60.40
  Final Train: 100.00
   Final Test: 60.40
Split: 04, Run: 03
None time:  0.9145931790117174
None Run 12:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 54.30
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.8112395110074431
None Run 13:
Highest Train: 100.00
Highest Valid: 62.40
  Final Train: 100.00
   Final Test: 59.40
Split: 05, Run: 02
None time:  2.258956354809925
None Run 14:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 58.50
Split: 05, Run: 03
None time:  1.1122932170983404
None Run 15:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 59.00
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.7766312081366777
None Run 16:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 78.90
Split: 06, Run: 02
None time:  0.8517244898248464
None Run 17:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 80.60
Split: 06, Run: 03
None time:  0.804981152061373
None Run 18:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 78.20
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.9808149018790573
None Run 19:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 68.70
Split: 07, Run: 02
None time:  0.9913396660704166
None Run 20:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 70.90
Split: 07, Run: 03
None time:  1.6716862157918513
None Run 21:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 68.10
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.696853900095448
None Run 22:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 72.90
Split: 08, Run: 02
None time:  1.274020389886573
None Run 23:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 74.20
Split: 08, Run: 03
None time:  0.960857474943623
None Run 24:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 71.60
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.709793010028079
None Run 25:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 74.40
Split: 09, Run: 02
None time:  0.8834224331658334
None Run 26:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 73.00
Split: 09, Run: 03
None time:  2.0976388540584594
None Run 27:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 73.70
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.8594948078971356
None Run 28:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 67.80
Split: 10, Run: 02
None time:  1.0566588169895113
None Run 29:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 69.20
Split: 10, Run: 03
None time:  1.435776072088629
None Run 30:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 67.30
run time now: 4.397521257400513
total time:  44.26906141778454
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 68.29 ± 6.72
  Final Train: 100.00 ± 0.00
   Final Test: 68.13 ± 6.73
best run test_acc: 69.5
[I 2023-06-12 00:51:41,297] Trial 50 finished with value: 68.29334259033203 and parameters: {'Fwd': 3.46896450238836e-05, 'K': 6, 'alpha': 0.4, 'dropout': 0.5, 'gnnepoch': 20, 'lambda1': 0.30000000000000004, 'lambda2': 8.787638909460998, 'loop': 1, 'loss': 'MSE', 'lr': 0.007786114051202382, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.0003935221364193099, 'weightedloss': True}. Best is trial 45 with value: 70.0.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.4
lr:  0.006344245142768986
weight_decay:  0.00019539757162984815
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.2003444749861956
None Run 01:
Highest Train: 100.00
Highest Valid: 60.20
  Final Train: 100.00
   Final Test: 62.20
Split: 01, Run: 02
None time:  1.3390442440286279
None Run 02:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 62.10
Split: 01, Run: 03
None time:  1.2032538480125368
None Run 03:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 62.00
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.4630437679588795
None Run 04:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 69.10
Split: 02, Run: 02
None time:  1.4435828211717308
None Run 05:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 70.30
Split: 02, Run: 03
None time:  2.2218210899736732
None Run 06:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 73.40
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1581724430434406
None Run 07:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 70.50
Split: 03, Run: 02
None time:  1.1885023890063167
None Run 08:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.40
Split: 03, Run: 03
None time:  1.8048545308411121
None Run 09:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 70.70
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.3074068590067327
None Run 10:
Highest Train: 100.00
Highest Valid: 60.20
  Final Train: 100.00
   Final Test: 59.40
Split: 04, Run: 02
None time:  1.2115443982183933
None Run 11:
Highest Train: 100.00
Highest Valid: 60.80
  Final Train: 100.00
   Final Test: 61.00
Split: 04, Run: 03
None time:  1.2534356550313532
None Run 12:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 58.00
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.4881638358347118
None Run 13:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 59.60
Split: 05, Run: 02
None time:  1.3628722680732608
None Run 14:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 57.10
Split: 05, Run: 03
None time:  1.6441444989759475
None Run 15:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 60.80
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.2540164238307625
None Run 16:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 77.60
Split: 06, Run: 02
None time:  1.1890490842051804
None Run 17:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 79.60
Split: 06, Run: 03
None time:  1.160748922964558
None Run 18:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 77.60
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.9612924489192665
None Run 19:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 75.80
Split: 07, Run: 02
None time:  2.4006780800409615
None Run 20:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 75.70
Split: 07, Run: 03
None time:  1.5300737728830427
None Run 21:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 70.10
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.5446186440531164
None Run 22:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 77.50
Split: 08, Run: 02
None time:  1.7668808680027723
None Run 23:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 77.60
Split: 08, Run: 03
None time:  1.6905985150951892
None Run 24:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 77.40
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.9827995628584176
None Run 25:
Highest Train: 100.00
Highest Valid: 81.20
  Final Train: 100.00
   Final Test: 78.60
Split: 09, Run: 02
None time:  2.3361915422137827
None Run 26:
Highest Train: 100.00
Highest Valid: 81.60
  Final Train: 100.00
   Final Test: 78.40
Split: 09, Run: 03
None time:  1.2910628039389849
None Run 27:
Highest Train: 100.00
Highest Valid: 79.20
  Final Train: 100.00
   Final Test: 77.10
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.0802235030569136
None Run 28:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 69.50
Split: 10, Run: 02
None time:  1.4260126368608326
None Run 29:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 69.50
Split: 10, Run: 03
None time:  1.401260371087119
None Run 30:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 69.00
run time now: 3.9496777057647705
total time:  47.356445606797934
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 70.09 ± 7.04
  Final Train: 100.00 ± 0.00
   Final Test: 69.95 ± 7.28
best run test_acc: 70.99000549316406
[I 2023-06-12 00:52:29,192] Trial 51 finished with value: 70.086669921875 and parameters: {'Fwd': 7.962449559966302e-05, 'K': 6, 'alpha': 0.4, 'dropout': 0.2, 'gnnepoch': 40, 'lambda1': 0.05, 'lambda2': 8.052335120872264, 'loop': 1, 'loss': 'MSE', 'lr': 0.006344245142768986, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.00019539757162984815, 'weightedloss': True}. Best is trial 51 with value: 70.086669921875.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.4
lr:  0.008207248978511833
weight_decay:  0.00025918104636071923
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.1769850281998515
None Run 01:
Highest Train: 100.00
Highest Valid: 59.80
  Final Train: 100.00
   Final Test: 61.50
Split: 01, Run: 02
None time:  1.185780046042055
None Run 02:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 61.20
Split: 01, Run: 03
None time:  1.2157256361097097
None Run 03:
Highest Train: 100.00
Highest Valid: 57.60
  Final Train: 100.00
   Final Test: 61.10
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.3264243509620428
None Run 04:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 68.90
Split: 02, Run: 02
None time:  1.2954904378857464
None Run 05:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 68.70
Split: 02, Run: 03
None time:  1.3397507851477712
None Run 06:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 69.00
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1972558258567005
None Run 07:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 70.20
Split: 03, Run: 02
None time:  1.2396428750362247
None Run 08:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 70.00
Split: 03, Run: 03
None time:  1.366785238031298
None Run 09:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 70.90
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.777826018165797
None Run 10:
Highest Train: 100.00
Highest Valid: 60.80
  Final Train: 100.00
   Final Test: 60.70
Split: 04, Run: 02
None time:  1.250005636131391
None Run 11:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 59.60
Split: 04, Run: 03
None time:  1.2072557280771434
None Run 12:
Highest Train: 100.00
Highest Valid: 57.60
  Final Train: 100.00
   Final Test: 58.40
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.3541381128598005
None Run 13:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 60.30
Split: 05, Run: 02
None time:  1.3276786948554218
None Run 14:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 59.00
Split: 05, Run: 03
None time:  1.3107177109923214
None Run 15:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 58.00
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.1613100219983608
None Run 16:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 76.00
Split: 06, Run: 02
None time:  1.4109968941193074
None Run 17:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 77.80
Split: 06, Run: 03
None time:  1.1667055869475007
None Run 18:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 77.90
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.5339821758680046
None Run 19:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 75.80
Split: 07, Run: 02
None time:  1.6237445899751037
None Run 20:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 71.40
Split: 07, Run: 03
None time:  1.7124139100778848
None Run 21:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 71.70
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.7464462870266289
None Run 22:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 76.30
Split: 08, Run: 02
None time:  1.7564445680473
None Run 23:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 74.00
Split: 08, Run: 03
None time:  1.515374795999378
None Run 24:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 76.20
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.7380675391759723
None Run 25:
Highest Train: 100.00
Highest Valid: 81.60
  Final Train: 100.00
   Final Test: 78.50
Split: 09, Run: 02
None time:  1.8787845300976187
None Run 26:
Highest Train: 100.00
Highest Valid: 81.20
  Final Train: 100.00
   Final Test: 78.70
Split: 09, Run: 03
None time:  1.9034714999143034
None Run 27:
Highest Train: 100.00
Highest Valid: 81.20
  Final Train: 100.00
   Final Test: 78.10
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.831801176071167
None Run 28:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 67.50
Split: 10, Run: 02
None time:  1.8682930180802941
None Run 29:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 68.80
Split: 10, Run: 03
None time:  2.2740518709179014
None Run 30:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 68.00
run time now: 6.016443490982056
total time:  46.743573813000694
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.19 ± 6.93
  Final Train: 100.00 ± 0.00
   Final Test: 69.14 ± 6.99
best run test_acc: 69.98999786376953
[I 2023-06-12 00:53:16,400] Trial 52 finished with value: 69.19334411621094 and parameters: {'Fwd': 8.441963856930027e-05, 'K': 6, 'alpha': 0.4, 'dropout': 0.2, 'gnnepoch': 40, 'lambda1': 0.1, 'lambda2': 7.958755183743827, 'loop': 1, 'loss': 'MSE', 'lr': 0.008207248978511833, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.00025918104636071923, 'weightedloss': True}. Best is trial 51 with value: 70.086669921875.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  0.65
lr:  0.009779510852513586
weight_decay:  7.570924894262074e-05
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.2772842049598694
None Run 01:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 61.10
Split: 01, Run: 02
None time:  3.5821326489094645
None Run 02:
Highest Train: 100.00
Highest Valid: 60.20
  Final Train: 100.00
   Final Test: 61.00
Split: 01, Run: 03
None time:  1.1934766019694507
None Run 03:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 59.50
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.3284980768803507
None Run 04:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 67.50
Split: 02, Run: 02
None time:  1.276028199121356
None Run 05:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 68.10
Split: 02, Run: 03
None time:  2.2080439149867743
None Run 06:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 70.70
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  2.709009693004191
None Run 07:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 70.60
Split: 03, Run: 02
None time:  1.1644095769152045
None Run 08:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 69.20
Split: 03, Run: 03
None time:  1.5959457699209452
None Run 09:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 70.60
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.1763718959409744
None Run 10:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 60.00
Split: 04, Run: 02
None time:  1.3128814310766757
None Run 11:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 60.50
Split: 04, Run: 03
None time:  1.0754620819352567
None Run 12:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 60.10
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.2995579210110009
None Run 13:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 58.00
Split: 05, Run: 02
None time:  1.3153157019987702
None Run 14:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 58.60
Split: 05, Run: 03
None time:  1.326326851034537
None Run 15:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 58.60
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.380355240078643
None Run 16:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 77.50
Split: 06, Run: 02
None time:  1.2442802069708705
None Run 17:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 74.70
Split: 06, Run: 03
None time:  1.1730242401827127
None Run 18:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 74.50
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.522637605899945
None Run 19:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 71.40
Split: 07, Run: 02
None time:  2.0781465431209654
None Run 20:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 75.60
Split: 07, Run: 03
None time:  1.6472571261692792
None Run 21:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 71.90
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.6568853340577334
None Run 22:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 75.30
Split: 08, Run: 02
None time:  1.5353417799342424
None Run 23:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 75.70
Split: 08, Run: 03
None time:  1.531116537982598
None Run 24:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 77.10
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.4300856699701399
None Run 25:
Highest Train: 100.00
Highest Valid: 80.80
  Final Train: 100.00
   Final Test: 79.00
Split: 09, Run: 02
None time:  2.087778002023697
None Run 26:
Highest Train: 100.00
Highest Valid: 80.80
  Final Train: 100.00
   Final Test: 77.00
Split: 09, Run: 03
None time:  1.8854119088500738
None Run 27:
Highest Train: 100.00
Highest Valid: 80.80
  Final Train: 100.00
   Final Test: 78.00
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  2.466924672946334
None Run 28:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 66.50
Split: 10, Run: 02
None time:  1.8265717499889433
None Run 29:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 66.70
Split: 10, Run: 03
None time:  1.3266399349085987
None Run 30:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 68.20
run time now: 5.734850645065308
total time:  49.82638502516784
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.15 ± 6.98
  Final Train: 100.00 ± 0.00
   Final Test: 68.77 ± 6.94
best run test_acc: 69.88999938964844
[I 2023-06-12 00:54:06,715] Trial 53 finished with value: 69.15332794189453 and parameters: {'Fwd': 5.1112969681184715e-05, 'K': 7, 'alpha': 0.65, 'dropout': 0.1, 'gnnepoch': 40, 'lambda1': 0.15000000000000002, 'lambda2': 8.260232866783554, 'loop': 1, 'loss': 'MSE', 'lr': 0.009779510852513586, 'softmaxF': True, 'useGCN': True, 'weight_decay': 7.570924894262074e-05, 'weightedloss': True}. Best is trial 51 with value: 70.086669921875.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  5
alpha:  0.30000000000000004
lr:  0.005994178545898383
weight_decay:  0.00047747044546764587
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.088829766958952
None Run 01:
Highest Train: 100.00
Highest Valid: 52.60
  Final Train: 100.00
   Final Test: 54.90
Split: 01, Run: 02
None time:  1.0533932449761778
None Run 02:
Highest Train: 100.00
Highest Valid: 52.60
  Final Train: 100.00
   Final Test: 54.90
Split: 01, Run: 03
None time:  1.0435966849327087
None Run 03:
Highest Train: 100.00
Highest Valid: 52.60
  Final Train: 100.00
   Final Test: 54.90
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.1362878889776766
None Run 04:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 69.20
Split: 02, Run: 02
None time:  1.0363281860481948
None Run 05:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 69.20
Split: 02, Run: 03
None time:  1.188794295070693
None Run 06:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 69.20
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.2060095940250903
None Run 07:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 63.10
Split: 03, Run: 02
None time:  1.2066957550123334
None Run 08:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 63.10
Split: 03, Run: 03
None time:  1.2057303208857775
None Run 09:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 63.10
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.0200159561354667
None Run 10:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 100.00
   Final Test: 58.20
Split: 04, Run: 02
None time:  1.0086648100987077
None Run 11:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 100.00
   Final Test: 58.20
Split: 04, Run: 03
None time:  0.9847510349936783
None Run 12:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 100.00
   Final Test: 58.20
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.5983960828743875
None Run 13:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.50
Split: 05, Run: 02
None time:  1.611802289960906
None Run 14:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.50
Split: 05, Run: 03
None time:  1.5884550069458783
None Run 15:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.50
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.8958167729433626
None Run 16:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 71.80
Split: 06, Run: 02
None time:  1.8682912890799344
None Run 17:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 71.80
Split: 06, Run: 03
None time:  1.850888636894524
None Run 18:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 71.80
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.6874620360322297
None Run 19:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 72.40
Split: 07, Run: 02
None time:  1.667422205908224
None Run 20:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 72.40
Split: 07, Run: 03
None time:  1.6440816409885883
None Run 21:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 72.40
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.1066707880236208
None Run 22:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 74.80
Split: 08, Run: 02
None time:  1.1258756639435887
None Run 23:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 74.80
Split: 08, Run: 03
None time:  1.155709020094946
None Run 24:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 74.80
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.239601279841736
None Run 25:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 74.40
Split: 09, Run: 02
None time:  2.260122352046892
None Run 26:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 74.40
Split: 09, Run: 03
None time:  2.2439578941557556
None Run 27:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 74.40
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.1145851879846305
None Run 28:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 65.70
Split: 10, Run: 02
None time:  1.074493400985375
None Run 29:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 65.70
Split: 10, Run: 03
None time:  0.9043680687900633
None Run 30:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 65.70
run time now: 3.141392707824707
total time:  42.88821888808161
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 67.14 ± 7.74
  Final Train: 100.00 ± 0.00
   Final Test: 67.60 ± 6.67
best run test_acc: 67.60000610351562
[I 2023-06-12 00:54:50,192] Trial 54 finished with value: 67.13999938964844 and parameters: {'Fwd': 0.00010524347392212132, 'K': 5, 'alpha': 0.30000000000000004, 'dropout': 0.2, 'gnnepoch': 30, 'lambda1': 0.0, 'lambda2': 9.333892895816547, 'loop': 1, 'loss': 'MSE', 'lr': 0.005994178545898383, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.00047747044546764587, 'weightedloss': True}. Best is trial 51 with value: 70.086669921875.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.75
lr:  0.00997377612083375
weight_decay:  0.0008797064504824632
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.2315237501170486
None Run 01:
Highest Train: 100.00
Highest Valid: 58.20
  Final Train: 100.00
   Final Test: 60.70
Split: 01, Run: 02
None time:  2.5940999321173877
None Run 02:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 62.20
Split: 01, Run: 03
None time:  1.1901957930531353
None Run 03:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 60.60
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.4152514699380845
None Run 04:
Highest Train: 100.00
Highest Valid: 67.40
  Final Train: 100.00
   Final Test: 69.50
Split: 02, Run: 02
None time:  1.3758618528954685
None Run 05:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 70.30
Split: 02, Run: 03
None time:  1.4879040969535708
None Run 06:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 69.00
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.624366028001532
None Run 07:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 70.80
Split: 03, Run: 02
None time:  1.5406634190585464
None Run 08:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 69.30
Split: 03, Run: 03
None time:  2.4212455099914223
None Run 09:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 70.80
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.8197421950753778
None Run 10:
Highest Train: 100.00
Highest Valid: 59.60
  Final Train: 100.00
   Final Test: 59.70
Split: 04, Run: 02
None time:  1.3409959950949997
None Run 11:
Highest Train: 100.00
Highest Valid: 59.20
  Final Train: 100.00
   Final Test: 61.00
Split: 04, Run: 03
None time:  1.334607896162197
None Run 12:
Highest Train: 100.00
Highest Valid: 59.60
  Final Train: 100.00
   Final Test: 60.50
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.4534335201606154
None Run 13:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 57.60
Split: 05, Run: 02
None time:  1.3821118150372058
None Run 14:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 59.80
Split: 05, Run: 03
None time:  1.4391432660631835
None Run 15:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 59.90
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.2400774520356208
None Run 16:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 74.60
Split: 06, Run: 02
None time:  1.2101633599959314
None Run 17:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 74.20
Split: 06, Run: 03
None time:  1.2924071149900556
None Run 18:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 76.20
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.1718596909195185
None Run 19:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 74.30
Split: 07, Run: 02
None time:  2.733803784940392
None Run 20:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 76.80
Split: 07, Run: 03
None time:  2.712077929172665
None Run 21:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 77.30
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.7012575389817357
None Run 22:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 73.00
Split: 08, Run: 02
None time:  1.590079888002947
None Run 23:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 73.20
Split: 08, Run: 03
None time:  1.5909558860585093
None Run 24:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 74.90
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.3527449190150946
None Run 25:
Highest Train: 100.00
Highest Valid: 81.20
  Final Train: 100.00
   Final Test: 78.40
Split: 09, Run: 02
None time:  1.7861250599380583
None Run 26:
Highest Train: 100.00
Highest Valid: 81.40
  Final Train: 100.00
   Final Test: 77.50
Split: 09, Run: 03
None time:  1.9218879828695208
None Run 27:
Highest Train: 100.00
Highest Valid: 81.40
  Final Train: 100.00
   Final Test: 76.90
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.4853480900637805
None Run 28:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 68.70
Split: 10, Run: 02
None time:  1.49873475311324
None Run 29:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 69.30
Split: 10, Run: 03
None time:  2.15490680700168
None Run 30:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 70.60
run time now: 5.1854870319366455
total time:  52.22654314292595
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.67 ± 6.78
  Final Train: 100.00 ± 0.00
   Final Test: 69.25 ± 6.63
best run test_acc: 70.15999603271484
[I 2023-06-12 00:55:42,895] Trial 55 finished with value: 69.67333221435547 and parameters: {'Fwd': 3.0139682993285223e-05, 'K': 8, 'alpha': 0.75, 'dropout': 0.0, 'gnnepoch': 40, 'lambda1': 0.05, 'lambda2': 8.065200344746946, 'loop': 1, 'loss': 'MSE', 'lr': 0.00997377612083375, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.0008797064504824632, 'weightedloss': True}. Best is trial 51 with value: 70.086669921875.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.75
lr:  0.004804093523732124
weight_decay:  0.001039619582425909
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.9459825200028718
None Run 01:
Highest Train: 100.00
Highest Valid: 61.00
  Final Train: 100.00
   Final Test: 62.60
Split: 01, Run: 02
None time:  2.020339102949947
None Run 02:
Highest Train: 100.00
Highest Valid: 62.40
  Final Train: 100.00
   Final Test: 63.70
Split: 01, Run: 03
None time:  1.492748583899811
None Run 03:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 61.40
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.1858130001928657
None Run 04:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 68.00
Split: 02, Run: 02
None time:  1.1560362458694726
None Run 05:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 68.00
Split: 02, Run: 03
None time:  1.1741205051075667
None Run 06:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 68.00
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.4202502188272774
None Run 07:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 70.70
Split: 03, Run: 02
None time:  1.361097144894302
None Run 08:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.10
Split: 03, Run: 03
None time:  1.4173689261078835
None Run 09:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 72.30
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.2296570360194892
None Run 10:
Highest Train: 100.00
Highest Valid: 57.40
  Final Train: 100.00
   Final Test: 56.90
Split: 04, Run: 02
None time:  1.3150669501628727
None Run 11:
Highest Train: 100.00
Highest Valid: 58.00
  Final Train: 100.00
   Final Test: 56.30
Split: 04, Run: 03
None time:  1.2258701990358531
None Run 12:
Highest Train: 100.00
Highest Valid: 58.00
  Final Train: 100.00
   Final Test: 57.30
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.4588940320536494
None Run 13:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 59.90
Split: 05, Run: 02
None time:  1.5262500878889114
None Run 14:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 57.50
Split: 05, Run: 03
None time:  1.4628474940545857
None Run 15:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 57.90
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.4078479688614607
None Run 16:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 78.50
Split: 06, Run: 02
None time:  1.3861900949850678
None Run 17:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 78.60
Split: 06, Run: 03
None time:  1.4910261479672045
None Run 18:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 77.20
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.582855035085231
None Run 19:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 69.50
Split: 07, Run: 02
None time:  1.6289715229067951
None Run 20:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 69.10
Split: 07, Run: 03
None time:  1.7087709528859705
None Run 21:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 69.40
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.225563761079684
None Run 22:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 73.00
Split: 08, Run: 02
None time:  1.1753663641866297
None Run 23:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 73.00
Split: 08, Run: 03
None time:  1.2002827199175954
None Run 24:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 73.00
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.5314476119820029
None Run 25:
Highest Train: 100.00
Highest Valid: 80.60
  Final Train: 100.00
   Final Test: 78.20
Split: 09, Run: 02
None time:  1.7380867179017514
None Run 26:
Highest Train: 100.00
Highest Valid: 78.80
  Final Train: 100.00
   Final Test: 76.80
Split: 09, Run: 03
None time:  1.5476594539359212
None Run 27:
Highest Train: 100.00
Highest Valid: 79.60
  Final Train: 100.00
   Final Test: 77.10
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.3378095771186054
None Run 28:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 66.70
Split: 10, Run: 02
None time:  1.2222308870404959
None Run 29:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 67.00
Split: 10, Run: 03
None time:  1.3765150860417634
None Run 30:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 66.50
run time now: 3.983757257461548
total time:  44.05543650011532
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 68.17 ± 6.52
  Final Train: 100.00 ± 0.00
   Final Test: 68.17 ± 7.03
best run test_acc: 68.75
[I 2023-06-12 00:56:27,410] Trial 56 finished with value: 68.16666412353516 and parameters: {'Fwd': 2.8200782113150666e-05, 'K': 8, 'alpha': 0.75, 'dropout': 0.0, 'gnnepoch': 40, 'lambda1': 0.2, 'lambda2': 8.732938993039761, 'loop': 1, 'loss': 'MSE', 'lr': 0.004804093523732124, 'softmaxF': False, 'useGCN': True, 'weight_decay': 0.001039619582425909, 'weightedloss': True}. Best is trial 51 with value: 70.086669921875.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.8
lr:  0.007823208227449517
weight_decay:  0.0017552579010108723
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.9361433407757431
None Run 01:
Highest Train: 100.00
Highest Valid: 54.40
  Final Train: 100.00
   Final Test: 56.80
Split: 01, Run: 02
None time:  1.1824078110512346
None Run 02:
Highest Train: 100.00
Highest Valid: 53.80
  Final Train: 100.00
   Final Test: 56.50
Split: 01, Run: 03
None time:  1.1412217649631202
None Run 03:
Highest Train: 100.00
Highest Valid: 52.00
  Final Train: 100.00
   Final Test: 51.70
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.8148357840254903
None Run 04:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 66.80
Split: 02, Run: 02
None time:  0.8372738359030336
None Run 05:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 66.80
Split: 02, Run: 03
None time:  0.8352965351659805
None Run 06:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 66.80
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.8873323029838502
None Run 07:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 70.80
Split: 03, Run: 02
None time:  0.8374753559473902
None Run 08:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 69.40
Split: 03, Run: 03
None time:  0.9693515049293637
None Run 09:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 70.50
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.8402412179857492
None Run 10:
Highest Train: 100.00
Highest Valid: 56.20
  Final Train: 100.00
   Final Test: 58.60
Split: 04, Run: 02
None time:  0.8034879670012742
None Run 11:
Highest Train: 100.00
Highest Valid: 56.20
  Final Train: 100.00
   Final Test: 58.60
Split: 04, Run: 03
None time:  1.0903008859604597
None Run 12:
Highest Train: 100.00
Highest Valid: 56.80
  Final Train: 100.00
   Final Test: 57.20
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.8156095549929887
None Run 13:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 59.50
Split: 05, Run: 02
None time:  0.8333210370037705
None Run 14:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 59.50
Split: 05, Run: 03
None time:  0.5896629521157593
None Run 15:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 59.50
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.9624953381717205
None Run 16:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 76.40
Split: 06, Run: 02
None time:  1.1596414148807526
None Run 17:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 79.10
Split: 06, Run: 03
None time:  0.9464424978941679
None Run 18:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 73.10
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.7871651530731469
None Run 19:
Highest Train: 100.00
Highest Valid: 67.40
  Final Train: 100.00
   Final Test: 69.30
Split: 07, Run: 02
None time:  0.9628729410469532
None Run 20:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 69.40
Split: 07, Run: 03
None time:  1.116924243979156
None Run 21:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 69.40
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.77340820687823
None Run 22:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 72.40
Split: 08, Run: 02
None time:  0.895345221972093
None Run 23:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 69.50
Split: 08, Run: 03
None time:  0.822937497869134
None Run 24:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.10
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.0122180180624127
None Run 25:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 75.10
Split: 09, Run: 02
None time:  0.8953170150052756
None Run 26:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 72.90
Split: 09, Run: 03
None time:  0.9597019848879427
None Run 27:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 74.70
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.908972280099988
None Run 28:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 66.40
Split: 10, Run: 02
None time:  1.2347319331020117
None Run 29:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 65.80
Split: 10, Run: 03
None time:  1.063222581986338
None Run 30:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 66.60
run time now: 3.2516427040100098
total time:  29.07283669593744
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 66.72 ± 7.45
  Final Train: 100.00 ± 0.00
   Final Test: 66.67 ± 6.91
best run test_acc: 67.50999450683594
[I 2023-06-12 00:56:56,916] Trial 57 finished with value: 66.72000122070312 and parameters: {'Fwd': 3.6965428721934936e-05, 'K': 8, 'alpha': 0.8, 'dropout': 0.0, 'gnnepoch': 20, 'lambda1': 0.7000000000000001, 'lambda2': 8.063157369116006, 'loop': 1, 'loss': 'MSE', 'lr': 0.007823208227449517, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.0017552579010108723, 'weightedloss': False}. Best is trial 51 with value: 70.086669921875.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  9
alpha:  0.8500000000000001
lr:  0.004328714043410371
weight_decay:  0.0028339695063709434
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.9997748478781432
None Run 01:
Highest Train: 100.00
Highest Valid: 53.20
  Final Train: 100.00
   Final Test: 56.60
Split: 01, Run: 02
None time:  1.041677069850266
None Run 02:
Highest Train: 100.00
Highest Valid: 50.60
  Final Train: 100.00
   Final Test: 52.50
Split: 01, Run: 03
None time:  0.9535487599205226
None Run 03:
Highest Train: 100.00
Highest Valid: 50.40
  Final Train: 100.00
   Final Test: 53.00
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.9943851979915053
None Run 04:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 68.50
Split: 02, Run: 02
None time:  3.3338592059444636
None Run 05:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 68.50
Split: 02, Run: 03
None time:  4.026328986044973
None Run 06:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 70.00
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1402298619505018
None Run 07:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 70.50
Split: 03, Run: 02
None time:  1.1178144640289247
None Run 08:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 71.00
Split: 03, Run: 03
None time:  1.007262164959684
None Run 09:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 70.00
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.1072871030773968
None Run 10:
Highest Train: 100.00
Highest Valid: 57.60
  Final Train: 100.00
   Final Test: 56.50
Split: 04, Run: 02
None time:  0.9403825509361923
None Run 11:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 100.00
   Final Test: 58.40
Split: 04, Run: 03
None time:  0.9992071348242462
None Run 12:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 100.00
   Final Test: 58.40
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.8465750010218471
None Run 13:
Highest Train: 100.00
Highest Valid: 62.40
  Final Train: 100.00
   Final Test: 60.50
Split: 05, Run: 02
None time:  1.0318323189858347
None Run 14:
Highest Train: 100.00
Highest Valid: 62.40
  Final Train: 100.00
   Final Test: 60.50
Split: 05, Run: 03
None time:  1.224650545977056
None Run 15:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 58.30
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.0748546798713505
None Run 16:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 79.50
Split: 06, Run: 02
None time:  1.5895571080036461
None Run 17:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 77.60
Split: 06, Run: 03
None time:  1.2219238982070237
None Run 18:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 79.50
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.6751941139809787
None Run 19:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 69.30
Split: 07, Run: 02
None time:  1.30639405711554
None Run 20:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 68.00
Split: 07, Run: 03
None time:  1.8557035981211811
None Run 21:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 69.50
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.195633424213156
None Run 22:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 72.80
Split: 08, Run: 02
None time:  1.5840413798578084
None Run 23:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 75.00
Split: 08, Run: 03
None time:  1.6598632831592113
None Run 24:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 74.30
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  3.076073323842138
None Run 25:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 75.20
Split: 09, Run: 02
None time:  1.1759381128940731
None Run 26:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 75.20
Split: 09, Run: 03
None time:  1.3153781108558178
None Run 27:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 75.10
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.5868172328919172
None Run 28:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 69.00
Split: 10, Run: 02
None time:  2.847154746996239
None Run 29:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 69.30
Split: 10, Run: 03
None time:  1.6375833549536765
None Run 30:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 69.00
run time now: 6.119731187820435
total time:  46.73106854315847
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 67.62 ± 8.10
  Final Train: 100.00 ± 0.00
   Final Test: 67.72 ± 7.81
best run test_acc: 68.5
[I 2023-06-12 00:57:44,175] Trial 58 finished with value: 67.62000274658203 and parameters: {'Fwd': 7.228821651440555e-05, 'K': 9, 'alpha': 0.8500000000000001, 'dropout': 0.1, 'gnnepoch': 30, 'lambda1': 0.1, 'lambda2': 9.592404258331271, 'loop': 1, 'loss': 'MSE', 'lr': 0.004328714043410371, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.0028339695063709434, 'weightedloss': True}. Best is trial 51 with value: 70.086669921875.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  10
alpha:  0.9
lr:  0.006447209355093573
weight_decay:  0.00038269781269112445
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.7472692059818655
None Run 01:
Highest Train: 100.00
Highest Valid: 52.40
  Final Train: 100.00
   Final Test: 55.00
Split: 01, Run: 02
None time:  0.7962237079627812
None Run 02:
Highest Train: 100.00
Highest Valid: 52.40
  Final Train: 100.00
   Final Test: 55.00
Split: 01, Run: 03
None time:  0.7716683929320425
None Run 03:
Highest Train: 100.00
Highest Valid: 52.40
  Final Train: 100.00
   Final Test: 55.00
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.7849924662150443
None Run 04:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 69.20
Split: 02, Run: 02
None time:  0.8069897009991109
None Run 05:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 69.20
Split: 02, Run: 03
None time:  0.7966105579398572
None Run 06:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 69.20
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.8404163930099458
None Run 07:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 63.20
Split: 03, Run: 02
None time:  0.8452672341372818
None Run 08:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 63.20
Split: 03, Run: 03
None time:  0.8050024409312755
None Run 09:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 63.20
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.7395248541142792
None Run 10:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 100.00
   Final Test: 58.20
Split: 04, Run: 02
None time:  0.7189862239174545
None Run 11:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 100.00
   Final Test: 58.20
Split: 04, Run: 03
None time:  0.5624650290701538
None Run 12:
Highest Train: 100.00
Highest Valid: 57.00
  Final Train: 100.00
   Final Test: 58.20
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.0177652498241514
None Run 13:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.50
Split: 05, Run: 02
None time:  1.0532432540785521
None Run 14:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.50
Split: 05, Run: 03
None time:  1.081798265920952
None Run 15:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.50
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.2281446089036763
None Run 16:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 71.80
Split: 06, Run: 02
None time:  1.2446286207996309
None Run 17:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 71.80
Split: 06, Run: 03
None time:  1.226009197998792
None Run 18:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 71.80
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.901334221009165
None Run 19:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 72.40
Split: 07, Run: 02
None time:  0.8918051621876657
None Run 20:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 72.40
Split: 07, Run: 03
None time:  0.904098795959726
None Run 21:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 72.40
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.7710072949994355
None Run 22:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 74.70
Split: 08, Run: 02
None time:  0.7458687599282712
None Run 23:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 74.70
Split: 08, Run: 03
None time:  0.7764282168354839
None Run 24:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 74.70
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.4099463901948184
None Run 25:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 74.40
Split: 09, Run: 02
None time:  1.450145659968257
None Run 26:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 74.40
Split: 09, Run: 03
None time:  1.4385562620591372
None Run 27:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 74.40
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.7512742439284921
None Run 28:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 65.70
Split: 10, Run: 02
None time:  0.756794597953558
None Run 29:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 65.70
Split: 10, Run: 03
None time:  0.798149965936318
None Run 30:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 65.70
run time now: 2.3602664470672607
total time:  29.097739432007074
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 67.00 ± 7.76
  Final Train: 100.00 ± 0.00
   Final Test: 67.61 ± 6.63
best run test_acc: 67.61000061035156
[I 2023-06-12 00:58:13,799] Trial 59 finished with value: 67.0 and parameters: {'Fwd': 0.00029557384539679015, 'K': 10, 'alpha': 0.9, 'dropout': 0.1, 'gnnepoch': 10, 'lambda1': 0.0, 'lambda2': 8.799935285154621, 'loop': 1, 'loss': 'MSE', 'lr': 0.006447209355093573, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.00038269781269112445, 'weightedloss': True}. Best is trial 51 with value: 70.086669921875.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.75
lr:  0.005320663678581649
weight_decay:  0.000783397224688984
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.3502115209121257
None Run 01:
Highest Train: 100.00
Highest Valid: 61.60
  Final Train: 100.00
   Final Test: 63.70
Split: 01, Run: 02
None time:  1.750423151999712
None Run 02:
Highest Train: 100.00
Highest Valid: 61.60
  Final Train: 100.00
   Final Test: 63.60
Split: 01, Run: 03
None time:  1.8423904429655522
None Run 03:
Highest Train: 100.00
Highest Valid: 60.40
  Final Train: 100.00
   Final Test: 62.40
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.1456827658694237
None Run 04:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 67.90
Split: 02, Run: 02
None time:  1.166005577892065
None Run 05:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 67.90
Split: 02, Run: 03
None time:  1.7267012419179082
None Run 06:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 66.30
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.440592847066
None Run 07:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 70.70
Split: 03, Run: 02
None time:  1.2519839850720018
None Run 08:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 71.30
Split: 03, Run: 03
None time:  1.5673306819517165
None Run 09:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 72.20
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.1770044518634677
None Run 10:
Highest Train: 100.00
Highest Valid: 57.40
  Final Train: 100.00
   Final Test: 57.50
Split: 04, Run: 02
None time:  1.2861051950603724
None Run 11:
Highest Train: 100.00
Highest Valid: 57.60
  Final Train: 100.00
   Final Test: 57.50
Split: 04, Run: 03
None time:  1.3386122910305858
None Run 12:
Highest Train: 100.00
Highest Valid: 58.00
  Final Train: 100.00
   Final Test: 58.10
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.3469935220200568
None Run 13:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 57.80
Split: 05, Run: 02
None time:  1.1652460959739983
None Run 14:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 59.10
Split: 05, Run: 03
None time:  1.3955183441285044
None Run 15:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 57.50
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.1820332689676434
None Run 16:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 79.00
Split: 06, Run: 02
None time:  1.2363739639986306
None Run 17:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 78.30
Split: 06, Run: 03
None time:  1.2689165759366006
None Run 18:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 77.90
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.447365262079984
None Run 19:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 68.70
Split: 07, Run: 02
None time:  1.6260980661027133
None Run 20:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 70.20
Split: 07, Run: 03
None time:  1.6719632840249687
None Run 21:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 70.30
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.1302122951019555
None Run 22:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 73.10
Split: 08, Run: 02
None time:  1.20042256382294
None Run 23:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 73.10
Split: 08, Run: 03
None time:  1.1788404048420489
None Run 24:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 73.10
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.4536819539498538
None Run 25:
Highest Train: 100.00
Highest Valid: 81.20
  Final Train: 100.00
   Final Test: 78.90
Split: 09, Run: 02
None time:  1.5178946929518133
None Run 26:
Highest Train: 100.00
Highest Valid: 80.20
  Final Train: 100.00
   Final Test: 78.20
Split: 09, Run: 03
None time:  1.6589402831159532
None Run 27:
Highest Train: 100.00
Highest Valid: 81.00
  Final Train: 100.00
   Final Test: 78.00
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.995881169103086
None Run 28:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 66.60
Split: 10, Run: 02
None time:  1.258213265100494
None Run 29:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 66.50
Split: 10, Run: 03
None time:  1.2319038580171764
None Run 30:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 67.40
run time now: 3.531928777694702
total time:  43.092177608050406
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 68.39 ± 6.60
  Final Train: 100.00 ± 0.00
   Final Test: 68.43 ± 7.08
best run test_acc: 68.9699935913086
[I 2023-06-12 00:58:57,479] Trial 60 finished with value: 68.3933334350586 and parameters: {'Fwd': 5.18712515228169e-05, 'K': 8, 'alpha': 0.75, 'dropout': 0.0, 'gnnepoch': 40, 'lambda1': 0.15000000000000002, 'lambda2': 9.050529164742612, 'loop': 1, 'loss': 'MSE', 'lr': 0.005320663678581649, 'softmaxF': False, 'useGCN': True, 'weight_decay': 0.000783397224688984, 'weightedloss': True}. Best is trial 51 with value: 70.086669921875.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  0.55
lr:  0.008343333070087274
weight_decay:  0.00023075025770401573
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.3472817381843925
None Run 01:
Highest Train: 100.00
Highest Valid: 58.20
  Final Train: 100.00
   Final Test: 60.70
Split: 01, Run: 02
None time:  1.3393227790948004
None Run 02:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 59.80
Split: 01, Run: 03
None time:  1.3969034610781819
None Run 03:
Highest Train: 100.00
Highest Valid: 58.20
  Final Train: 100.00
   Final Test: 60.90
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.478497530799359
None Run 04:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 68.50
Split: 02, Run: 02
None time:  1.4568702310789376
None Run 05:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 69.00
Split: 02, Run: 03
None time:  1.5796388168819249
None Run 06:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 69.50
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.3451228442136198
None Run 07:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 69.90
Split: 03, Run: 02
None time:  1.353584260912612
None Run 08:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 69.40
Split: 03, Run: 03
None time:  1.8746865291614085
None Run 09:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 69.90
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.3872685541864485
None Run 10:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 59.70
Split: 04, Run: 02
None time:  1.3629901427775621
None Run 11:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 59.80
Split: 04, Run: 03
None time:  1.4300107399467379
None Run 12:
Highest Train: 100.00
Highest Valid: 60.40
  Final Train: 100.00
   Final Test: 60.70
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.4688515381421894
None Run 13:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 57.30
Split: 05, Run: 02
None time:  1.5398130579851568
None Run 14:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 57.40
Split: 05, Run: 03
None time:  1.4996372789610177
None Run 15:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 58.10
len(train) 15
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.5160169519949704
None Run 16:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 75.00
Split: 06, Run: 02
None time:  1.267353736096993
None Run 17:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 75.80
Split: 06, Run: 03
None time:  1.4968405379913747
None Run 18:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 75.90
len(train) 15
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.568176146131009
None Run 19:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 76.00
Split: 07, Run: 02
None time:  1.8992140640038997
None Run 20:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 73.80
Split: 07, Run: 03
None time:  1.9205554849468172
None Run 21:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 73.40
len(train) 15
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.7505497350357473
None Run 22:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 100.00
   Final Test: 78.40
Split: 08, Run: 02
None time:  1.5808648210950196
None Run 23:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 76.40
Split: 08, Run: 03
None time:  1.270720450906083
None Run 24:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 72.70
len(train) 15
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.4684993920382112
None Run 25:
Highest Train: 100.00
Highest Valid: 80.80
  Final Train: 100.00
   Final Test: 78.50
Split: 09, Run: 02
None time:  1.3557639338541776
None Run 26:
Highest Train: 100.00
Highest Valid: 81.40
  Final Train: 100.00
   Final Test: 78.70
Split: 09, Run: 03
None time:  1.3261900919023901
None Run 27:
Highest Train: 100.00
Highest Valid: 79.60
  Final Train: 100.00
   Final Test: 77.70
len(train) 15
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.559895080048591
None Run 28:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 69.30
Split: 10, Run: 02
None time:  1.5760607910342515
None Run 29:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 68.80
Split: 10, Run: 03
None time:  1.5220495918765664
None Run 30:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 69.20
run time now: 4.702193260192871
total time:  47.091479652095586
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.23 ± 6.87
  Final Train: 100.00 ± 0.00
   Final Test: 69.01 ± 7.17
best run test_acc: 69.74000549316406
[I 2023-06-12 00:59:44,967] Trial 61 finished with value: 69.23332977294922 and parameters: {'Fwd': 0.00018802808628790816, 'K': 7, 'alpha': 0.55, 'dropout': 0.2, 'gnnepoch': 50, 'lambda1': 0.05, 'lambda2': 6.956517360067938, 'loop': 1, 'loss': 'MSE', 'lr': 0.008343333070087274, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.00023075025770401573, 'weightedloss': True}. Best is trial 51 with value: 70.086669921875.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  4
alpha:  0.45
lr:  0.00968074427540303
weight_decay:  0.00014912304396275217
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 15
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.7482329730410129
None Run 01:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 61.10
Split: 01, Run: 02
None time:  2.1397570359986275
None Run 02:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 62.30
Split: 01, Run: 03
None time:  1.5831415550783277
None Run 03:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 60.70
len(train) 15
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.6723988640587777
None Run 04:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 68.60
Split: 02, Run: 02
None time:  1.751295420108363
None Run 05:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 69.00
Split: 02, Run: 03
None time:  1.616520811105147
None Run 06:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 68.80
len(train) 15
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.784112281166017
None Run 07:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 69.60
Split: 03, Run: 02
None time:  2.0839233321603388
None Run 08:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 69.40
Split: 03, Run: 03
None time:  1.9069465699139982
None Run 09:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 70.50
len(train) 15
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.631338263861835
None Run 10:
Highest Train: 100.00
Highest Valid: 59.80
  Final Train: 100.00
   Final Test: 60.50
Split: 04, Run: 02
None time:  1.6087208818644285
None Run 11:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 59.80
Split: 04, Run: 03
None time:  1.6068846341222525
None Run 12:
Highest Train: 100.00
Highest Valid: 61.20
  Final Train: 100.00
   Final Test: 60.00
len(train) 15
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(15, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.7264031460508704
None Run 13:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 57.60
