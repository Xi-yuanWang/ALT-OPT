[I 2023-06-12 00:12:20,507] A new study created in RDB with name: PubMed_ALTOPT
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.7000000000000001
lr:  0.00044052289625298805
weight_decay:  9.58561216782688e-05
dropout:  0.6000000000000001
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.5603195079602301
None Run 01:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 66.80
Split: 01, Run: 02
None time:  0.5841206419281662
None Run 02:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 66.80
Split: 01, Run: 03
None time:  0.5801695010159165
None Run 03:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 66.80
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.6072933059185743
None Run 04:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 71.40
Split: 02, Run: 02
None time:  0.5919150761328638
None Run 05:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 71.40
Split: 02, Run: 03
None time:  0.5872133169323206
None Run 06:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 71.40
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.7356626710388809
None Run 07:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 61.00
Split: 03, Run: 02
None time:  0.5782774530816823
None Run 08:
Highest Train: 100.00
Highest Valid: 53.40
  Final Train: 100.00
   Final Test: 56.30
Split: 03, Run: 03
None time:  0.5926579900551587
None Run 09:
Highest Train: 100.00
Highest Valid: 53.40
  Final Train: 100.00
   Final Test: 56.30
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.5745148120913655
None Run 10:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 63.70
Split: 04, Run: 02
None time:  0.586411114083603
None Run 11:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 63.70
Split: 04, Run: 03
None time:  0.5938911840785295
None Run 12:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 63.70
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.6017452289815992
None Run 13:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 66.60
Split: 05, Run: 02
None time:  0.5628712601028383
None Run 14:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 66.60
Split: 05, Run: 03
None time:  0.5729653430171311
None Run 15:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 66.60
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.6056779541540891
None Run 16:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 66.30
Split: 06, Run: 02
None time:  0.581627462990582
None Run 17:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 66.30
Split: 06, Run: 03
None time:  0.5699259918183088
None Run 18:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 66.30
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.5875230389647186
None Run 19:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 66.30
Split: 07, Run: 02
None time:  0.608645856147632
None Run 20:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 66.30
Split: 07, Run: 03
None time:  0.5850553929340094
None Run 21:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 66.30
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.41833794000558555
None Run 22:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 72.30
Split: 08, Run: 02
None time:  0.5188003771472722
None Run 23:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 72.30
Split: 08, Run: 03
None time:  0.6083353569265455
None Run 24:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 72.30
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  0.5858265978749841
None Run 25:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 72.70
Split: 09, Run: 02
None time:  0.5672058709897101
None Run 26:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 72.70
Split: 09, Run: 03
None time:  0.6004718670155853
None Run 27:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 72.70
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.5810311678797007
None Run 28:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 63.50
Split: 10, Run: 02
None time:  0.5813611031044275
None Run 29:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 63.50
Split: 10, Run: 03
None time:  0.5831663080025464
None Run 30:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 63.50
run time now: 1.7894587516784668
total time:  21.96035808790475
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 66.86 ± 5.47
  Final Train: 100.00 ± 0.00
   Final Test: 66.75 ± 4.46
best run test_acc: 67.05999755859375
[I 2023-06-12 00:12:43,179] Trial 0 finished with value: 66.8600082397461 and parameters: {'Fwd': 0.08369313768038755, 'K': 8, 'alpha': 0.7000000000000001, 'dropout': 0.6000000000000001, 'gnnepoch': 0, 'lambda1': 0.2, 'lambda2': 5.916567451378895, 'loop': 2, 'loss': 'CE', 'lr': 0.00044052289625298805, 'softmaxF': False, 'useGCN': True, 'weight_decay': 9.58561216782688e-05, 'weightedloss': True}. Best is trial 0 with value: 66.8600082397461.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  5
alpha:  0.9500000000000001
lr:  0.0029813075040040038
weight_decay:  1.10400638992835e-06
dropout:  0.5
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.4869724749587476
None Run 01:
Highest Train: 100.00
Highest Valid: 59.60
  Final Train: 100.00
   Final Test: 57.50
Split: 01, Run: 02
None time:  1.4138804820831865
None Run 02:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 74.70
Split: 01, Run: 03
None time:  1.5214047599583864
None Run 03:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 78.00
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.3597640949301422
None Run 04:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 69.60
Split: 02, Run: 02
None time:  1.417690954869613
None Run 05:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 70.00
Split: 02, Run: 03
None time:  1.4342625718563795
None Run 06:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 69.60
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.7579283230006695
None Run 07:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 71.30
Split: 03, Run: 02
None time:  1.3679547219071537
None Run 08:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 71.00
Split: 03, Run: 03
None time:  1.3433851839508861
None Run 09:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 70.80
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.3087392188608646
None Run 10:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 65.30
Split: 04, Run: 02
None time:  1.828844445059076
None Run 11:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 73.33
   Final Test: 64.30
Split: 04, Run: 03
None time:  2.2455063990782946
None Run 12:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 73.33
   Final Test: 64.00
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.326563737122342
None Run 13:
Highest Train: 100.00
Highest Valid: 57.80
  Final Train: 100.00
   Final Test: 61.10
Split: 05, Run: 02
None time:  1.3820744869299233
None Run 14:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 76.70
Split: 05, Run: 03
None time:  1.4787632108200341
None Run 15:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 90.00
   Final Test: 75.60
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.7820374418515712
None Run 16:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 80.00
   Final Test: 68.80
Split: 06, Run: 02
None time:  1.631123409839347
None Run 17:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 73.33
   Final Test: 68.60
Split: 06, Run: 03
None time:  1.6801521109882742
None Run 18:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 73.33
   Final Test: 68.50
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.3822028231807053
None Run 19:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 71.90
Split: 07, Run: 02
None time:  1.2892266439739615
None Run 20:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 72.30
Split: 07, Run: 03
None time:  1.4057304440066218
None Run 21:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 73.10
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.2965245000086725
None Run 22:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 70.20
Split: 08, Run: 02
None time:  1.4930343520827591
None Run 23:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 96.67
   Final Test: 77.60
Split: 08, Run: 03
None time:  1.260919775115326
None Run 24:
Highest Train: 100.00
Highest Valid: 79.80
  Final Train: 100.00
   Final Test: 78.30
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.3799819939304143
None Run 25:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 71.30
Split: 09, Run: 02
None time:  1.3242194328922778
None Run 26:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 77.60
Split: 09, Run: 03
None time:  1.2918728610966355
None Run 27:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 77.90
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.3944360280875117
None Run 28:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 65.80
Split: 10, Run: 02
None time:  1.3467999240383506
None Run 29:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 62.70
Split: 10, Run: 03
None time:  1.3009364190511405
None Run 30:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 96.67
   Final Test: 62.10
run time now: 4.082170486450195
total time:  44.97051514801569
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 71.88 ± 5.08
  Final Train: 95.22 ± 9.62
   Final Test: 70.21 ± 5.56
best run test_acc: 72.5199966430664
[I 2023-06-12 00:13:28,508] Trial 1 finished with value: 71.87999725341797 and parameters: {'Fwd': 0.043547950884206175, 'K': 5, 'alpha': 0.9500000000000001, 'dropout': 0.5, 'gnnepoch': 120, 'lambda1': 0.55, 'lambda2': 8.528882437409388, 'loop': 2, 'loss': 'CE', 'lr': 0.0029813075040040038, 'softmaxF': False, 'useGCN': False, 'weight_decay': 1.10400638992835e-06, 'weightedloss': False}. Best is trial 1 with value: 71.87999725341797.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  9
alpha:  0.1
lr:  0.00026521962469127594
weight_decay:  8.771149308828972e-05
dropout:  0.4
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.1090391660109162
None Run 01:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 67.20
Split: 01, Run: 02
None time:  2.197821534005925
None Run 02:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 67.20
Split: 01, Run: 03
None time:  2.1125878118909895
None Run 03:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 67.20
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  2.138138054171577
None Run 04:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 02
None time:  2.084381341934204
None Run 05:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 03
None time:  2.102985081030056
None Run 06:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 71.20
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  2.136738399975002
None Run 07:
Highest Train: 100.00
Highest Valid: 59.80
  Final Train: 100.00
   Final Test: 61.30
Split: 03, Run: 02
None time:  2.1239603629801422
None Run 08:
Highest Train: 100.00
Highest Valid: 62.20
  Final Train: 100.00
   Final Test: 66.40
Split: 03, Run: 03
None time:  2.1586528720799834
None Run 09:
Highest Train: 100.00
Highest Valid: 53.80
  Final Train: 100.00
   Final Test: 57.20
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  2.165174463065341
None Run 10:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 63.80
Split: 04, Run: 02
None time:  2.010440543992445
None Run 11:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 63.80
Split: 04, Run: 03
None time:  2.1995107689872384
None Run 12:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 65.70
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  2.10352303693071
None Run 13:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 67.00
Split: 05, Run: 02
None time:  2.128036685055122
None Run 14:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 67.00
Split: 05, Run: 03
None time:  2.1189202319364995
None Run 15:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 67.00
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  2.1911884280852973
None Run 16:
Highest Train: 100.00
Highest Valid: 82.40
  Final Train: 100.00
   Final Test: 76.20
Split: 06, Run: 02
None time:  2.185390097089112
None Run 17:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 66.80
Split: 06, Run: 03
None time:  2.145417866995558
None Run 18:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 66.80
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.387757638003677
None Run 19:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 69.60
Split: 07, Run: 02
None time:  2.1572494849096984
None Run 20:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 67.00
Split: 07, Run: 03
None time:  2.3482609130442142
None Run 21:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 69.60
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  2.1203171329107136
None Run 22:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 72.50
Split: 08, Run: 02
None time:  2.115615268005058
None Run 23:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 72.50
Split: 08, Run: 03
None time:  2.100343206897378
None Run 24:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 72.50
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.190005165990442
None Run 25:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 73.60
Split: 09, Run: 02
None time:  2.2086494581308216
None Run 26:
Highest Train: 100.00
Highest Valid: 79.40
  Final Train: 100.00
   Final Test: 75.40
Split: 09, Run: 03
None time:  2.176111998036504
None Run 27:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 74.60
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.1)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  2.1775932491291314
None Run 28:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 66.90
Split: 10, Run: 02
None time:  2.1173548300284892
None Run 29:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 64.00
Split: 10, Run: 03
None time:  2.1335367620922625
None Run 30:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 66.50
run time now: 6.475990295410156
total time:  65.72563693509437
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 68.89 ± 6.00
  Final Train: 100.00 ± 0.00
   Final Test: 68.30 ± 4.25
best run test_acc: 69.80999755859375
[I 2023-06-12 00:14:34,587] Trial 2 finished with value: 68.88667297363281 and parameters: {'Fwd': 3.839848947666117e-06, 'K': 9, 'alpha': 0.1, 'dropout': 0.4, 'gnnepoch': 110, 'lambda1': 1.0, 'lambda2': 5.709037535833483, 'loop': 0, 'loss': 'CE', 'lr': 0.00026521962469127594, 'softmaxF': False, 'useGCN': True, 'weight_decay': 8.771149308828972e-05, 'weightedloss': False}. Best is trial 1 with value: 71.87999725341797.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  1
alpha:  0.35000000000000003
lr:  0.0002942401252756048
weight_decay:  0.0006835199063538708
dropout:  0.7000000000000001
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01, Epoch: 100, Loss: 1.0366, Train: 100.00%, Valid: 71.20% Test: 72.80%
Split: 01, Run: 01
None time:  3.428445207886398
None Run 01:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 72.80
Split: 01, Run: 02, Epoch: 100, Loss: 1.0363, Train: 100.00%, Valid: 71.20% Test: 72.80%
Split: 01, Run: 02
None time:  3.165961357066408
None Run 02:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 72.80
Split: 01, Run: 03, Epoch: 100, Loss: 1.0329, Train: 100.00%, Valid: 71.20% Test: 72.80%
Split: 01, Run: 03
None time:  3.3060450959019363
None Run 03:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 72.80
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.4035426729824394
None Run 04:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 72.40
Split: 02, Run: 02
None time:  1.4082919608335942
None Run 05:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 72.40
Split: 02, Run: 03
None time:  1.379927040077746
None Run 06:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 72.40
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.212124444078654
None Run 07:
Highest Train: 100.00
Highest Valid: 56.00
  Final Train: 100.00
   Final Test: 56.60
Split: 03, Run: 02
None time:  1.273954652948305
None Run 08:
Highest Train: 100.00
Highest Valid: 56.00
  Final Train: 100.00
   Final Test: 56.60
Split: 03, Run: 03
None time:  1.2228156309574842
None Run 09:
Highest Train: 100.00
Highest Valid: 56.00
  Final Train: 100.00
   Final Test: 56.60
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.84115548315458
None Run 10:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 63.70
Split: 04, Run: 02
None time:  0.8552769119851291
None Run 11:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 63.70
Split: 04, Run: 03
None time:  0.8380715949460864
None Run 12:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 63.70
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  2.9552186361979693
None Run 13:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 72.40
Split: 05, Run: 02
None time:  2.8795310319401324
None Run 14:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 72.40
Split: 05, Run: 03
None time:  2.971125739160925
None Run 15:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 72.40
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.7652918668463826
None Run 16:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 70.50
Split: 06, Run: 02
None time:  1.7658173891250044
None Run 17:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 70.50
Split: 06, Run: 03
None time:  1.5532637580763549
None Run 18:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 70.50
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.1593610618729144
None Run 19:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 70.90
Split: 07, Run: 02
None time:  2.114418095909059
None Run 20:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 70.90
Split: 07, Run: 03
None time:  2.1561313280835748
None Run 21:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 70.90
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  2.1373454730492085
None Run 22:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 75.80
Split: 08, Run: 02
None time:  2.2151848170906305
None Run 23:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 75.80
Split: 08, Run: 03
None time:  2.1693326490931213
None Run 24:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 75.80
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.340368854114786
None Run 25:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 75.80
Split: 09, Run: 02
None time:  2.270371084101498
None Run 26:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 75.80
Split: 09, Run: 03
None time:  2.3303178620990366
None Run 27:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 75.80
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.7000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.35000000000000003)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  2.0507038689684123
None Run 28:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 65.20
Split: 10, Run: 02
None time:  1.9879960701800883
None Run 29:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 65.20
Split: 10, Run: 03
None time:  2.0507887289859354
None Run 30:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 65.20
run time now: 6.127707242965698
total time:  61.582082108128816
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 70.84 ± 6.44
  Final Train: 100.00 ± 0.00
   Final Test: 69.61 ± 5.83
best run test_acc: 69.61000061035156
[I 2023-06-12 00:15:36,565] Trial 3 finished with value: 70.83999633789062 and parameters: {'Fwd': 0.01091864579449421, 'K': 1, 'alpha': 0.35000000000000003, 'dropout': 0.7000000000000001, 'gnnepoch': 20, 'lambda1': 0.0, 'lambda2': 1.1536495968898164, 'loop': 1, 'loss': 'CE', 'lr': 0.0002942401252756048, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.0006835199063538708, 'weightedloss': True}. Best is trial 1 with value: 71.87999725341797.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.75
lr:  0.00028063531635892175
weight_decay:  0.00048398733996861566
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.3156462048646063
None Run 01:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 66.70
Split: 01, Run: 02
None time:  2.497556390007958
None Run 02:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 66.70
Split: 01, Run: 03
None time:  2.455222103977576
None Run 03:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 66.70
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  2.4761906799394637
None Run 04:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 70.90
Split: 02, Run: 02
None time:  2.5032589321490377
None Run 05:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 70.90
Split: 02, Run: 03
None time:  2.540493519976735
None Run 06:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 70.90
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  5.604017672827467
None Run 07:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 68.10
Split: 03, Run: 02
None time:  2.5541934890206903
None Run 08:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 63.90
Split: 03, Run: 03, Epoch: 100, Loss: 0.0027, Train: 100.00%, Valid: 58.60% Test: 66.10%
Split: 03, Run: 03
None time:  7.617988212965429
None Run 09:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 66.20
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  2.4049858988728374
None Run 10:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 63.90
Split: 04, Run: 02
None time:  2.536975918104872
None Run 11:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 63.90
Split: 04, Run: 03
None time:  2.4687780160456896
None Run 12:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 63.90
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  2.512263644952327
None Run 13:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 65.60
Split: 05, Run: 02
None time:  2.50997116509825
None Run 14:
Highest Train: 100.00
Highest Valid: 62.20
  Final Train: 100.00
   Final Test: 65.60
Split: 05, Run: 03, Epoch: 100, Loss: 0.0027, Train: 100.00%, Valid: 64.00% Test: 67.70%
Split: 05, Run: 03
None time:  7.431312229018658
None Run 15:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 67.50
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  2.93596612312831
None Run 16:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 75.90
Split: 06, Run: 02, Epoch: 100, Loss: 0.0028, Train: 100.00%, Valid: 81.60% Test: 75.10%
Split: 06, Run: 02
None time:  7.523752073990181
None Run 17:
Highest Train: 100.00
Highest Valid: 81.60
  Final Train: 100.00
   Final Test: 75.20
Split: 06, Run: 03
None time:  2.4634400820359588
None Run 18:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 65.00
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.510696511948481
None Run 19:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 66.50
Split: 07, Run: 02
None time:  2.521919617895037
None Run 20:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 66.50
Split: 07, Run: 03
None time:  2.952947848942131
None Run 21:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 66.30
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  2.5531819979660213
None Run 22:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 71.50
Split: 08, Run: 02
None time:  2.811931314179674
None Run 23:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 76.80
Split: 08, Run: 03, Epoch: 100, Loss: 0.0023, Train: 100.00%, Valid: 74.20% Test: 75.40%
Split: 08, Run: 03
None time:  7.914670438040048
None Run 24:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 75.30
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.472466317936778
None Run 25:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 72.10
Split: 09, Run: 02
None time:  2.5334473268594593
None Run 26:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 72.10
Split: 09, Run: 03
None time:  2.512718938058242
None Run 27:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 72.10
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  2.621560967992991
None Run 28:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 63.80
Split: 10, Run: 02
None time:  2.590719240019098
None Run 29:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 63.80
Split: 10, Run: 03
None time:  2.646434862166643
None Run 30:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 64.10
run time now: 7.91013240814209
total time:  101.06150614982471
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 67.68 ± 5.52
  Final Train: 100.00 ± 0.00
   Final Test: 68.28 ± 4.09
best run test_acc: 69.25
[I 2023-06-12 00:17:18,078] Trial 4 finished with value: 67.68000030517578 and parameters: {'Fwd': 0.0020009004691484886, 'K': 8, 'alpha': 0.75, 'dropout': 0.30000000000000004, 'gnnepoch': 110, 'lambda1': 0.30000000000000004, 'lambda2': 1.908026363815578, 'loop': 2, 'loss': 'MSE', 'lr': 0.00028063531635892175, 'softmaxF': False, 'useGCN': True, 'weight_decay': 0.00048398733996861566, 'weightedloss': False}. Best is trial 1 with value: 71.87999725341797.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  4
alpha:  0.8500000000000001
lr:  0.0019998513331845862
weight_decay:  0.07319668190317603
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.1892787548713386
None Run 01:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 78.60
Split: 01, Run: 02
None time:  1.943187871016562
None Run 02:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 76.10
Split: 01, Run: 03
None time:  2.087874813005328
None Run 03:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 76.90
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.9381252299062908
None Run 04:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 71.10
Split: 02, Run: 02
None time:  1.938463803846389
None Run 05:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 71.10
Split: 02, Run: 03
None time:  1.9848954810295254
None Run 06:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 71.70
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.9262524580117315
None Run 07:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 68.30
Split: 03, Run: 02
None time:  1.9187739449553192
None Run 08:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 68.10
Split: 03, Run: 03
None time:  1.969917814945802
None Run 09:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 69.40
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  2.1313243701588362
None Run 10:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 65.10
Split: 04, Run: 02
None time:  2.1785133469384164
None Run 11:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 65.30
Split: 04, Run: 03
None time:  2.0960983589757234
None Run 12:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 65.90
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.9500885449815542
None Run 13:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 71.70
Split: 05, Run: 02
None time:  1.6721219250466675
None Run 14:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 71.00
Split: 05, Run: 03
None time:  1.9217202211730182
None Run 15:
Highest Train: 100.00
Highest Valid: 67.40
  Final Train: 100.00
   Final Test: 72.00
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.9786950021516532
None Run 16:
Highest Train: 100.00
Highest Valid: 81.40
  Final Train: 100.00
   Final Test: 74.30
Split: 06, Run: 02
None time:  1.947608740068972
None Run 17:
Highest Train: 100.00
Highest Valid: 81.80
  Final Train: 100.00
   Final Test: 74.60
Split: 06, Run: 03
None time:  1.956295576877892
None Run 18:
Highest Train: 100.00
Highest Valid: 82.00
  Final Train: 100.00
   Final Test: 75.10
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.0390161310788244
None Run 19:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 72.30
Split: 07, Run: 02
None time:  1.9539828181732446
None Run 20:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 73.30
Split: 07, Run: 03
None time:  1.9826338810380548
None Run 21:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 72.30
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  2.0526308729313314
None Run 22:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 78.10
Split: 08, Run: 02
None time:  2.0409295870922506
None Run 23:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 78.00
Split: 08, Run: 03
None time:  2.0927807120606303
None Run 24:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 77.70
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.919548150151968
None Run 25:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 76.00
Split: 09, Run: 02
None time:  1.9666065969504416
None Run 26:
Highest Train: 100.00
Highest Valid: 79.40
  Final Train: 100.00
   Final Test: 75.80
Split: 09, Run: 03
None time:  1.9183324640616775
None Run 27:
Highest Train: 100.00
Highest Valid: 79.60
  Final Train: 100.00
   Final Test: 76.20
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.913951844908297
None Run 28:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 66.80
Split: 10, Run: 02
None time:  1.9868629360571504
None Run 29:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 67.90
Split: 10, Run: 03
None time:  1.8987192849162966
None Run 30:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 67.50
run time now: 5.840595960617065
total time:  60.64903135900386
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 73.02 ± 5.01
  Final Train: 100.00 ± 0.00
   Final Test: 72.27 ± 4.12
best run test_acc: 72.81999206542969
[I 2023-06-12 00:18:19,083] Trial 5 finished with value: 73.02000427246094 and parameters: {'Fwd': 5.101216598366453e-06, 'K': 4, 'alpha': 0.8500000000000001, 'dropout': 0.0, 'gnnepoch': 110, 'lambda1': 0.35000000000000003, 'lambda2': 8.863370317130286, 'loop': 0, 'loss': 'CE', 'lr': 0.0019998513331845862, 'softmaxF': False, 'useGCN': True, 'weight_decay': 0.07319668190317603, 'weightedloss': False}. Best is trial 5 with value: 73.02000427246094.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  5
alpha:  0.45
lr:  0.0010035348157133872
weight_decay:  0.0012635213595968379
dropout:  0.4
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 67.40% Test: 65.80%
Split: 01, Run: 01
None time:  2.959204665152356
None Run 01:
Highest Train: 100.00
Highest Valid: 67.40
  Final Train: 100.00
   Final Test: 65.60
Split: 01, Run: 02
None time:  1.3414893168956041
None Run 02:
Highest Train: 100.00
Highest Valid: 62.40
  Final Train: 100.00
   Final Test: 60.90
Split: 01, Run: 03
None time:  1.2391711580567062
None Run 03:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 61.90
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 70.20% Test: 70.50%
Split: 02, Run: 01
None time:  3.1791326159145683
None Run 04:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 70.50
Split: 02, Run: 02
None time:  1.4406298289541155
None Run 05:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 69.40
Split: 02, Run: 03
None time:  1.4565900471061468
None Run 06:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 69.40
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.4441689460072666
None Run 07:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 68.70
Split: 03, Run: 02
None time:  1.4242040980607271
None Run 08:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 65.80
Split: 03, Run: 03
None time:  1.4096148700919002
None Run 09:
Highest Train: 100.00
Highest Valid: 58.00
  Final Train: 100.00
   Final Test: 61.40
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.4297239971347153
None Run 10:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 62.30
Split: 04, Run: 02
None time:  1.4599445490166545
None Run 11:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 61.10
Split: 04, Run: 03
None time:  1.4705576971173286
None Run 12:
Highest Train: 100.00
Highest Valid: 60.80
  Final Train: 100.00
   Final Test: 60.20
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.4211543009150773
None Run 13:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 71.60
Split: 05, Run: 02
None time:  1.401384823024273
None Run 14:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 69.60
Split: 05, Run: 03
None time:  1.484169271076098
None Run 15:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 72.00
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 79.20% Test: 76.00%
Split: 06, Run: 01
None time:  3.164675148902461
None Run 16:
Highest Train: 100.00
Highest Valid: 79.20
  Final Train: 100.00
   Final Test: 76.00
Split: 06, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 77.80% Test: 75.40%
Split: 06, Run: 02
None time:  3.11995287402533
None Run 17:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 75.40
Split: 06, Run: 03
None time:  1.4016513128299266
None Run 18:
Highest Train: 100.00
Highest Valid: 80.80
  Final Train: 100.00
   Final Test: 74.10
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.4598042799625546
None Run 19:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 67.10
Split: 07, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 68.60% Test: 70.10%
Split: 07, Run: 02
None time:  3.152209678897634
None Run 20:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 69.50
Split: 07, Run: 03
None time:  1.4080312040168792
None Run 21:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 66.30
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 70.80% Test: 74.00%
Split: 08, Run: 01
None time:  2.9475514388177544
None Run 22:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 74.00
Split: 08, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 73.80% Test: 76.20%
Split: 08, Run: 02
None time:  3.179004424950108
None Run 23:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 76.20
Split: 08, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 71.20% Test: 73.60%
Split: 08, Run: 03
None time:  3.171905433991924
None Run 24:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 73.70
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.4327798171434551
None Run 25:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 72.00
Split: 09, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 76.40% Test: 74.30%
Split: 09, Run: 02
None time:  3.1866658551152796
None Run 26:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 74.40
Split: 09, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 77.00% Test: 72.30%
Split: 09, Run: 03
None time:  3.1407591269817203
None Run 27:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 72.30
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.425529469968751
None Run 28:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 67.80
Split: 10, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 70.60% Test: 67.30%
Split: 10, Run: 02
None time:  3.205544470110908
None Run 29:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 67.40
Split: 10, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 71.20% Test: 67.90%
Split: 10, Run: 03
None time:  3.168511167867109
None Run 30:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 67.70
run time now: 7.849604368209839
total time:  64.30695279594511
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.04 ± 5.82
  Final Train: 100.00 ± 0.00
   Final Test: 68.81 ± 4.84
best run test_acc: 70.30000305175781
[I 2023-06-12 00:19:23,746] Trial 6 finished with value: 69.04000091552734 and parameters: {'Fwd': 0.0005572544380997335, 'K': 5, 'alpha': 0.45, 'dropout': 0.4, 'gnnepoch': 70, 'lambda1': 0.5, 'lambda2': 9.961291291290536, 'loop': 0, 'loss': 'MSE', 'lr': 0.0010035348157133872, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.0012635213595968379, 'weightedloss': True}. Best is trial 5 with value: 73.02000427246094.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  3
alpha:  0.8500000000000001
lr:  0.00018355108545525987
weight_decay:  2.072045509093284e-05
dropout:  0.5
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.6034375049639493
None Run 01:
Highest Train: 100.00
Highest Valid: 37.60
  Final Train: 100.00
   Final Test: 40.40
Split: 01, Run: 02
None time:  1.580208710860461
None Run 02:
Highest Train: 100.00
Highest Valid: 37.60
  Final Train: 100.00
   Final Test: 40.40
Split: 01, Run: 03
None time:  1.8693242738954723
None Run 03:
Highest Train: 100.00
Highest Valid: 61.80
  Final Train: 100.00
   Final Test: 59.40
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.5368693189229816
None Run 04:
Highest Train: 100.00
Highest Valid: 49.60
  Final Train: 100.00
   Final Test: 44.40
Split: 02, Run: 02
None time:  1.6144027670379728
None Run 05:
Highest Train: 100.00
Highest Valid: 49.60
  Final Train: 100.00
   Final Test: 44.40
Split: 02, Run: 03
None time:  1.6091973490547389
None Run 06:
Highest Train: 100.00
Highest Valid: 49.60
  Final Train: 100.00
   Final Test: 44.40
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.528560525039211
None Run 07:
Highest Train: 100.00
Highest Valid: 40.00
  Final Train: 100.00
   Final Test: 40.80
Split: 03, Run: 02
None time:  1.6138484301045537
None Run 08:
Highest Train: 100.00
Highest Valid: 27.80
  Final Train: 100.00
   Final Test: 30.10
Split: 03, Run: 03, Epoch: 100, Loss: 0.4557, Train: 100.00%, Valid: 53.00% Test: 53.70%
Split: 03, Run: 03
None time:  4.566431044833735
None Run 09:
Highest Train: 100.00
Highest Valid: 53.00
  Final Train: 100.00
   Final Test: 53.10
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01, Epoch: 100, Loss: 0.4858, Train: 100.00%, Valid: 61.40% Test: 60.60%
Split: 04, Run: 01
None time:  4.556147571885958
None Run 10:
Highest Train: 100.00
Highest Valid: 61.40
  Final Train: 100.00
   Final Test: 60.40
Split: 04, Run: 02, Epoch: 100, Loss: 0.4759, Train: 100.00%, Valid: 67.00% Test: 64.00%
Split: 04, Run: 02
None time:  4.590723111992702
None Run 11:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 63.90
Split: 04, Run: 03, Epoch: 100, Loss: 0.4087, Train: 100.00%, Valid: 41.60% Test: 45.20%
Split: 04, Run: 03
None time:  4.571036357898265
None Run 12:
Highest Train: 100.00
Highest Valid: 41.60
  Final Train: 100.00
   Final Test: 45.10
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  3.0999180220533162
None Run 13:
Highest Train: 100.00
Highest Valid: 54.20
  Final Train: 100.00
   Final Test: 56.70
Split: 05, Run: 02, Epoch: 100, Loss: 0.4325, Train: 100.00%, Valid: 40.40% Test: 43.00%
Split: 05, Run: 02
None time:  4.5728618539869785
None Run 14:
Highest Train: 100.00
Highest Valid: 40.40
  Final Train: 100.00
   Final Test: 43.70
Split: 05, Run: 03
None time:  1.6022532610222697
None Run 15:
Highest Train: 100.00
Highest Valid: 40.20
  Final Train: 100.00
   Final Test: 42.70
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.6493849901016802
None Run 16:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 62.80
Split: 06, Run: 02, Epoch: 100, Loss: 0.4616, Train: 100.00%, Valid: 48.20% Test: 46.10%
Split: 06, Run: 02
None time:  4.60969543014653
None Run 17:
Highest Train: 100.00
Highest Valid: 48.20
  Final Train: 100.00
   Final Test: 45.50
Split: 06, Run: 03
None time:  2.7491958260070533
None Run 18:
Highest Train: 100.00
Highest Valid: 47.00
  Final Train: 100.00
   Final Test: 50.00
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01, Epoch: 100, Loss: 0.4355, Train: 100.00%, Valid: 54.00% Test: 55.60%
Split: 07, Run: 01
None time:  4.5842655510641634
None Run 19:
Highest Train: 100.00
Highest Valid: 54.00
  Final Train: 100.00
   Final Test: 55.40
Split: 07, Run: 02
None time:  1.8169567449949682
None Run 20:
Highest Train: 100.00
Highest Valid: 60.00
  Final Train: 100.00
   Final Test: 60.50
Split: 07, Run: 03
None time:  1.4340447690337896
None Run 21:
Highest Train: 100.00
Highest Valid: 39.40
  Final Train: 100.00
   Final Test: 41.60
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  3.6089752328116447
None Run 22:
Highest Train: 100.00
Highest Valid: 51.40
  Final Train: 100.00
   Final Test: 56.00
Split: 08, Run: 02
None time:  1.5623480069916695
None Run 23:
Highest Train: 100.00
Highest Valid: 46.60
  Final Train: 100.00
   Final Test: 47.20
Split: 08, Run: 03
None time:  2.3376282148528844
None Run 24:
Highest Train: 100.00
Highest Valid: 59.20
  Final Train: 100.00
   Final Test: 63.30
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  3.6571367289870977
None Run 25:
Highest Train: 100.00
Highest Valid: 61.20
  Final Train: 100.00
   Final Test: 58.60
Split: 09, Run: 02, Epoch: 100, Loss: 0.4623, Train: 100.00%, Valid: 47.20% Test: 45.40%
Split: 09, Run: 02
None time:  4.495514114852995
None Run 26:
Highest Train: 100.00
Highest Valid: 47.20
  Final Train: 100.00
   Final Test: 45.40
Split: 09, Run: 03
None time:  3.684687281958759
None Run 27:
Highest Train: 100.00
Highest Valid: 60.80
  Final Train: 100.00
   Final Test: 61.90
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01, Epoch: 100, Loss: 0.4271, Train: 100.00%, Valid: 53.20% Test: 52.80%
Split: 10, Run: 01
None time:  4.335911855101585
None Run 28:
Highest Train: 100.00
Highest Valid: 53.20
  Final Train: 100.00
   Final Test: 52.80
Split: 10, Run: 02
None time:  3.189475276041776
None Run 29:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 54.70
Split: 10, Run: 03
None time:  1.5425834939815104
None Run 30:
Highest Train: 100.00
Highest Valid: 55.80
  Final Train: 100.00
   Final Test: 49.20
run time now: 9.109374523162842
total time:  86.85546518606134
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 50.77 ± 9.80
  Final Train: 100.00 ± 0.00
   Final Test: 50.49 ± 8.70
best run test_acc: 58.06999588012695
[I 2023-06-12 00:20:51,068] Trial 7 finished with value: 50.77333450317383 and parameters: {'Fwd': 2.6658463007461147e-06, 'K': 3, 'alpha': 0.8500000000000001, 'dropout': 0.5, 'gnnepoch': 70, 'lambda1': 0.9, 'lambda2': 6.908077341330622, 'loop': 1, 'loss': 'MSE', 'lr': 0.00018355108545525987, 'softmaxF': False, 'useGCN': True, 'weight_decay': 2.072045509093284e-05, 'weightedloss': True}. Best is trial 5 with value: 73.02000427246094.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  1
alpha:  0.8500000000000001
lr:  0.00018028397556925626
weight_decay:  3.792555134739288e-05
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.19503065198659897
None Run 01:
Highest Train: 100.00
Highest Valid: 40.40
  Final Train: 100.00
   Final Test: 38.50
Split: 01, Run: 02
None time:  0.21048394893296063
None Run 02:
Highest Train: 100.00
Highest Valid: 43.00
  Final Train: 100.00
   Final Test: 41.30
Split: 01, Run: 03
None time:  0.21810424514114857
None Run 03:
Highest Train: 100.00
Highest Valid: 50.80
  Final Train: 100.00
   Final Test: 44.50
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.2196835291106254
None Run 04:
Highest Train: 100.00
Highest Valid: 44.00
  Final Train: 100.00
   Final Test: 43.50
Split: 02, Run: 02
None time:  0.22220969409681857
None Run 05:
Highest Train: 100.00
Highest Valid: 35.80
  Final Train: 100.00
   Final Test: 35.30
Split: 02, Run: 03
None time:  0.18605008395388722
None Run 06:
Highest Train: 100.00
Highest Valid: 26.00
  Final Train: 100.00
   Final Test: 25.40
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.14688246115110815
None Run 07:
Highest Train: 100.00
Highest Valid: 18.60
  Final Train: 100.00
   Final Test: 20.70
Split: 03, Run: 02
None time:  0.24331464688293636
None Run 08:
Highest Train: 100.00
Highest Valid: 43.20
  Final Train: 100.00
   Final Test: 41.40
Split: 03, Run: 03
None time:  0.16058945981785655
None Run 09:
Highest Train: 100.00
Highest Valid: 23.80
  Final Train: 100.00
   Final Test: 26.30
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.2135088189970702
None Run 10:
Highest Train: 100.00
Highest Valid: 29.60
  Final Train: 100.00
   Final Test: 27.80
Split: 04, Run: 02
None time:  0.23062833794392645
None Run 11:
Highest Train: 100.00
Highest Valid: 29.60
  Final Train: 100.00
   Final Test: 29.90
Split: 04, Run: 03
None time:  0.28005946008488536
None Run 12:
Highest Train: 100.00
Highest Valid: 48.00
  Final Train: 100.00
   Final Test: 48.50
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.166879050899297
None Run 13:
Highest Train: 100.00
Highest Valid: 36.20
  Final Train: 100.00
   Final Test: 32.50
Split: 05, Run: 02
None time:  0.5760145781096071
None Run 14:
Highest Train: 100.00
Highest Valid: 43.20
  Final Train: 100.00
   Final Test: 39.70
Split: 05, Run: 03
None time:  0.19834705512039363
None Run 15:
Highest Train: 100.00
Highest Valid: 48.60
  Final Train: 100.00
   Final Test: 44.10
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.25078776897862554
None Run 16:
Highest Train: 100.00
Highest Valid: 44.80
  Final Train: 100.00
   Final Test: 47.00
Split: 06, Run: 02
None time:  0.16094827791675925
None Run 17:
Highest Train: 100.00
Highest Valid: 31.60
  Final Train: 100.00
   Final Test: 32.40
Split: 06, Run: 03
None time:  0.19089738512411714
None Run 18:
Highest Train: 100.00
Highest Valid: 31.00
  Final Train: 100.00
   Final Test: 26.70
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.257392373168841
None Run 19:
Highest Train: 100.00
Highest Valid: 41.60
  Final Train: 100.00
   Final Test: 38.00
Split: 07, Run: 02
None time:  0.22422470594756305
None Run 20:
Highest Train: 100.00
Highest Valid: 43.00
  Final Train: 100.00
   Final Test: 39.00
Split: 07, Run: 03
None time:  0.24114288901910186
None Run 21:
Highest Train: 100.00
Highest Valid: 46.00
  Final Train: 100.00
   Final Test: 44.50
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.18295625504106283
None Run 22:
Highest Train: 100.00
Highest Valid: 37.60
  Final Train: 100.00
   Final Test: 41.90
Split: 08, Run: 02
None time:  0.35807536309584975
None Run 23:
Highest Train: 100.00
Highest Valid: 36.40
  Final Train: 100.00
   Final Test: 38.80
Split: 08, Run: 03
None time:  0.32564021297730505
None Run 24:
Highest Train: 100.00
Highest Valid: 44.80
  Final Train: 100.00
   Final Test: 42.80
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  0.21455075615085661
None Run 25:
Highest Train: 100.00
Highest Valid: 43.40
  Final Train: 100.00
   Final Test: 41.00
Split: 09, Run: 02
None time:  0.2283125298563391
None Run 26:
Highest Train: 100.00
Highest Valid: 24.00
  Final Train: 100.00
   Final Test: 21.70
Split: 09, Run: 03
None time:  0.20567501801997423
None Run 27:
Highest Train: 100.00
Highest Valid: 38.40
  Final Train: 100.00
   Final Test: 38.40
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=1, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.35696805897168815
None Run 28:
Highest Train: 100.00
Highest Valid: 42.40
  Final Train: 100.00
   Final Test: 36.10
Split: 10, Run: 02
None time:  0.18153850315138698
None Run 29:
Highest Train: 100.00
Highest Valid: 31.40
  Final Train: 100.00
   Final Test: 31.20
Split: 10, Run: 03
None time:  0.6542156909126788
None Run 30:
Highest Train: 100.00
Highest Valid: 47.40
  Final Train: 100.00
   Final Test: 39.20
run time now: 1.2255146503448486
total time:  8.436681682942435
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 38.15 ± 8.37
  Final Train: 100.00 ± 0.00
   Final Test: 36.60 ± 7.51
best run test_acc: 43.650001525878906
[I 2023-06-12 00:20:59,877] Trial 8 finished with value: 38.1533317565918 and parameters: {'Fwd': 1.0313637673287342e-05, 'K': 1, 'alpha': 0.8500000000000001, 'dropout': 0.1, 'gnnepoch': 0, 'lambda1': 0.9, 'lambda2': 0.5638271265431793, 'loop': 0, 'loss': 'CE', 'lr': 0.00018028397556925626, 'softmaxF': False, 'useGCN': True, 'weight_decay': 3.792555134739288e-05, 'weightedloss': False}. Best is trial 5 with value: 73.02000427246094.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  4
alpha:  0.0
lr:  0.001552653921713113
weight_decay:  8.220349634798757e-05
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.109816286014393
None Run 01:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 62.50
Split: 01, Run: 02
None time:  3.2706002781633288
None Run 02:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 66.50
Split: 01, Run: 03
None time:  1.1244142090436071
None Run 03:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 60.90
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.118648854084313
None Run 04:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 72.10
Split: 02, Run: 02
None time:  2.2672455231659114
None Run 05:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 72.00
Split: 02, Run: 03
None time:  1.2325483141466975
None Run 06:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 69.90
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.518407299881801
None Run 07:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 67.50
Split: 03, Run: 02
None time:  1.0993995270691812
None Run 08:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 66.00
Split: 03, Run: 03
None time:  2.899276301963255
None Run 09:
Highest Train: 100.00
Highest Valid: 59.60
  Final Train: 100.00
   Final Test: 61.10
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.1153063799720258
None Run 10:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 63.80
Split: 04, Run: 02
None time:  1.0357864869292825
None Run 11:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 62.90
Split: 04, Run: 03, Epoch: 100, Loss: 0.0152, Train: 100.00%, Valid: 62.60% Test: 63.10%
Split: 04, Run: 03
None time:  4.076931512914598
None Run 12:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 62.60
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.125383630860597
None Run 13:
Highest Train: 100.00
Highest Valid: 59.60
  Final Train: 100.00
   Final Test: 63.70
Split: 05, Run: 02
None time:  2.466871390119195
None Run 14:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 76.10
Split: 05, Run: 03
None time:  1.1702845729887486
None Run 15:
Highest Train: 100.00
Highest Valid: 62.00
  Final Train: 100.00
   Final Test: 67.30
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.1222232619766146
None Run 16:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 73.50
Split: 06, Run: 02
None time:  1.1739332259166986
None Run 17:
Highest Train: 100.00
Highest Valid: 80.40
  Final Train: 100.00
   Final Test: 76.20
Split: 06, Run: 03
None time:  1.1366976539138705
None Run 18:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 75.00
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.9998471790459007
None Run 19:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.20
Split: 07, Run: 02
None time:  1.489578504115343
None Run 20:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 70.20
Split: 07, Run: 03, Epoch: 100, Loss: 0.0133, Train: 100.00%, Valid: 69.60% Test: 68.40%
Split: 07, Run: 03
None time:  4.226036828011274
None Run 21:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 68.40
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  2.0706309429369867
None Run 22:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 76.50
Split: 08, Run: 02
None time:  1.9880089219659567
None Run 23:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 77.10
Split: 08, Run: 03, Epoch: 100, Loss: 0.0091, Train: 100.00%, Valid: 75.00% Test: 77.20%
Split: 08, Run: 03
None time:  4.04766845703125
None Run 24:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 77.00
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.3369103921577334
None Run 25:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 74.90
Split: 09, Run: 02
None time:  1.4998487969860435
None Run 26:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 100.00
   Final Test: 75.70
Split: 09, Run: 03
None time:  1.1118160740006715
None Run 27:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 74.00
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01, Epoch: 100, Loss: 0.0143, Train: 100.00%, Valid: 71.40% Test: 68.60%
Split: 10, Run: 01
None time:  4.236075941007584
None Run 28:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 68.70
Split: 10, Run: 02
None time:  1.1172978589311242
None Run 29:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 65.60
Split: 10, Run: 03, Epoch: 100, Loss: 0.0146, Train: 100.00%, Valid: 71.80% Test: 68.80%
Split: 10, Run: 03
None time:  4.282021151855588
None Run 30:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 68.80
run time now: 9.67357611656189
total time:  60.52959685213864
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 70.08 ± 6.06
  Final Train: 100.00 ± 0.00
   Final Test: 69.56 ± 5.25
best run test_acc: 71.4000015258789
[I 2023-06-12 00:22:00,884] Trial 9 finished with value: 70.08000183105469 and parameters: {'Fwd': 3.3646930788703135e-06, 'K': 4, 'alpha': 0.0, 'dropout': 0.1, 'gnnepoch': 40, 'lambda1': 0.05, 'lambda2': 7.359298266585167, 'loop': 1, 'loss': 'MSE', 'lr': 0.001552653921713113, 'softmaxF': False, 'useGCN': True, 'weight_decay': 8.220349634798757e-05, 'weightedloss': False}. Best is trial 5 with value: 73.02000427246094.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  0.6000000000000001
lr:  0.006991045191183692
weight_decay:  0.09247862142044554
dropout:  0.9
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.9118277949746698
None Run 01:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 62.80
Split: 01, Run: 02
None time:  0.968431742163375
None Run 02:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 63.30
Split: 01, Run: 03
None time:  0.9714548580814153
None Run 03:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 66.30
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.9306643249001354
None Run 04:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 70.90
Split: 02, Run: 02
None time:  0.9050472220405936
None Run 05:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 73.40
Split: 02, Run: 03
None time:  0.8856197409331799
None Run 06:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 70.90
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.9465862729121
None Run 07:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 65.80
Split: 03, Run: 02
None time:  0.9598138381261379
None Run 08:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 68.20
Split: 03, Run: 03
None time:  0.9018209460191429
None Run 09:
Highest Train: 100.00
Highest Valid: 59.20
  Final Train: 100.00
   Final Test: 61.60
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.9331009879242629
None Run 10:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 65.80
Split: 04, Run: 02
None time:  1.0979617580305785
None Run 11:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 93.33
   Final Test: 65.50
Split: 04, Run: 03
None time:  0.8574233371764421
None Run 12:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 63.70
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.9373722169548273
None Run 13:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 71.70
Split: 05, Run: 02
None time:  1.0595201840624213
None Run 14:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 96.67
   Final Test: 76.50
Split: 05, Run: 03
None time:  0.9771552800666541
None Run 15:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 96.67
   Final Test: 66.50
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.9097148501314223
None Run 16:
Highest Train: 100.00
Highest Valid: 79.60
  Final Train: 100.00
   Final Test: 74.80
Split: 06, Run: 02
None time:  0.9532452488783747
None Run 17:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 74.00
Split: 06, Run: 03
None time:  1.138933087931946
None Run 18:
Highest Train: 100.00
Highest Valid: 81.60
  Final Train: 96.67
   Final Test: 78.00
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.9105476071126759
None Run 19:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 74.50
Split: 07, Run: 02
None time:  0.9200929708313197
None Run 20:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 67.30
Split: 07, Run: 03
None time:  0.9648191430605948
None Run 21:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 73.80
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.0224269039463252
None Run 22:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 96.67
   Final Test: 77.50
Split: 08, Run: 02
None time:  1.0959300689864904
None Run 23:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 96.67
   Final Test: 79.10
Split: 08, Run: 03
None time:  1.006547928089276
None Run 24:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 77.80
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.0112329870462418
None Run 25:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 74.90
Split: 09, Run: 02
None time:  1.007532024057582
None Run 26:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 73.50
Split: 09, Run: 03
None time:  0.9754605910275131
None Run 27:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 76.60
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.9, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.6000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.9873720940668136
None Run 28:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 68.40
Split: 10, Run: 02
None time:  0.9518262189812958
None Run 29:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 96.67
   Final Test: 65.80
Split: 10, Run: 03
None time:  0.8558963378891349
None Run 30:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 67.00
run time now: 2.8454926013946533
total time:  30.044410090893507
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 71.13 ± 5.60
  Final Train: 99.11 ± 1.74
   Final Test: 70.53 ± 5.24
best run test_acc: 72.67999267578125
[I 2023-06-12 00:22:31,357] Trial 10 finished with value: 71.13333129882812 and parameters: {'Fwd': 4.471988111706798e-05, 'K': 7, 'alpha': 0.6000000000000001, 'dropout': 0.9, 'gnnepoch': 80, 'lambda1': 0.45, 'lambda2': 3.2699425948639833, 'loop': 0, 'loss': 'CE', 'lr': 0.006991045191183692, 'softmaxF': True, 'useGCN': False, 'weight_decay': 0.09247862142044554, 'weightedloss': False}. Best is trial 5 with value: 73.02000427246094.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.9500000000000001
lr:  0.0028399404655277305
weight_decay:  1.1495902869369329e-06
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.4205959918908775
None Run 01:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 65.00
Split: 01, Run: 02
None time:  1.4866747190244496
None Run 02:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 76.20
Split: 01, Run: 03
None time:  1.4549727919511497
None Run 03:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 86.67
   Final Test: 74.90
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.3243883731774986
None Run 04:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
Split: 02, Run: 02
None time:  1.2260906719602644
None Run 05:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
Split: 02, Run: 03
None time:  1.3692844421602786
None Run 06:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.4727993628475815
None Run 07:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 64.00
Split: 03, Run: 02
None time:  1.515538641018793
None Run 08:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 93.33
   Final Test: 70.70
Split: 03, Run: 03
None time:  1.2386929648928344
None Run 09:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 71.00
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.3827310937922448
None Run 10:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 65.20
Split: 04, Run: 02
None time:  2.2448254378978163
None Run 11:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 70.00
   Final Test: 66.00
Split: 04, Run: 03
None time:  1.476608658907935
None Run 12:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 93.33
   Final Test: 60.60
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.8734018781688064
None Run 13:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 76.67
   Final Test: 74.00
Split: 05, Run: 02
None time:  1.3893478498794138
None Run 14:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 90.00
   Final Test: 72.10
Split: 05, Run: 03
None time:  1.3749045920558274
None Run 15:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 96.67
   Final Test: 71.60
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.379401020007208
None Run 16:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 100.00
   Final Test: 73.40
Split: 06, Run: 02
None time:  1.3926735518034548
None Run 17:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 70.70
Split: 06, Run: 03
None time:  1.644000048050657
None Run 18:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 70.00
   Final Test: 68.80
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.3792308680713177
None Run 19:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 75.40
Split: 07, Run: 02
None time:  1.3504978551063687
None Run 20:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 73.00
Split: 07, Run: 03
None time:  1.4610980649013072
None Run 21:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 73.20
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.4308468971867114
None Run 22:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 71.60
Split: 08, Run: 02
None time:  1.3823582099284977
None Run 23:
Highest Train: 100.00
Highest Valid: 80.20
  Final Train: 100.00
   Final Test: 79.30
Split: 08, Run: 03
None time:  1.4260987099260092
None Run 24:
Highest Train: 100.00
Highest Valid: 79.80
  Final Train: 100.00
   Final Test: 77.70
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.3832126779016107
None Run 25:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 75.30
Split: 09, Run: 02
None time:  1.430225929012522
None Run 26:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 77.20
Split: 09, Run: 03
None time:  1.4193921161349863
None Run 27:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 76.10
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.3774454358499497
None Run 28:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 69.80
Split: 10, Run: 02
None time:  1.412086997879669
None Run 29:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 96.67
   Final Test: 64.10
Split: 10, Run: 03
None time:  1.5989430430345237
None Run 30:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 86.67
   Final Test: 65.10
run time now: 4.430516242980957
total time:  44.77369309193455
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.69 ± 4.75
  Final Train: 95.33 ± 8.82
   Final Test: 71.14 ± 4.64
best run test_acc: 73.30000305175781
[I 2023-06-12 00:23:16,666] Trial 11 finished with value: 72.6866683959961 and parameters: {'Fwd': 7.526891638824316e-05, 'K': 6, 'alpha': 0.9500000000000001, 'dropout': 0.0, 'gnnepoch': 120, 'lambda1': 0.7000000000000001, 'lambda2': 9.388420332035993, 'loop': 2, 'loss': 'CE', 'lr': 0.0028399404655277305, 'softmaxF': False, 'useGCN': False, 'weight_decay': 1.1495902869369329e-06, 'weightedloss': False}. Best is trial 5 with value: 73.02000427246094.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  3
alpha:  1.0
lr:  0.002901988504504973
weight_decay:  0.07363187717870849
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.1195728888269514
None Run 01:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 66.20
Split: 01, Run: 02
None time:  1.0893324969802052
None Run 02:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 74.60
Split: 01, Run: 03
None time:  1.198453834047541
None Run 03:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 96.67
   Final Test: 74.40
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.9871172090061009
None Run 04:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 70.50
Split: 02, Run: 02
None time:  1.0318800848908722
None Run 05:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 69.60
Split: 02, Run: 03
None time:  1.0772477551363409
None Run 06:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 66.30
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.6105301708448678
None Run 07:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 86.67
   Final Test: 66.00
Split: 03, Run: 02
None time:  1.0009996071457863
None Run 08:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 70.30
Split: 03, Run: 03
None time:  1.033844314981252
None Run 09:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 71.20
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.0351154019590467
None Run 10:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 64.30
Split: 04, Run: 02
None time:  1.4810433890670538
None Run 11:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 83.33
   Final Test: 60.20
Split: 04, Run: 03
None time:  1.2299490969162434
None Run 12:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 90.00
   Final Test: 60.50
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.0759087819606066
None Run 13:
Highest Train: 100.00
Highest Valid: 59.60
  Final Train: 100.00
   Final Test: 65.20
Split: 05, Run: 02
None time:  1.1374521928373724
None Run 14:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 75.70
Split: 05, Run: 03
None time:  1.1030477040912956
None Run 15:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 96.67
   Final Test: 75.80
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.1600472352001816
None Run 16:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 69.40
Split: 06, Run: 02
None time:  1.0804440879728645
None Run 17:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 72.30
Split: 06, Run: 03
None time:  1.1430433969944715
None Run 18:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 70.20
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.1434049769304693
None Run 19:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 74.20
Split: 07, Run: 02
None time:  1.0720013540703803
None Run 20:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 69.40
Split: 07, Run: 03
None time:  1.0854575000703335
None Run 21:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 68.90
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.4233905570581555
None Run 22:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 96.67
   Final Test: 73.90
Split: 08, Run: 02
None time:  1.0503122929949313
None Run 23:
Highest Train: 100.00
Highest Valid: 80.60
  Final Train: 100.00
   Final Test: 77.40
Split: 08, Run: 03
None time:  1.1241602320224047
None Run 24:
Highest Train: 100.00
Highest Valid: 80.00
  Final Train: 100.00
   Final Test: 77.80
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.076688848203048
None Run 25:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 72.40
Split: 09, Run: 02
None time:  1.1608601070474833
None Run 26:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 75.00
Split: 09, Run: 03
None time:  1.1071404051035643
None Run 27:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 74.50
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.102418347960338
None Run 28:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 69.70
Split: 10, Run: 02
None time:  1.1109298181254417
None Run 29:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 63.20
Split: 10, Run: 03
None time:  1.1820365861058235
None Run 30:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 86.67
   Final Test: 61.30
run time now: 3.474564552307129
total time:  35.44023005897179
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 71.71 ± 4.85
  Final Train: 97.89 ± 4.67
   Final Test: 70.01 ± 4.99
best run test_acc: 72.54000091552734
[I 2023-06-12 00:23:52,503] Trial 12 finished with value: 71.7066650390625 and parameters: {'Fwd': 5.510851589736858e-05, 'K': 3, 'alpha': 1.0, 'dropout': 0.0, 'gnnepoch': 90, 'lambda1': 0.7000000000000001, 'lambda2': 9.768245684607775, 'loop': 2, 'loss': 'CE', 'lr': 0.002901988504504973, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.07363187717870849, 'weightedloss': False}. Best is trial 5 with value: 73.02000427246094.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  1.0
lr:  0.009202490168532237
weight_decay:  0.006233324727901524
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.2219101120717824
None Run 01:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 96.67
   Final Test: 71.00
Split: 01, Run: 02
None time:  1.200147275114432
None Run 02:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 96.67
   Final Test: 78.60
Split: 01, Run: 03
None time:  1.2191382749006152
None Run 03:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 93.33
   Final Test: 79.10
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.1165656140074134
None Run 04:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.80
Split: 02, Run: 02
None time:  1.1680571029428393
None Run 05:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 75.70
Split: 02, Run: 03
None time:  1.1984618420246989
None Run 06:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.80
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.2946201891172677
None Run 07:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 93.33
   Final Test: 68.70
Split: 03, Run: 02
None time:  1.1909157009795308
None Run 08:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 67.50
Split: 03, Run: 03
None time:  1.375809313962236
None Run 09:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 60.00
   Final Test: 66.40
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.174676138907671
None Run 10:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 63.40
Split: 04, Run: 02
None time:  1.2861386199947447
None Run 11:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 90.00
   Final Test: 61.40
Split: 04, Run: 03
None time:  1.2434562349226326
None Run 12:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 93.33
   Final Test: 60.60
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.2003218340687454
None Run 13:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 72.30
Split: 05, Run: 02
None time:  1.2102520379703492
None Run 14:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 77.70
Split: 05, Run: 03
None time:  1.207165134837851
None Run 15:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 96.67
   Final Test: 76.00
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.1992164289113134
None Run 16:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 73.40
Split: 06, Run: 02
None time:  1.2307189379353076
None Run 17:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 96.67
   Final Test: 70.40
Split: 06, Run: 03
None time:  1.4915220900438726
None Run 18:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 63.33
   Final Test: 68.60
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.1634114640764892
None Run 19:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 76.40
Split: 07, Run: 02
None time:  1.1733134491369128
None Run 20:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 73.00
Split: 07, Run: 03
None time:  1.2841276379767805
None Run 21:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 96.67
   Final Test: 72.90
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.2480587740428746
None Run 22:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 77.30
Split: 08, Run: 02
None time:  1.262292408850044
None Run 23:
Highest Train: 100.00
Highest Valid: 80.00
  Final Train: 96.67
   Final Test: 79.00
Split: 08, Run: 03
None time:  1.2100682039745152
None Run 24:
Highest Train: 100.00
Highest Valid: 80.20
  Final Train: 96.67
   Final Test: 78.80
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.192661336157471
None Run 25:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 77.50
Split: 09, Run: 02
None time:  1.335862826090306
None Run 26:
Highest Train: 100.00
Highest Valid: 79.20
  Final Train: 100.00
   Final Test: 78.90
Split: 09, Run: 03
None time:  1.2773669119924307
None Run 27:
Highest Train: 100.00
Highest Valid: 79.80
  Final Train: 100.00
   Final Test: 79.10
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.1825077238027006
None Run 28:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 70.60
Split: 10, Run: 02
None time:  1.1789907570928335
None Run 29:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 96.67
   Final Test: 68.90
Split: 10, Run: 03
None time:  1.114262576913461
None Run 30:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 96.67
   Final Test: 65.60
run time now: 3.5180139541625977
total time:  38.075633090920746
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 73.31 ± 5.05
  Final Train: 95.44 ± 9.57
   Final Test: 72.35 ± 5.50
best run test_acc: 74.31000518798828
[I 2023-06-12 00:24:31,099] Trial 13 finished with value: 73.30667114257812 and parameters: {'Fwd': 5.072851352980147e-05, 'K': 6, 'alpha': 1.0, 'dropout': 0.2, 'gnnepoch': 100, 'lambda1': 0.75, 'lambda2': 8.204492643689674, 'loop': 1, 'loss': 'CE', 'lr': 0.009202490168532237, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.006233324727901524, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  10
alpha:  0.65
lr:  0.009156052480772945
weight_decay:  0.013788599388339465
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.2394877749029547
None Run 01:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 69.10
Split: 01, Run: 02
None time:  1.2048023699317127
None Run 02:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 72.10
Split: 01, Run: 03
None time:  1.169295541010797
None Run 03:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 93.33
   Final Test: 67.90
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.2567152460105717
None Run 04:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 02
None time:  1.1631258730776608
None Run 05:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 03
None time:  1.1405693220440298
None Run 06:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 71.20
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.2613893919624388
None Run 07:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 68.40
Split: 03, Run: 02
None time:  1.2105973451398313
None Run 08:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 70.50
Split: 03, Run: 03
None time:  1.1651118849404156
None Run 09:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 96.67
   Final Test: 69.10
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.1642876910045743
None Run 10:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 63.40
Split: 04, Run: 02
None time:  1.284995635971427
None Run 11:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 86.67
   Final Test: 62.80
Split: 04, Run: 03
None time:  1.2390409500803798
None Run 12:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 90.00
   Final Test: 60.60
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.2695571689400822
None Run 13:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 72.40
Split: 05, Run: 02
None time:  1.2975383759476244
None Run 14:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 76.67
   Final Test: 75.40
Split: 05, Run: 03
None time:  1.24540622998029
None Run 15:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 83.33
   Final Test: 73.30
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.1947373969014734
None Run 16:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 77.20
Split: 06, Run: 02
None time:  1.2598959859460592
None Run 17:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 72.00
Split: 06, Run: 03
None time:  1.6743754029739648
None Run 18:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 60.00
   Final Test: 69.20
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.1746144979260862
None Run 19:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 73.70
Split: 07, Run: 02
None time:  1.264491219073534
None Run 20:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 96.67
   Final Test: 68.90
Split: 07, Run: 03
None time:  1.6634236839599907
None Run 21:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 73.33
   Final Test: 71.40
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.2408424830064178
None Run 22:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 96.67
   Final Test: 77.90
Split: 08, Run: 02
None time:  1.2109083749819547
None Run 23:
Highest Train: 100.00
Highest Valid: 79.80
  Final Train: 100.00
   Final Test: 80.10
Split: 08, Run: 03
None time:  1.1964435880072415
None Run 24:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 77.80
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.315475356997922
None Run 25:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 74.00
Split: 09, Run: 02
None time:  1.2908815441187471
None Run 26:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 96.67
   Final Test: 76.50
Split: 09, Run: 03
None time:  1.2526844888925552
None Run 27:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 96.67
   Final Test: 78.50
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.2068922640755773
None Run 28:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 69.40
Split: 10, Run: 02
None time:  1.197536082006991
None Run 29:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 64.50
Split: 10, Run: 03
None time:  1.092954765073955
None Run 30:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 64.50
run time now: 3.546903371810913
total time:  38.91956882108934
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.04 ± 4.34
  Final Train: 94.89 ± 9.70
   Final Test: 71.14 ± 4.91
best run test_acc: 73.1500015258789
[I 2023-06-12 00:25:10,635] Trial 14 finished with value: 72.04000091552734 and parameters: {'Fwd': 1.2277114371921327e-06, 'K': 10, 'alpha': 0.65, 'dropout': 0.2, 'gnnepoch': 90, 'lambda1': 0.65, 'lambda2': 7.782810806830667, 'loop': 1, 'loss': 'CE', 'lr': 0.009156052480772945, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.013788599388339465, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.8
lr:  0.005972758121391701
weight_decay:  0.008090119822750878
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.7679269600193948
None Run 01:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 72.00
Split: 01, Run: 02
None time:  0.645117374137044
None Run 02:
Highest Train: 100.00
Highest Valid: 61.80
  Final Train: 100.00
   Final Test: 65.20
Split: 01, Run: 03
None time:  0.8328738710843027
None Run 03:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 60.30
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.5968265540432185
None Run 04:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.80
Split: 02, Run: 02
None time:  0.4823734958190471
None Run 05:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.80
Split: 02, Run: 03
None time:  0.7122901692055166
None Run 06:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 96.67
   Final Test: 74.80
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.7119625629857183
None Run 07:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 70.00
Split: 03, Run: 02
None time:  0.7276151499245316
None Run 08:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 59.80
Split: 03, Run: 03
None time:  0.6615345932077616
None Run 09:
Highest Train: 100.00
Highest Valid: 59.60
  Final Train: 100.00
   Final Test: 62.90
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.8025411879643798
None Run 10:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 66.70
Split: 04, Run: 02
None time:  0.6361332349479198
None Run 11:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 68.20
Split: 04, Run: 03
None time:  0.6058114680927247
None Run 12:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 63.20
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.6263066129758954
None Run 13:
Highest Train: 100.00
Highest Valid: 60.00
  Final Train: 100.00
   Final Test: 63.60
Split: 05, Run: 02
None time:  0.7600066140294075
None Run 14:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 70.90
Split: 05, Run: 03
None time:  0.7897420320659876
None Run 15:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 68.50
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.7014301149174571
None Run 16:
Highest Train: 100.00
Highest Valid: 81.60
  Final Train: 100.00
   Final Test: 76.60
Split: 06, Run: 02
None time:  0.7138941870070994
None Run 17:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 69.60
Split: 06, Run: 03
None time:  0.8090529318433255
None Run 18:
Highest Train: 100.00
Highest Valid: 79.80
  Final Train: 96.67
   Final Test: 74.00
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.6560764329042286
None Run 19:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 74.30
Split: 07, Run: 02
None time:  0.7196287310216576
None Run 20:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 68.70
Split: 07, Run: 03
None time:  0.8846081010997295
None Run 21:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 96.67
   Final Test: 72.90
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.7324869111180305
None Run 22:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 77.80
Split: 08, Run: 02
None time:  0.6152918641455472
None Run 23:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 71.50
Split: 08, Run: 03
None time:  0.7375280528794974
None Run 24:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 77.20
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  0.6049518249928951
None Run 25:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 70.30
Split: 09, Run: 02
None time:  0.9601257361937314
None Run 26:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 74.70
Split: 09, Run: 03
None time:  0.7093214818742126
None Run 27:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 75.60
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.610680169891566
None Run 28:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 63.00
Split: 10, Run: 02
None time:  0.7590209478512406
None Run 29:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 65.80
Split: 10, Run: 03
None time:  0.7630714781116694
None Run 30:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 64.20
run time now: 2.177093982696533
total time:  22.408784052124247
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 70.09 ± 5.91
  Final Train: 99.67 ± 1.02
   Final Test: 69.46 ± 5.09
best run test_acc: 72.5999984741211
[I 2023-06-12 00:25:33,449] Trial 15 finished with value: 70.09333801269531 and parameters: {'Fwd': 1.4535873266009083e-05, 'K': 6, 'alpha': 0.8, 'dropout': 0.2, 'gnnepoch': 50, 'lambda1': 0.35000000000000003, 'lambda2': 8.284425416071771, 'loop': 0, 'loss': 'CE', 'lr': 0.005972758121391701, 'softmaxF': True, 'useGCN': False, 'weight_decay': 0.008090119822750878, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  3
alpha:  0.30000000000000004
lr:  0.004229235002046817
weight_decay:  0.010969700962092144
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.2356976019218564
None Run 01:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 72.20
Split: 01, Run: 02
None time:  1.070488107856363
None Run 02:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.60
Split: 01, Run: 03
None time:  1.0756676539313048
None Run 03:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 69.30
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.9441461830865592
None Run 04:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 68.40
Split: 02, Run: 02
None time:  1.0790221891365945
None Run 05:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 68.70
Split: 02, Run: 03
None time:  1.0660730469971895
None Run 06:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 67.10
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1693211370147765
None Run 07:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 71.10
Split: 03, Run: 02
None time:  1.0825521780643612
None Run 08:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 71.40
Split: 03, Run: 03
None time:  1.1200940520502627
None Run 09:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 68.30
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.0957040179055184
None Run 10:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 62.40
Split: 04, Run: 02
None time:  1.0611593739595264
None Run 11:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 61.90
Split: 04, Run: 03
None time:  1.4831873041111976
None Run 12:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 80.00
   Final Test: 62.90
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.1354939029552042
None Run 13:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 67.20
Split: 05, Run: 02
None time:  1.0979247081559151
None Run 14:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 74.60
Split: 05, Run: 03
None time:  1.0663405100349337
None Run 15:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 73.40
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.2197960468474776
None Run 16:
Highest Train: 100.00
Highest Valid: 82.20
  Final Train: 100.00
   Final Test: 76.70
Split: 06, Run: 02
None time:  1.218544509029016
None Run 17:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 86.67
   Final Test: 71.20
Split: 06, Run: 03
None time:  1.3361432468518615
None Run 18:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 83.33
   Final Test: 70.10
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.08414487214759
None Run 19:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 72.20
Split: 07, Run: 02
None time:  1.1619168159086257
None Run 20:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 69.60
Split: 07, Run: 03
None time:  1.271113283932209
None Run 21:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 80.00
   Final Test: 70.50
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.1670392660889775
None Run 22:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 74.10
Split: 08, Run: 02
None time:  1.1666625891812146
None Run 23:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 78.30
Split: 08, Run: 03
None time:  1.1153239358682185
None Run 24:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 78.20
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.2177590930368751
None Run 25:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 69.80
Split: 09, Run: 02
None time:  0.9849451680202037
None Run 26:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 69.70
Split: 09, Run: 03
None time:  1.1552918679080904
None Run 27:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 68.10
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.30000000000000004)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.089323575841263
None Run 28:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 70.20
Split: 10, Run: 02
None time:  1.1091332610230893
None Run 29:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 67.20
Split: 10, Run: 03
None time:  1.118170578032732
None Run 30:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 64.70
run time now: 3.3545942306518555
total time:  35.28123353491537
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 71.13 ± 4.39
  Final Train: 97.67 ± 6.14
   Final Test: 70.04 ± 4.09
best run test_acc: 71.69999694824219
[I 2023-06-12 00:26:09,236] Trial 16 finished with value: 71.13333129882812 and parameters: {'Fwd': 0.0002512646981362962, 'K': 3, 'alpha': 0.30000000000000004, 'dropout': 0.2, 'gnnepoch': 100, 'lambda1': 0.15000000000000002, 'lambda2': 5.0231877707861585, 'loop': 1, 'loss': 'CE', 'lr': 0.004229235002046817, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.010969700962092144, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  4
alpha:  0.55
lr:  0.0013316467790122925
weight_decay:  0.029117839485979947
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.015910041052848
None Run 01:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 68.40
Split: 01, Run: 02
None time:  1.2121647419407964
None Run 02:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 70.60
Split: 01, Run: 03
None time:  1.2581102028489113
None Run 03:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 67.30
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.0855783859733492
None Run 04:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 72.70
Split: 02, Run: 02
None time:  0.9480299120768905
None Run 05:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 73.50
Split: 02, Run: 03
None time:  1.1015334338881075
None Run 06:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 96.67
   Final Test: 71.70
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.0866427992004901
None Run 07:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 69.50
Split: 03, Run: 02
None time:  1.1675598348956555
None Run 08:
Highest Train: 100.00
Highest Valid: 61.20
  Final Train: 100.00
   Final Test: 64.80
Split: 03, Run: 03
None time:  0.9769263910129666
None Run 09:
Highest Train: 100.00
Highest Valid: 61.40
  Final Train: 100.00
   Final Test: 62.70
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.9343530419282615
None Run 10:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 64.20
Split: 04, Run: 02
None time:  1.0726520840544254
None Run 11:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 64.60
Split: 04, Run: 03
None time:  1.2223886030260473
None Run 12:
Highest Train: 100.00
Highest Valid: 63.00
  Final Train: 100.00
   Final Test: 64.50
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.1920176181010902
None Run 13:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 96.67
   Final Test: 74.80
Split: 05, Run: 02
None time:  1.051065379055217
None Run 14:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 71.90
Split: 05, Run: 03
None time:  0.953643892891705
None Run 15:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 69.60
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.957634316990152
None Run 16:
Highest Train: 100.00
Highest Valid: 80.60
  Final Train: 100.00
   Final Test: 75.90
Split: 06, Run: 02
None time:  1.1088464669883251
None Run 17:
Highest Train: 100.00
Highest Valid: 79.40
  Final Train: 100.00
   Final Test: 73.30
Split: 06, Run: 03
None time:  1.1074925570283085
None Run 18:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 72.60
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.1243596619460732
None Run 19:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 72.20
Split: 07, Run: 02
None time:  1.1561588819604367
None Run 20:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 71.30
Split: 07, Run: 03
None time:  1.186617871047929
None Run 21:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 70.80
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.1866236990317702
None Run 22:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 77.00
Split: 08, Run: 02
None time:  1.1300832459237427
None Run 23:
Highest Train: 100.00
Highest Valid: 79.60
  Final Train: 100.00
   Final Test: 77.90
Split: 08, Run: 03
None time:  1.10297422693111
None Run 24:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 76.90
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.066594781121239
None Run 25:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 77.00
Split: 09, Run: 02
None time:  1.2524718509521335
None Run 26:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 76.20
Split: 09, Run: 03
None time:  1.3219522358849645
None Run 27:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 76.90
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.1214559969957918
None Run 28:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 69.90
Split: 10, Run: 02
None time:  1.1430942909792066
None Run 29:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 71.60
Split: 10, Run: 03
None time:  1.132651095977053
None Run 30:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 70.60
run time now: 3.4396069049835205
total time:  34.50854246504605
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.21 ± 5.80
  Final Train: 99.78 ± 0.85
   Final Test: 71.36 ± 4.29
best run test_acc: 72.760009765625
[I 2023-06-12 00:26:44,195] Trial 17 finished with value: 72.21334075927734 and parameters: {'Fwd': 1.4794428362821942e-05, 'K': 4, 'alpha': 0.55, 'dropout': 0.0, 'gnnepoch': 100, 'lambda1': 0.8, 'lambda2': 6.494208074143491, 'loop': 0, 'loss': 'CE', 'lr': 0.0013316467790122925, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.029117839485979947, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  1.0
lr:  0.009009949489803
weight_decay:  0.0032247961233221423
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.9946110369637609
None Run 01:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 74.70
Split: 01, Run: 02
None time:  0.9056580478791147
None Run 02:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 73.50
Split: 01, Run: 03
None time:  1.0012091540265828
None Run 03:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 71.70
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.8233356410637498
None Run 04:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 70.90
Split: 02, Run: 02
None time:  0.978506081039086
None Run 05:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 75.60
Split: 02, Run: 03
None time:  0.9863650570623577
None Run 06:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 77.50
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.9042483160737902
None Run 07:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 66.70
Split: 03, Run: 02
None time:  0.9424264701083302
None Run 08:
Highest Train: 100.00
Highest Valid: 59.80
  Final Train: 100.00
   Final Test: 62.60
Split: 03, Run: 03
None time:  0.9120888630859554
None Run 09:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 68.20
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.9462834880687296
None Run 10:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 66.60
Split: 04, Run: 02
None time:  0.9403157201595604
None Run 11:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 65.50
Split: 04, Run: 03
None time:  1.9127715930808336
None Run 12:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 67.70
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.9153760971967131
None Run 13:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 69.80
Split: 05, Run: 02
None time:  0.8357697569299489
None Run 14:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 74.40
Split: 05, Run: 03
None time:  0.8706581648439169
None Run 15:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 76.50
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.9676293570082635
None Run 16:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 64.30
Split: 06, Run: 02
None time:  0.8317743949592113
None Run 17:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 67.20
Split: 06, Run: 03
None time:  0.8348828570451587
None Run 18:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 64.40
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.9410401799250394
None Run 19:
Highest Train: 100.00
Highest Valid: 67.40
  Final Train: 100.00
   Final Test: 69.40
Split: 07, Run: 02
None time:  1.0654819840565324
None Run 20:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 75.50
Split: 07, Run: 03
None time:  0.8975409169215709
None Run 21:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 74.30
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.8140083029866219
None Run 22:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 71.50
Split: 08, Run: 02
None time:  0.8604549199808389
None Run 23:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.50
Split: 08, Run: 03
None time:  0.9343418509233743
None Run 24:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 73.30
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  0.969144755974412
None Run 25:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 71.10
Split: 09, Run: 02
None time:  1.0593033288605511
None Run 26:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 100.00
   Final Test: 78.20
Split: 09, Run: 03
None time:  0.9476390650961548
None Run 27:
Highest Train: 100.00
Highest Valid: 78.80
  Final Train: 100.00
   Final Test: 77.40
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.94013203214854
None Run 28:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 68.00
Split: 10, Run: 02
None time:  0.8828289739321917
None Run 29:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 67.20
Split: 10, Run: 03
None time:  0.9956360580399632
None Run 30:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 70.30
run time now: 2.8667824268341064
total time:  29.8449790191371
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 71.38 ± 3.99
  Final Train: 100.00 ± 0.00
   Final Test: 70.85 ± 4.33
best run test_acc: 72.91000366210938
[I 2023-06-12 00:27:14,571] Trial 18 finished with value: 71.3800048828125 and parameters: {'Fwd': 1.2323661053688886e-06, 'K': 7, 'alpha': 1.0, 'dropout': 0.1, 'gnnepoch': 60, 'lambda1': 0.4, 'lambda2': 8.931922327364926, 'loop': 1, 'loss': 'MSE', 'lr': 0.009009949489803, 'softmaxF': True, 'useGCN': False, 'weight_decay': 0.0032247961233221423, 'weightedloss': True}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  2
alpha:  0.8500000000000001
lr:  0.00010012301164626395
weight_decay:  0.0027619290188955117
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.9042929371353239
None Run 01:
Highest Train: 100.00
Highest Valid: 50.00
  Final Train: 100.00
   Final Test: 47.60
Split: 01, Run: 02
None time:  1.8310865350067616
None Run 02:
Highest Train: 100.00
Highest Valid: 41.40
  Final Train: 100.00
   Final Test: 40.20
Split: 01, Run: 03
None time:  1.8770625081378967
None Run 03:
Highest Train: 100.00
Highest Valid: 52.40
  Final Train: 100.00
   Final Test: 51.40
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.9743769830092788
None Run 04:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 62.70
Split: 02, Run: 02
None time:  1.8249355081934482
None Run 05:
Highest Train: 100.00
Highest Valid: 57.80
  Final Train: 100.00
   Final Test: 57.50
Split: 02, Run: 03
None time:  1.9693383569829166
None Run 06:
Highest Train: 100.00
Highest Valid: 62.40
  Final Train: 100.00
   Final Test: 62.80
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.9176737158559263
None Run 07:
Highest Train: 100.00
Highest Valid: 53.40
  Final Train: 100.00
   Final Test: 54.00
Split: 03, Run: 02
None time:  1.9373272999655455
None Run 08:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 64.70
Split: 03, Run: 03
None time:  1.8662047639954835
None Run 09:
Highest Train: 100.00
Highest Valid: 55.40
  Final Train: 100.00
   Final Test: 56.30
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.7336350509431213
None Run 10:
Highest Train: 100.00
Highest Valid: 61.60
  Final Train: 100.00
   Final Test: 60.60
Split: 04, Run: 02
None time:  2.1520627511199564
None Run 11:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 63.90
Split: 04, Run: 03
None time:  2.1490660079289228
None Run 12:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 61.70
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.887940133921802
None Run 13:
Highest Train: 100.00
Highest Valid: 57.20
  Final Train: 100.00
   Final Test: 61.40
Split: 05, Run: 02
None time:  1.9033490689471364
None Run 14:
Highest Train: 100.00
Highest Valid: 48.00
  Final Train: 100.00
   Final Test: 52.90
Split: 05, Run: 03
None time:  1.8224791418761015
None Run 15:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 69.10
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.8642813109327108
None Run 16:
Highest Train: 100.00
Highest Valid: 57.40
  Final Train: 100.00
   Final Test: 58.00
Split: 06, Run: 02
None time:  1.862226580036804
None Run 17:
Highest Train: 100.00
Highest Valid: 52.40
  Final Train: 100.00
   Final Test: 54.60
Split: 06, Run: 03
None time:  1.8955989570822567
None Run 18:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 60.90
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.013871771050617
None Run 19:
Highest Train: 100.00
Highest Valid: 62.20
  Final Train: 100.00
   Final Test: 63.20
Split: 07, Run: 02
None time:  1.9644418158568442
None Run 20:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 69.30
Split: 07, Run: 03
None time:  2.094247557921335
None Run 21:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 68.00
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.8123507760465145
None Run 22:
Highest Train: 100.00
Highest Valid: 51.00
  Final Train: 100.00
   Final Test: 57.10
Split: 08, Run: 02
None time:  1.875183027004823
None Run 23:
Highest Train: 100.00
Highest Valid: 50.60
  Final Train: 100.00
   Final Test: 56.80
Split: 08, Run: 03
None time:  1.8984733279794455
None Run 24:
Highest Train: 100.00
Highest Valid: 42.20
  Final Train: 100.00
   Final Test: 46.40
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.149693506071344
None Run 25:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 68.60
Split: 09, Run: 02
None time:  1.9902431729715317
None Run 26:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 71.10
Split: 09, Run: 03
None time:  2.1499179378151894
None Run 27:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 73.80
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.9146572148893028
None Run 28:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 65.70
Split: 10, Run: 02
None time:  2.106304784072563
None Run 29:
Highest Train: 100.00
Highest Valid: 61.00
  Final Train: 100.00
   Final Test: 59.80
Split: 10, Run: 03
None time:  1.833990105893463
None Run 30:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 56.90
run time now: 5.952544689178467
total time:  59.361412627156824
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 59.68 ± 8.87
  Final Train: 100.00 ± 0.00
   Final Test: 59.90 ± 7.64
best run test_acc: 63.8699951171875
[I 2023-06-12 00:28:14,483] Trial 19 finished with value: 59.68000030517578 and parameters: {'Fwd': 0.00018336290317703686, 'K': 2, 'alpha': 0.8500000000000001, 'dropout': 0.30000000000000004, 'gnnepoch': 90, 'lambda1': 0.55, 'lambda2': 7.7699252465909865, 'loop': 1, 'loss': 'CE', 'lr': 0.00010012301164626395, 'softmaxF': False, 'useGCN': True, 'weight_decay': 0.0027619290188955117, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  4
alpha:  0.45
lr:  0.0006526921000370464
weight_decay:  0.029852824653945252
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.7517655200790614
None Run 01:
Highest Train: 100.00
Highest Valid: 55.20
  Final Train: 100.00
   Final Test: 54.80
Split: 01, Run: 02
None time:  0.777392664924264
None Run 02:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 60.20
Split: 01, Run: 03
None time:  0.7510180699173361
None Run 03:
Highest Train: 100.00
Highest Valid: 55.20
  Final Train: 100.00
   Final Test: 54.80
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.0293554170057178
None Run 04:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 68.20
Split: 02, Run: 02
None time:  1.1565254989545792
None Run 05:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 66.90
Split: 02, Run: 03
None time:  0.8710269550792873
None Run 06:
Highest Train: 100.00
Highest Valid: 67.40
  Final Train: 100.00
   Final Test: 69.50
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.7403410919941962
None Run 07:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 65.60
Split: 03, Run: 02
None time:  0.7654412118718028
None Run 08:
Highest Train: 100.00
Highest Valid: 57.60
  Final Train: 100.00
   Final Test: 58.90
Split: 03, Run: 03
None time:  0.7351690379437059
None Run 09:
Highest Train: 100.00
Highest Valid: 55.80
  Final Train: 100.00
   Final Test: 58.70
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.9986862931400537
None Run 10:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 67.30
Split: 04, Run: 02
None time:  0.9788888818584383
None Run 11:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 66.20
Split: 04, Run: 03
None time:  1.067956251790747
None Run 12:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 64.30
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.700675006955862
None Run 13:
Highest Train: 100.00
Highest Valid: 53.20
  Final Train: 100.00
   Final Test: 58.60
Split: 05, Run: 02
None time:  0.7541456229519099
None Run 14:
Highest Train: 100.00
Highest Valid: 62.00
  Final Train: 100.00
   Final Test: 66.70
Split: 05, Run: 03
None time:  0.752964996965602
None Run 15:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 68.80
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.7505394329782575
None Run 16:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 75.80
Split: 06, Run: 02
None time:  0.7285096920095384
None Run 17:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 72.70
Split: 06, Run: 03
None time:  0.7781947311013937
None Run 18:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 65.80
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.9484182139858603
None Run 19:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 64.90
Split: 07, Run: 02
None time:  0.8325929951388389
None Run 20:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 71.00
Split: 07, Run: 03
None time:  0.8831669869832695
None Run 21:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 71.60
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.7148048470262438
None Run 22:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 63.60
Split: 08, Run: 02
None time:  0.9020307308528572
None Run 23:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 74.70
Split: 08, Run: 03
None time:  0.7057035930920392
None Run 24:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 63.60
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  0.7727855651173741
None Run 25:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 71.40
Split: 09, Run: 02
None time:  0.7398595320992172
None Run 26:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 63.30
Split: 09, Run: 03
None time:  0.820085815154016
None Run 27:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 71.90
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.45)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.7320765499025583
None Run 28:
Highest Train: 100.00
Highest Valid: 57.40
  Final Train: 100.00
   Final Test: 56.20
Split: 10, Run: 02
None time:  0.7740639040712267
None Run 29:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 66.80
Split: 10, Run: 03
None time:  0.7475820810068399
None Run 30:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 66.10
run time now: 2.292374610900879
total time:  25.668244249885902
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 66.31 ± 6.80
  Final Train: 100.00 ± 0.00
   Final Test: 65.63 ± 5.64
best run test_acc: 69.2199935913086
[I 2023-06-12 00:28:40,678] Trial 20 finished with value: 66.3133316040039 and parameters: {'Fwd': 2.498920645221658e-05, 'K': 4, 'alpha': 0.45, 'dropout': 0.30000000000000004, 'gnnepoch': 30, 'lambda1': 0.2, 'lambda2': 8.70677687621569, 'loop': 0, 'loss': 'CE', 'lr': 0.0006526921000370464, 'softmaxF': False, 'useGCN': True, 'weight_decay': 0.029852824653945252, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.9
lr:  0.002423949409100157
weight_decay:  1.234004937840718e-06
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.4120225000660866
None Run 01:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 63.10
Split: 01, Run: 02
None time:  1.5150512419641018
None Run 02:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 73.50
Split: 01, Run: 03
None time:  1.361571772955358
None Run 03:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 69.40
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.3460948241408914
None Run 04:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
Split: 02, Run: 02
None time:  1.4022155199199915
None Run 05:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
Split: 02, Run: 03
None time:  1.2870512339286506
None Run 06:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.4171771598048508
None Run 07:
Highest Train: 100.00
Highest Valid: 62.20
  Final Train: 100.00
   Final Test: 67.30
Split: 03, Run: 02
None time:  1.4005033450666815
None Run 08:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 72.00
Split: 03, Run: 03
None time:  1.3683697010856122
None Run 09:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 71.50
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.460166723933071
None Run 10:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 65.20
Split: 04, Run: 02
None time:  2.024937361944467
None Run 11:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 76.67
   Final Test: 63.60
Split: 04, Run: 03
None time:  1.7020442239008844
None Run 12:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 76.67
   Final Test: 60.70
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.374142942018807
None Run 13:
Highest Train: 100.00
Highest Valid: 62.20
  Final Train: 100.00
   Final Test: 66.80
Split: 05, Run: 02
None time:  1.4508418070618063
None Run 14:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 76.10
Split: 05, Run: 03
None time:  1.4840952679514885
None Run 15:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 86.67
   Final Test: 74.40
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.4503576098941267
None Run 16:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 75.50
Split: 06, Run: 02
None time:  1.4272757379803807
None Run 17:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 71.00
Split: 06, Run: 03
None time:  1.6590477540157735
None Run 18:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 66.67
   Final Test: 69.10
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.3448285430204123
None Run 19:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 75.10
Split: 07, Run: 02
None time:  1.4323364330921322
None Run 20:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 72.80
Split: 07, Run: 03
None time:  1.4435974119696766
None Run 21:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 72.60
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.4383022938854992
None Run 22:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 74.60
Split: 08, Run: 02
None time:  1.3461243251804262
None Run 23:
Highest Train: 100.00
Highest Valid: 80.40
  Final Train: 100.00
   Final Test: 79.50
Split: 08, Run: 03
None time:  1.2717053811065853
None Run 24:
Highest Train: 100.00
Highest Valid: 79.80
  Final Train: 100.00
   Final Test: 79.00
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.4008117481134832
None Run 25:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 70.00
Split: 09, Run: 02
None time:  1.456891173031181
None Run 26:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 78.70
Split: 09, Run: 03
None time:  1.3757385211065412
None Run 27:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 78.00
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.4807482338510454
None Run 28:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 70.00
Split: 10, Run: 02
None time:  1.3489902110304683
None Run 29:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 63.50
Split: 10, Run: 03
None time:  1.5977050431538373
None Run 30:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 86.67
   Final Test: 61.40
run time now: 4.472471475601196
total time:  44.6873115291819
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.14 ± 5.05
  Final Train: 96.44 ± 8.66
   Final Test: 70.88 ± 5.22
best run test_acc: 73.62999725341797
[I 2023-06-12 00:29:25,908] Trial 21 finished with value: 72.13999938964844 and parameters: {'Fwd': 9.984483864441665e-05, 'K': 6, 'alpha': 0.9, 'dropout': 0.0, 'gnnepoch': 120, 'lambda1': 0.65, 'lambda2': 9.316581484869225, 'loop': 2, 'loss': 'CE', 'lr': 0.002423949409100157, 'softmaxF': False, 'useGCN': False, 'weight_decay': 1.234004937840718e-06, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  1.0
lr:  0.00505368188565323
weight_decay:  5.3803583462485005e-06
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.5203194189816713
None Run 01:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 96.67
   Final Test: 77.80
Split: 01, Run: 02
None time:  1.4564451230689883
None Run 02:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 78.60
Split: 01, Run: 03
None time:  1.5093809959944338
None Run 03:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 86.67
   Final Test: 77.50
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.3810645788908005
None Run 04:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.10
Split: 02, Run: 02
None time:  1.433834683150053
None Run 05:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 96.67
   Final Test: 74.30
Split: 02, Run: 03
None time:  1.4111310541629791
None Run 06:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.10
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.560096793109551
None Run 07:
Highest Train: 100.00
Highest Valid: 59.60
  Final Train: 100.00
   Final Test: 65.00
Split: 03, Run: 02
None time:  1.4359198960009962
None Run 08:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 96.67
   Final Test: 66.80
Split: 03, Run: 03
None time:  1.4182555549778044
None Run 09:
Highest Train: 100.00
Highest Valid: 61.40
  Final Train: 100.00
   Final Test: 65.20
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.3715715380385518
None Run 10:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 63.50
Split: 04, Run: 02
None time:  1.360515157924965
None Run 11:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 63.50
Split: 04, Run: 03
None time:  1.4995852999854833
None Run 12:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 61.00
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.4206270810682327
None Run 13:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 72.40
Split: 05, Run: 02
None time:  1.2891178210265934
None Run 14:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 77.30
Split: 05, Run: 03
None time:  1.4288966378662735
None Run 15:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 77.30
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.5048693239223212
None Run 16:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 71.20
Split: 06, Run: 02
None time:  1.9447489599697292
None Run 17:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 73.33
   Final Test: 69.40
Split: 06, Run: 03
None time:  1.806024155812338
None Run 18:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 70.00
   Final Test: 69.30
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.4978773039765656
None Run 19:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 74.60
Split: 07, Run: 02
None time:  1.3920508730225265
None Run 20:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 72.30
Split: 07, Run: 03
None time:  1.3960308670066297
None Run 21:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 73.00
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.423610782949254
None Run 22:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 72.20
Split: 08, Run: 02
None time:  1.4682751200161874
None Run 23:
Highest Train: 100.00
Highest Valid: 79.60
  Final Train: 100.00
   Final Test: 78.50
Split: 08, Run: 03
None time:  1.4807329019531608
None Run 24:
Highest Train: 100.00
Highest Valid: 79.20
  Final Train: 96.67
   Final Test: 76.90
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.3898449619300663
None Run 25:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 74.10
Split: 09, Run: 02
None time:  1.4943483069073409
None Run 26:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 96.67
   Final Test: 77.70
Split: 09, Run: 03
None time:  1.4049673080444336
None Run 27:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 77.70
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.5364770300220698
None Run 28:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 70.00
Split: 10, Run: 02
None time:  1.6680603919085115
None Run 29:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 80.00
   Final Test: 68.50
Split: 10, Run: 03
None time:  1.5762017858214676
None Run 30:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 80.00
   Final Test: 68.80
run time now: 4.8251214027404785
total time:  45.6328249478247
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.69 ± 5.64
  Final Train: 95.78 ± 8.53
   Final Test: 71.89 ± 5.06
best run test_acc: 73.25
[I 2023-06-12 00:30:11,957] Trial 22 finished with value: 72.6866683959961 and parameters: {'Fwd': 7.84329366007724e-05, 'K': 7, 'alpha': 1.0, 'dropout': 0.0, 'gnnepoch': 120, 'lambda1': 0.75, 'lambda2': 9.118336719525256, 'loop': 2, 'loss': 'CE', 'lr': 0.00505368188565323, 'softmaxF': False, 'useGCN': False, 'weight_decay': 5.3803583462485005e-06, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  5
alpha:  0.75
lr:  0.003994677420235804
weight_decay:  0.00304796284113328
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.35939423693344
None Run 01:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 67.40
Split: 01, Run: 02
None time:  1.4902563709765673
None Run 02:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 68.50
Split: 01, Run: 03
None time:  1.3666599800344557
None Run 03:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 66.20
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.3607986948918551
None Run 04:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 70.30
Split: 02, Run: 02
None time:  1.247777777025476
None Run 05:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 69.60
Split: 02, Run: 03
None time:  1.3320547270122916
None Run 06:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 69.60
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.350081583019346
None Run 07:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 69.20
Split: 03, Run: 02
None time:  1.3506068880669773
None Run 08:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 71.40
Split: 03, Run: 03
None time:  1.3679032269865274
None Run 09:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 70.90
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.3461638018488884
None Run 10:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 62.50
Split: 04, Run: 02
None time:  1.7461574368644506
None Run 11:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 80.00
   Final Test: 60.60
Split: 04, Run: 03
None time:  1.6910742949694395
None Run 12:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 80.00
   Final Test: 59.20
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.435456276871264
None Run 13:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 69.90
Split: 05, Run: 02
None time:  1.3410933210980147
None Run 14:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 72.10
Split: 05, Run: 03
None time:  1.40586735191755
None Run 15:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 80.00
   Final Test: 70.40
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.1668531789910048
None Run 16:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 75.30
Split: 06, Run: 02
None time:  1.548848130973056
None Run 17:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 73.33
   Final Test: 70.20
Split: 06, Run: 03
None time:  2.6140061551705003
None Run 18:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 70.00
   Final Test: 70.10
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.3725619800388813
None Run 19:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 72.90
Split: 07, Run: 02
None time:  1.4008705359883606
None Run 20:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 70.30
Split: 07, Run: 03
None time:  1.889803463127464
None Run 21:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 70.00
   Final Test: 70.80
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.4199544228613377
None Run 22:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 75.00
Split: 08, Run: 02
None time:  1.3280903468839824
None Run 23:
Highest Train: 100.00
Highest Valid: 80.60
  Final Train: 100.00
   Final Test: 79.50
Split: 08, Run: 03
None time:  1.4199898559600115
None Run 24:
Highest Train: 100.00
Highest Valid: 80.60
  Final Train: 96.67
   Final Test: 79.60
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.3763543511740863
None Run 25:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 74.10
Split: 09, Run: 02
None time:  1.3536961949430406
None Run 26:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 72.20
Split: 09, Run: 03
None time:  1.4157142718322575
None Run 27:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 68.00
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.3708386039361358
None Run 28:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 69.30
Split: 10, Run: 02
None time:  1.4404248259961605
None Run 29:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 96.67
   Final Test: 62.90
Split: 10, Run: 03
None time:  1.4425480540376157
None Run 30:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 90.00
   Final Test: 62.70
run time now: 4.30299711227417
total time:  44.76843635295518
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 71.19 ± 4.38
  Final Train: 94.56 ± 10.08
   Final Test: 69.69 ± 4.79
best run test_acc: 71.5999984741211
[I 2023-06-12 00:30:57,170] Trial 23 finished with value: 71.19332885742188 and parameters: {'Fwd': 6.796096066643272e-06, 'K': 5, 'alpha': 0.75, 'dropout': 0.1, 'gnnepoch': 110, 'lambda1': 0.8500000000000001, 'lambda2': 7.990966198616691, 'loop': 2, 'loss': 'CE', 'lr': 0.003994677420235804, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.00304796284113328, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.9
lr:  0.002086744212674361
weight_decay:  0.00016296131096182214
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.2376894180197269
None Run 01:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 67.80
Split: 01, Run: 02
None time:  1.450412668986246
None Run 02:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 96.67
   Final Test: 77.00
Split: 01, Run: 03
None time:  1.2500906509812921
None Run 03:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 96.67
   Final Test: 75.40
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.1130968781653792
None Run 04:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
Split: 02, Run: 02
None time:  1.1562015910167247
None Run 05:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 72.80
Split: 02, Run: 03
None time:  1.0291659571230412
None Run 06:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.2183838880155236
None Run 07:
Highest Train: 100.00
Highest Valid: 59.80
  Final Train: 100.00
   Final Test: 66.20
Split: 03, Run: 02
None time:  1.1168001140467823
None Run 08:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 69.00
Split: 03, Run: 03
None time:  1.2441192879341543
None Run 09:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 69.10
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.196107038995251
None Run 10:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 64.80
Split: 04, Run: 02
None time:  1.3366496900562197
None Run 11:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 90.00
   Final Test: 65.70
Split: 04, Run: 03
None time:  1.4033149150200188
None Run 12:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 86.67
   Final Test: 60.80
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.181010764092207
None Run 13:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 67.70
Split: 05, Run: 02
None time:  1.3357599820010364
None Run 14:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 77.40
Split: 05, Run: 03
None time:  1.2336697250138968
None Run 15:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 93.33
   Final Test: 75.00
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.1919554288033396
None Run 16:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 74.40
Split: 06, Run: 02
None time:  1.260316994972527
None Run 17:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 72.90
Split: 06, Run: 03
None time:  1.177307837177068
None Run 18:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 72.20
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.2171362889930606
None Run 19:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 75.80
Split: 07, Run: 02
None time:  1.2280992318410426
None Run 20:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 72.20
Split: 07, Run: 03
None time:  1.1889315731823444
None Run 21:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 72.10
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.1867086819838732
None Run 22:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 71.40
Split: 08, Run: 02
None time:  1.2537253939080983
None Run 23:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 96.67
   Final Test: 76.80
Split: 08, Run: 03
None time:  1.1929808228742331
None Run 24:
Highest Train: 100.00
Highest Valid: 79.60
  Final Train: 100.00
   Final Test: 79.60
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.2337409530300647
None Run 25:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 76.20
Split: 09, Run: 02
None time:  1.3269363811705261
None Run 26:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 78.20
Split: 09, Run: 03
None time:  1.2102745061274618
None Run 27:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 78.60
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.2169558750465512
None Run 28:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 68.90
Split: 10, Run: 02
None time:  1.171779187163338
None Run 29:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 66.30
Split: 10, Run: 03
None time:  1.2293502900283784
None Run 30:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 64.40
run time now: 3.676053285598755
total time:  38.00599893881008
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.59 ± 4.94
  Final Train: 98.67 ± 3.23
   Final Test: 71.67 ± 4.85
best run test_acc: 73.92999267578125
[I 2023-06-12 00:31:35,639] Trial 24 finished with value: 72.586669921875 and parameters: {'Fwd': 2.7630929754691976e-05, 'K': 6, 'alpha': 0.9, 'dropout': 0.2, 'gnnepoch': 100, 'lambda1': 0.6000000000000001, 'lambda2': 9.684497574508278, 'loop': 1, 'loss': 'CE', 'lr': 0.002086744212674361, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.00016296131096182214, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.9500000000000001
lr:  0.004240412970698525
weight_decay:  0.0003598410205931258
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.4374187698122114
None Run 01:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 71.80
Split: 01, Run: 02
None time:  1.4028236740268767
None Run 02:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 96.67
   Final Test: 77.40
Split: 01, Run: 03
None time:  1.477334916824475
None Run 03:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 86.67
   Final Test: 71.00
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.332740823039785
None Run 04:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 71.10
Split: 02, Run: 02
None time:  1.3463777739088982
None Run 05:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 71.10
Split: 02, Run: 03
None time:  1.4023696689400822
None Run 06:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 74.00
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.3674458358436823
None Run 07:
Highest Train: 100.00
Highest Valid: 61.40
  Final Train: 100.00
   Final Test: 66.80
Split: 03, Run: 02
None time:  1.6752501840237528
None Run 08:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 83.33
   Final Test: 67.50
Split: 03, Run: 03
None time:  1.334637037012726
None Run 09:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 68.30
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.3302798650693148
None Run 10:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 63.70
Split: 04, Run: 02
None time:  1.5106133830267936
None Run 11:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 86.67
   Final Test: 63.00
Split: 04, Run: 03
None time:  1.4030629468616098
None Run 12:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 83.33
   Final Test: 61.90
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.2654857360757887
None Run 13:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 66.60
Split: 05, Run: 02
None time:  1.3469697281252593
None Run 14:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 76.70
Split: 05, Run: 03
None time:  1.3577252367977053
None Run 15:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 93.33
   Final Test: 76.80
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.4402734129689634
None Run 16:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 70.60
Split: 06, Run: 02
None time:  1.4501901818439364
None Run 17:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 83.33
   Final Test: 71.40
Split: 06, Run: 03
None time:  1.5629326049238443
None Run 18:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 76.67
   Final Test: 71.00
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.30581078492105
None Run 19:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 76.30
Split: 07, Run: 02
None time:  1.3993667250033468
None Run 20:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 96.67
   Final Test: 73.20
Split: 07, Run: 03
None time:  1.3846978419460356
None Run 21:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 96.67
   Final Test: 73.50
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.3562254579737782
None Run 22:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 73.70
Split: 08, Run: 02
None time:  1.355206238804385
None Run 23:
Highest Train: 100.00
Highest Valid: 80.40
  Final Train: 100.00
   Final Test: 79.10
Split: 08, Run: 03
None time:  1.3678617209661752
None Run 24:
Highest Train: 100.00
Highest Valid: 80.80
  Final Train: 100.00
   Final Test: 79.90
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.2934610401280224
None Run 25:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 72.70
Split: 09, Run: 02
None time:  1.3132841559126973
None Run 26:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 96.67
   Final Test: 78.30
Split: 09, Run: 03
None time:  1.4085854128934443
None Run 27:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 79.00
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.3545412321109325
None Run 28:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 69.70
Split: 10, Run: 02
None time:  1.34161776304245
None Run 29:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 96.67
   Final Test: 64.90
Split: 10, Run: 03
None time:  1.2847906851675361
None Run 30:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 63.50
run time now: 4.032255172729492
total time:  42.915447420207784
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.47 ± 5.31
  Final Train: 95.89 ± 6.76
   Final Test: 71.48 ± 5.16
best run test_acc: 73.65000915527344
[I 2023-06-12 00:32:19,089] Trial 25 finished with value: 72.47334289550781 and parameters: {'Fwd': 2.7629157933482172e-05, 'K': 8, 'alpha': 0.9500000000000001, 'dropout': 0.0, 'gnnepoch': 120, 'lambda1': 1.0, 'lambda2': 7.064655176418864, 'loop': 1, 'loss': 'CE', 'lr': 0.004240412970698525, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.0003598410205931258, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  5
alpha:  0.75
lr:  0.0018644329911786366
weight_decay:  0.0011155708551756909
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.0220987340435386
None Run 01:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 67.20
Split: 01, Run: 02
None time:  1.019652480026707
None Run 02:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 93.33
   Final Test: 69.00
Split: 01, Run: 03
None time:  1.0479223758447915
None Run 03:
Highest Train: 100.00
Highest Valid: 67.40
  Final Train: 100.00
   Final Test: 66.10
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.9526791439857334
None Run 04:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 68.90
Split: 02, Run: 02
None time:  0.9960461228620261
None Run 05:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 71.80
Split: 02, Run: 03
None time:  0.9145707739517093
None Run 06:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 69.60
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.0596752888523042
None Run 07:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 68.90
Split: 03, Run: 02
None time:  0.9623684070538729
None Run 08:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 71.30
Split: 03, Run: 03
None time:  0.9206528200302273
None Run 09:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 71.10
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.9790152399800718
None Run 10:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 64.40
Split: 04, Run: 02
None time:  1.252962859114632
None Run 11:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 76.67
   Final Test: 66.40
Split: 04, Run: 03
None time:  1.131407222012058
None Run 12:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 83.33
   Final Test: 62.60
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.4176947018131614
None Run 13:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 86.67
   Final Test: 69.00
Split: 05, Run: 02
None time:  1.0126572658773512
None Run 14:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 75.60
Split: 05, Run: 03
None time:  1.0998802988324314
None Run 15:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 86.67
   Final Test: 73.30
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.0219504351262003
None Run 16:
Highest Train: 100.00
Highest Valid: 83.40
  Final Train: 100.00
   Final Test: 77.50
Split: 06, Run: 02
None time:  0.9003396928310394
None Run 17:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 73.80
Split: 06, Run: 03
None time:  0.9893764869775623
None Run 18:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 71.90
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.9552766310516745
None Run 19:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 72.90
Split: 07, Run: 02
None time:  1.0746696181595325
None Run 20:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 72.20
Split: 07, Run: 03
None time:  1.0364208600949496
None Run 21:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 71.60
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.079591081943363
None Run 22:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 77.10
Split: 08, Run: 02
None time:  1.0486098020337522
None Run 23:
Highest Train: 100.00
Highest Valid: 79.20
  Final Train: 96.67
   Final Test: 78.30
Split: 08, Run: 03
None time:  0.9500684048980474
None Run 24:
Highest Train: 100.00
Highest Valid: 79.80
  Final Train: 100.00
   Final Test: 79.80
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.08355776197277
None Run 25:
Highest Train: 100.00
Highest Valid: 80.00
  Final Train: 100.00
   Final Test: 78.80
Split: 09, Run: 02
None time:  1.1442478660028428
None Run 26:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 96.67
   Final Test: 78.70
Split: 09, Run: 03
None time:  1.1083019489888102
None Run 27:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 78.40
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.9677772622089833
None Run 28:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 66.60
Split: 10, Run: 02
None time:  1.1050749339628965
None Run 29:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 67.10
Split: 10, Run: 03
None time:  0.9760832581669092
None Run 30:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 65.40
run time now: 3.091264009475708
total time:  32.31541007896885
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.72 ± 4.83
  Final Train: 97.33 ± 5.96
   Final Test: 71.51 ± 4.83
best run test_acc: 73.02000427246094
[I 2023-06-12 00:32:51,926] Trial 26 finished with value: 72.72000122070312 and parameters: {'Fwd': 0.0005298159318279826, 'K': 5, 'alpha': 0.75, 'dropout': 0.1, 'gnnepoch': 80, 'lambda1': 0.75, 'lambda2': 8.550050230734584, 'loop': 1, 'loss': 'CE', 'lr': 0.0018644329911786366, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.0011155708551756909, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  4
alpha:  0.7000000000000001
lr:  0.0017873511616985365
weight_decay:  0.0014459001279110845
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.1171046651434153
None Run 01:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 67.10
Split: 01, Run: 02
None time:  1.6261350789573044
None Run 02:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 77.70
Split: 01, Run: 03
None time:  1.7053593299351633
None Run 03:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 76.40
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.156860716175288
None Run 04:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 69.00
Split: 02, Run: 02
None time:  1.0029950188472867
None Run 05:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 68.20
Split: 02, Run: 03
None time:  1.1603314641397446
None Run 06:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 71.70
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1493892350699753
None Run 07:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 66.20
Split: 03, Run: 02
None time:  1.0303746950812638
None Run 08:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 69.00
Split: 03, Run: 03
None time:  0.9791293041780591
None Run 09:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 71.60
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.0444287408608943
None Run 10:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 64.80
Split: 04, Run: 02
None time:  1.0408654329366982
None Run 11:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 61.40
Split: 04, Run: 03
None time:  1.4662000560201705
None Run 12:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 60.70
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.0346200971398503
None Run 13:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 70.50
Split: 05, Run: 02
None time:  1.7955452718306333
None Run 14:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 74.00
Split: 05, Run: 03
None time:  1.1572061381302774
None Run 15:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 72.60
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.1249838001094759
None Run 16:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 67.40
Split: 06, Run: 02
None time:  1.292054692050442
None Run 17:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 70.20
Split: 06, Run: 03
None time:  1.4597194830421358
None Run 18:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 72.90
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.136099134804681
None Run 19:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 73.40
Split: 07, Run: 02
None time:  1.3762862589210272
None Run 20:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 75.90
Split: 07, Run: 03
None time:  1.3276914700400084
None Run 21:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 72.10
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.9561828738078475
None Run 22:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 76.50
Split: 08, Run: 02
None time:  1.1179467781912535
None Run 23:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 75.90
Split: 08, Run: 03
None time:  1.066411211853847
None Run 24:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 76.50
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.1501745879650116
None Run 25:
Highest Train: 100.00
Highest Valid: 67.40
  Final Train: 100.00
   Final Test: 66.10
Split: 09, Run: 02
None time:  0.9578663310967386
None Run 26:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 63.80
Split: 09, Run: 03
None time:  1.3290267689153552
None Run 27:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 73.90
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.9599566129036248
None Run 28:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 66.20
Split: 10, Run: 02
None time:  1.5735607559327036
None Run 29:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 66.50
Split: 10, Run: 03
None time:  1.2491267300210893
None Run 30:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 68.10
run time now: 3.8233280181884766
total time:  37.61313978815451
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 70.43 ± 4.18
  Final Train: 100.00 ± 0.00
   Final Test: 70.21 ± 4.65
best run test_acc: 72.71000671386719
[I 2023-06-12 00:33:29,964] Trial 27 finished with value: 70.43333435058594 and parameters: {'Fwd': 0.0006513133977606333, 'K': 4, 'alpha': 0.7000000000000001, 'dropout': 0.1, 'gnnepoch': 80, 'lambda1': 0.30000000000000004, 'lambda2': 8.42507165005848, 'loop': 1, 'loss': 'MSE', 'lr': 0.0017873511616985365, 'softmaxF': True, 'useGCN': False, 'weight_decay': 0.0014459001279110845, 'weightedloss': True}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  5
alpha:  0.8
lr:  0.00109805774004392
weight_decay:  0.0060964673494113076
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.5242287530563772
None Run 01:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 67.10
Split: 01, Run: 02
None time:  1.559538384899497
None Run 02:
Highest Train: 100.00
Highest Valid: 61.80
  Final Train: 100.00
   Final Test: 59.40
Split: 01, Run: 03
None time:  1.5891910940408707
None Run 03:
Highest Train: 100.00
Highest Valid: 59.00
  Final Train: 100.00
   Final Test: 62.60
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.565587910125032
None Run 04:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 69.60
Split: 02, Run: 02
None time:  1.529308256926015
None Run 05:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 69.60
Split: 02, Run: 03
None time:  1.5263644789811224
None Run 06:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 69.60
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.5519436281174421
None Run 07:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 62.70
Split: 03, Run: 02
None time:  1.56991770491004
None Run 08:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 67.40
Split: 03, Run: 03
None time:  1.531461195088923
None Run 09:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 69.00
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.746349659981206
None Run 10:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 66.10
Split: 04, Run: 02
None time:  1.842335306107998
None Run 11:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 65.50
Split: 04, Run: 03
None time:  2.008285884046927
None Run 12:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 63.20
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.6174429091624916
None Run 13:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 71.80
Split: 05, Run: 02
None time:  1.720201389864087
None Run 14:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 74.90
Split: 05, Run: 03
None time:  1.666849517961964
None Run 15:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 70.80
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.56566694797948
None Run 16:
Highest Train: 100.00
Highest Valid: 83.40
  Final Train: 100.00
   Final Test: 76.80
Split: 06, Run: 02
None time:  1.594897367991507
None Run 17:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 74.70
Split: 06, Run: 03
None time:  1.6019969410263002
None Run 18:
Highest Train: 100.00
Highest Valid: 82.20
  Final Train: 100.00
   Final Test: 76.30
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.724143193103373
None Run 19:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 71.20
Split: 07, Run: 02
None time:  1.7526512660551816
None Run 20:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 70.10
Split: 07, Run: 03
None time:  1.7088927230797708
None Run 21:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 70.50
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.7700212630443275
None Run 22:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 76.90
Split: 08, Run: 02
None time:  1.6144381000194699
None Run 23:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 76.30
Split: 08, Run: 03
None time:  1.8175734700635076
None Run 24:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 74.60
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.5748983279336244
None Run 25:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 75.20
Split: 09, Run: 02
None time:  1.5758454829920083
None Run 26:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 75.00
Split: 09, Run: 03
None time:  1.586730849929154
None Run 27:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 100.00
   Final Test: 75.30
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.550790652167052
None Run 28:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 66.50
Split: 10, Run: 02
None time:  1.5782619849778712
None Run 29:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 65.50
Split: 10, Run: 03
None time:  1.5490397189278156
None Run 30:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 68.10
run time now: 4.720346689224243
total time:  50.20633032801561
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 70.79 ± 5.92
  Final Train: 100.00 ± 0.00
   Final Test: 70.08 ± 4.85
best run test_acc: 71.50000762939453
[I 2023-06-12 00:34:20,675] Trial 28 finished with value: 70.78665924072266 and parameters: {'Fwd': 0.0001503025117986324, 'K': 5, 'alpha': 0.8, 'dropout': 0.30000000000000004, 'gnnepoch': 80, 'lambda1': 0.8, 'lambda2': 7.416184633618403, 'loop': 0, 'loss': 'CE', 'lr': 0.00109805774004392, 'softmaxF': False, 'useGCN': True, 'weight_decay': 0.0060964673494113076, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  2
alpha:  0.65
lr:  0.0005924079949415408
weight_decay:  0.021485040053950896
dropout:  0.6000000000000001
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.3710193189326674
None Run 01:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 55.70
Split: 01, Run: 02
None time:  1.5762018009554595
None Run 02:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 73.60
Split: 01, Run: 03
None time:  1.376646873075515
None Run 03:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 65.90
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.3860326160211116
None Run 04:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 71.60
Split: 02, Run: 02
None time:  1.3660617931745946
None Run 05:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 70.00
Split: 02, Run: 03
None time:  1.396587808150798
None Run 06:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 67.70
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.4435408930294216
None Run 07:
Highest Train: 100.00
Highest Valid: 61.60
  Final Train: 100.00
   Final Test: 64.70
Split: 03, Run: 02
None time:  1.3727676768321544
None Run 08:
Highest Train: 100.00
Highest Valid: 60.00
  Final Train: 100.00
   Final Test: 62.30
Split: 03, Run: 03
None time:  1.4071602940093726
None Run 09:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 67.30
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.6305895370896906
None Run 10:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 62.90
Split: 04, Run: 02
None time:  1.4001157598104328
None Run 11:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 64.90
Split: 04, Run: 03
None time:  1.5843798539135605
None Run 12:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 62.10
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.475898265838623
None Run 13:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 68.80
Split: 05, Run: 02
None time:  1.47303523006849
None Run 14:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 68.20
Split: 05, Run: 03
None time:  1.6098368749953806
None Run 15:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 76.20
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.377879821928218
None Run 16:
Highest Train: 100.00
Highest Valid: 80.80
  Final Train: 100.00
   Final Test: 77.10
Split: 06, Run: 02
None time:  1.452285282080993
None Run 17:
Highest Train: 100.00
Highest Valid: 81.40
  Final Train: 100.00
   Final Test: 76.10
Split: 06, Run: 03
None time:  1.3943709190934896
None Run 18:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 71.40
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.3686405720654875
None Run 19:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 65.60
Split: 07, Run: 02
None time:  1.3928270139731467
None Run 20:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 64.50
Split: 07, Run: 03
None time:  1.1845981678925455
None Run 21:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 64.50
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.3916459961328655
None Run 22:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 72.60
Split: 08, Run: 02
None time:  1.4226599200628698
None Run 23:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 68.80
Split: 08, Run: 03
None time:  1.3830724670551717
None Run 24:
Highest Train: 100.00
Highest Valid: 59.80
  Final Train: 100.00
   Final Test: 64.00
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.4501610770821571
None Run 25:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 72.50
Split: 09, Run: 02
None time:  1.4548365131486207
None Run 26:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 74.30
Split: 09, Run: 03
None time:  1.4416196460369974
None Run 27:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 74.70
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.3699336838908494
None Run 28:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 65.40
Split: 10, Run: 02
None time:  1.443309421883896
None Run 29:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 68.80
Split: 10, Run: 03
None time:  1.4008257798850536
None Run 30:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 66.50
run time now: 4.25010871887207
total time:  43.82693208800629
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 68.02 ± 6.14
  Final Train: 100.00 ± 0.00
   Final Test: 68.29 ± 5.00
best run test_acc: 71.23999786376953
[I 2023-06-12 00:35:04,933] Trial 29 finished with value: 68.02000427246094 and parameters: {'Fwd': 0.0005248102096493192, 'K': 2, 'alpha': 0.65, 'dropout': 0.6000000000000001, 'gnnepoch': 60, 'lambda1': 0.45, 'lambda2': 6.509886731629074, 'loop': 1, 'loss': 'CE', 'lr': 0.0005924079949415408, 'softmaxF': False, 'useGCN': True, 'weight_decay': 0.021485040053950896, 'weightedloss': True}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  0.75
lr:  0.0019529019676835242
weight_decay:  0.04141199813871027
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.0561260401736945
None Run 01:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 74.30
Split: 01, Run: 02
None time:  1.1508445129729807
None Run 02:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 65.10
Split: 01, Run: 03
None time:  1.1661013290286064
None Run 03:
Highest Train: 100.00
Highest Valid: 67.40
  Final Train: 100.00
   Final Test: 65.10
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.1487295900005847
None Run 04:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 72.40
Split: 02, Run: 02
None time:  1.1898950398899615
None Run 05:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 73.30
Split: 02, Run: 03
None time:  1.1894753789529204
None Run 06:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 72.50
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1675388659350574
None Run 07:
Highest Train: 100.00
Highest Valid: 61.60
  Final Train: 100.00
   Final Test: 68.70
Split: 03, Run: 02
None time:  1.2040106288623065
None Run 08:
Highest Train: 100.00
Highest Valid: 58.60
  Final Train: 100.00
   Final Test: 62.00
Split: 03, Run: 03
None time:  1.2059333708602935
None Run 09:
Highest Train: 100.00
Highest Valid: 61.00
  Final Train: 100.00
   Final Test: 64.10
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.210743319010362
None Run 10:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 67.00
Split: 04, Run: 02
None time:  1.0951957418583333
None Run 11:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 63.50
Split: 04, Run: 03
None time:  1.1113756361883134
None Run 12:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 63.50
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.1532257688231766
None Run 13:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 69.10
Split: 05, Run: 02
None time:  1.1745556329842657
None Run 14:
Highest Train: 100.00
Highest Valid: 67.40
  Final Train: 100.00
   Final Test: 68.90
Split: 05, Run: 03
None time:  1.1887486199848354
None Run 15:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 71.40
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.1218580619897693
None Run 16:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 69.20
Split: 06, Run: 02
None time:  1.3338968029711396
None Run 17:
Highest Train: 100.00
Highest Valid: 81.20
  Final Train: 100.00
   Final Test: 73.60
Split: 06, Run: 03
None time:  1.374147956026718
None Run 18:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 73.30
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.1917354119941592
None Run 19:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 73.80
Split: 07, Run: 02
None time:  1.1675152669195086
None Run 20:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 71.40
Split: 07, Run: 03
None time:  1.2224661919753999
None Run 21:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 73.10
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.2087671160697937
None Run 22:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 74.50
Split: 08, Run: 02
None time:  1.1645929119549692
None Run 23:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 100.00
   Final Test: 76.50
Split: 08, Run: 03
None time:  1.270263183163479
None Run 24:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 75.10
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.0342976960819215
None Run 25:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 71.70
Split: 09, Run: 02
None time:  1.1867396421730518
None Run 26:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 73.70
Split: 09, Run: 03
None time:  1.4098579070996493
None Run 27:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 76.70
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.1594931359868497
None Run 28:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 70.10
Split: 10, Run: 02
None time:  1.188508175080642
None Run 29:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 70.30
Split: 10, Run: 03
None time:  1.3570655528455973
None Run 30:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 68.60
run time now: 3.7495594024658203
total time:  36.91552621801384
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 71.45 ± 5.54
  Final Train: 100.00 ± 0.00
   Final Test: 70.42 ± 4.09
best run test_acc: 72.55999755859375
[I 2023-06-12 00:35:42,335] Trial 30 finished with value: 71.44667053222656 and parameters: {'Fwd': 7.254989991715333e-06, 'K': 7, 'alpha': 0.75, 'dropout': 0.2, 'gnnepoch': 100, 'lambda1': 0.2, 'lambda2': 8.26814538476712, 'loop': 0, 'loss': 'CE', 'lr': 0.0019529019676835242, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.04141199813871027, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.9
lr:  0.003013999664413569
weight_decay:  0.0009351115243531132
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.4161596598569304
None Run 01:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 65.60
Split: 01, Run: 02
None time:  1.382077672984451
None Run 02:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 70.70
Split: 01, Run: 03
None time:  1.2399659929797053
None Run 03:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 69.80
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.340984891867265
None Run 04:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
Split: 02, Run: 02
None time:  1.4226417418103665
None Run 05:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
Split: 02, Run: 03
None time:  1.3330960620660335
None Run 06:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.4283800129778683
None Run 07:
Highest Train: 100.00
Highest Valid: 60.20
  Final Train: 100.00
   Final Test: 66.10
Split: 03, Run: 02
None time:  1.688610658980906
None Run 08:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 76.67
   Final Test: 70.20
Split: 03, Run: 03
None time:  1.3879923089407384
None Run 09:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 71.90
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.4135502011049539
None Run 10:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 63.60
Split: 04, Run: 02
None time:  2.2901844570878893
None Run 11:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 70.00
   Final Test: 65.20
Split: 04, Run: 03
None time:  1.4594766290392727
None Run 12:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 83.33
   Final Test: 61.50
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.5109394721221179
None Run 13:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 72.40
Split: 05, Run: 02
None time:  1.5065633989870548
None Run 14:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 90.00
   Final Test: 75.30
Split: 05, Run: 03
None time:  1.3574566489551216
None Run 15:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 76.67
   Final Test: 74.50
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.411473890999332
None Run 16:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 100.00
   Final Test: 74.60
Split: 06, Run: 02
None time:  1.3517598218750209
None Run 17:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 70.20
Split: 06, Run: 03
None time:  1.5822911970317364
None Run 18:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 66.67
   Final Test: 69.30
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.4270405468996614
None Run 19:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 75.00
Split: 07, Run: 02
None time:  1.3694816259667277
None Run 20:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 72.60
Split: 07, Run: 03
None time:  1.3911594308447093
None Run 21:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 72.30
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.3684679979924113
None Run 22:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 74.80
Split: 08, Run: 02
None time:  1.4457567720673978
None Run 23:
Highest Train: 100.00
Highest Valid: 80.20
  Final Train: 100.00
   Final Test: 79.60
Split: 08, Run: 03
None time:  1.394377700984478
None Run 24:
Highest Train: 100.00
Highest Valid: 80.00
  Final Train: 100.00
   Final Test: 78.00
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.3949393581133336
None Run 25:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 74.80
Split: 09, Run: 02
None time:  1.3277970179915428
None Run 26:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 78.20
Split: 09, Run: 03
None time:  1.397977788001299
None Run 27:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 77.80
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.3659467350225896
None Run 28:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 69.60
Split: 10, Run: 02
None time:  1.4812561480794102
None Run 29:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 93.33
   Final Test: 59.90
Split: 10, Run: 03
None time:  1.660290792118758
None Run 30:
Highest Train: 100.00
Highest Valid: 67.40
  Final Train: 76.67
   Final Test: 60.10
run time now: 4.551077365875244
total time:  44.69792713387869
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.42 ± 4.80
  Final Train: 94.44 ± 10.41
   Final Test: 70.86 ± 5.25
best run test_acc: 73.08000183105469
[I 2023-06-12 00:36:27,676] Trial 31 finished with value: 72.42000579833984 and parameters: {'Fwd': 9.18056856875224e-05, 'K': 6, 'alpha': 0.9, 'dropout': 0.1, 'gnnepoch': 110, 'lambda1': 0.7000000000000001, 'lambda2': 9.142562105045505, 'loop': 2, 'loss': 'CE', 'lr': 0.003013999664413569, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.0009351115243531132, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  5
alpha:  0.9500000000000001
lr:  0.0013475729147414417
weight_decay:  0.0002605315051868813
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.0305937130469829
None Run 01:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 62.80
Split: 01, Run: 02
None time:  1.3456105969380587
None Run 02:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 96.67
   Final Test: 79.90
Split: 01, Run: 03
None time:  1.2127835820429027
None Run 03:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 96.67
   Final Test: 79.20
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.0096473849844187
None Run 04:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 69.60
Split: 02, Run: 02
None time:  1.082399423001334
None Run 05:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.20
Split: 02, Run: 03
None time:  1.0545404849108309
None Run 06:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 70.60
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1553060309961438
None Run 07:
Highest Train: 100.00
Highest Valid: 61.60
  Final Train: 100.00
   Final Test: 67.50
Split: 03, Run: 02
None time:  1.0404559900052845
None Run 08:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 67.90
Split: 03, Run: 03
None time:  0.8391678140033036
None Run 09:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 68.20
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.0794677219819278
None Run 10:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 67.40
Split: 04, Run: 02
None time:  1.3191861039958894
None Run 11:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 83.33
   Final Test: 66.40
Split: 04, Run: 03
None time:  1.2253574801143259
None Run 12:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 83.33
   Final Test: 62.10
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.2146495881024748
None Run 13:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 96.67
   Final Test: 73.80
Split: 05, Run: 02
None time:  1.0817538718692958
None Run 14:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 77.50
Split: 05, Run: 03
None time:  1.1599763769190758
None Run 15:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 86.67
   Final Test: 75.10
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.0392497947905213
None Run 16:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 74.50
Split: 06, Run: 02
None time:  1.156453507952392
None Run 17:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 72.20
Split: 06, Run: 03
None time:  1.1244335030205548
None Run 18:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 96.67
   Final Test: 71.50
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.9980425948742777
None Run 19:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 74.90
Split: 07, Run: 02
None time:  1.078109738882631
None Run 20:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 73.60
Split: 07, Run: 03
None time:  1.1181250209920108
None Run 21:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 72.30
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.1187756520230323
None Run 22:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 74.40
Split: 08, Run: 02
None time:  1.2543760901317
None Run 23:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 96.67
   Final Test: 77.40
Split: 08, Run: 03
None time:  1.028596097836271
None Run 24:
Highest Train: 100.00
Highest Valid: 80.00
  Final Train: 96.67
   Final Test: 78.70
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.2163635729812086
None Run 25:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 75.00
Split: 09, Run: 02
None time:  1.075245504034683
None Run 26:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 78.60
Split: 09, Run: 03
None time:  0.9999888010788709
None Run 27:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 79.20
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.0814881620462984
None Run 28:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 67.40
Split: 10, Run: 02
None time:  1.0555305629968643
None Run 29:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 66.30
Split: 10, Run: 03
None time:  1.1818517670035362
None Run 30:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 66.00
run time now: 3.3597986698150635
total time:  34.45681155403145
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.96 ± 5.05
  Final Train: 97.78 ± 4.74
   Final Test: 72.01 ± 5.07
best run test_acc: 73.83000183105469
[I 2023-06-12 00:37:02,573] Trial 32 finished with value: 72.95999908447266 and parameters: {'Fwd': 4.837039103627619e-05, 'K': 5, 'alpha': 0.9500000000000001, 'dropout': 0.0, 'gnnepoch': 90, 'lambda1': 0.75, 'lambda2': 9.926224760729998, 'loop': 1, 'loss': 'CE', 'lr': 0.0013475729147414417, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.0002605315051868813, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  5
alpha:  1.0
lr:  0.0013409735163029996
weight_decay:  0.004593547696214481
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.208226980175823
None Run 01:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 96.67
   Final Test: 77.80
Split: 01, Run: 02
None time:  1.0135413829702884
None Run 02:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 96.67
   Final Test: 79.20
Split: 01, Run: 03
None time:  1.0078615539241582
None Run 03:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 96.67
   Final Test: 79.60
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.9811441879719496
None Run 04:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 72.70
Split: 02, Run: 02
None time:  0.8758930750191212
None Run 05:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 72.00
Split: 02, Run: 03
None time:  0.8810081349220127
None Run 06:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 69.60
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1136918221600354
None Run 07:
Highest Train: 100.00
Highest Valid: 60.00
  Final Train: 100.00
   Final Test: 64.40
Split: 03, Run: 02
None time:  0.8842679259832948
None Run 08:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 67.70
Split: 03, Run: 03
None time:  0.9283603229559958
None Run 09:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 67.50
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.9521680979523808
None Run 10:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 64.50
Split: 04, Run: 02
None time:  1.0800155689939857
None Run 11:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 83.33
   Final Test: 63.50
Split: 04, Run: 03
None time:  1.2560593159869313
None Run 12:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 73.33
   Final Test: 65.20
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.811355632962659
None Run 13:
Highest Train: 100.00
Highest Valid: 57.80
  Final Train: 100.00
   Final Test: 60.80
Split: 05, Run: 02
None time:  0.9540738919749856
None Run 14:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 73.70
Split: 05, Run: 03
None time:  1.022054011002183
None Run 15:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 76.80
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.9579616270493716
None Run 16:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 70.30
Split: 06, Run: 02
None time:  1.1000170670449734
None Run 17:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 90.00
   Final Test: 72.60
Split: 06, Run: 03
None time:  0.9227570220828056
None Run 18:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 71.30
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.900077453115955
None Run 19:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 75.00
Split: 07, Run: 02
None time:  0.9064897529315203
None Run 20:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 74.90
Split: 07, Run: 03
None time:  1.1376324568409473
None Run 21:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 86.67
   Final Test: 72.60
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.8852871689014137
None Run 22:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 69.80
Split: 08, Run: 02
None time:  1.0246372979599983
None Run 23:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 96.67
   Final Test: 77.90
Split: 08, Run: 03
None time:  1.10779041191563
None Run 24:
Highest Train: 100.00
Highest Valid: 79.60
  Final Train: 96.67
   Final Test: 78.80
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.287094210041687
None Run 25:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 96.67
   Final Test: 70.80
Split: 09, Run: 02
None time:  0.950210849987343
None Run 26:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 100.00
   Final Test: 77.50
Split: 09, Run: 03
None time:  0.9436459480784833
None Run 27:
Highest Train: 100.00
Highest Valid: 79.20
  Final Train: 100.00
   Final Test: 77.20
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.9698322068434209
None Run 28:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 66.00
Split: 10, Run: 02
None time:  0.9551294911652803
None Run 29:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 66.80
Split: 10, Run: 03
None time:  0.914877078961581
None Run 30:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 65.50
run time now: 2.8815388679504395
total time:  30.967524650972337
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.05 ± 5.69
  Final Train: 97.11 ± 6.11
   Final Test: 71.40 ± 5.36
best run test_acc: 73.2699966430664
[I 2023-06-12 00:37:33,978] Trial 33 finished with value: 72.05333709716797 and parameters: {'Fwd': 3.2110069453718726e-05, 'K': 5, 'alpha': 1.0, 'dropout': 0.1, 'gnnepoch': 70, 'lambda1': 0.9, 'lambda2': 8.629469978166227, 'loop': 1, 'loss': 'CE', 'lr': 0.0013409735163029996, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.004593547696214481, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  4
alpha:  0.9
lr:  0.0008144425067759962
weight_decay:  0.00022461809408558022
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.037731823977083
None Run 01:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 65.80
Split: 01, Run: 02
None time:  1.3169761390890926
None Run 02:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 77.70
Split: 01, Run: 03
None time:  1.253832926042378
None Run 03:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 96.67
   Final Test: 76.50
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.9820237560197711
None Run 04:
Highest Train: 100.00
Highest Valid: 67.40
  Final Train: 100.00
   Final Test: 66.40
Split: 02, Run: 02
None time:  1.03882128582336
None Run 05:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 71.00
Split: 02, Run: 03
None time:  1.0182565359864384
None Run 06:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 69.90
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1009930898435414
None Run 07:
Highest Train: 100.00
Highest Valid: 61.80
  Final Train: 100.00
   Final Test: 65.80
Split: 03, Run: 02
None time:  0.9910578830167651
None Run 08:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 70.50
Split: 03, Run: 03
None time:  0.9918294060043991
None Run 09:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 70.10
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.039863107027486
None Run 10:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 65.80
Split: 04, Run: 02
None time:  0.9600362740457058
None Run 11:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 62.10
Split: 04, Run: 03
None time:  1.281395077938214
None Run 12:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 93.33
   Final Test: 65.10
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.4457853301428258
None Run 13:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 90.00
   Final Test: 72.80
Split: 05, Run: 02
None time:  1.144974943017587
None Run 14:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 75.80
Split: 05, Run: 03
None time:  1.1051315488293767
None Run 15:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 74.30
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.0827103869523853
None Run 16:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 75.40
Split: 06, Run: 02
None time:  1.185820491053164
None Run 17:
Highest Train: 100.00
Highest Valid: 80.00
  Final Train: 100.00
   Final Test: 73.80
Split: 06, Run: 03
None time:  1.101141387829557
None Run 18:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 72.80
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.9724834638182074
None Run 19:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 73.20
Split: 07, Run: 02
None time:  1.0906824360135943
None Run 20:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 73.30
Split: 07, Run: 03
None time:  1.0377245990093797
None Run 21:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 71.50
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.0365788729395717
None Run 22:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 74.50
Split: 08, Run: 02
None time:  1.2701581378933042
None Run 23:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 96.67
   Final Test: 77.80
Split: 08, Run: 03
None time:  1.0684641860425472
None Run 24:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 79.10
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.2177155630197376
None Run 25:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 72.30
Split: 09, Run: 02
None time:  1.049453651998192
None Run 26:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 77.20
Split: 09, Run: 03
None time:  0.9353976869024336
None Run 27:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 76.60
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.9561073470395058
None Run 28:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 63.60
Split: 10, Run: 02
None time:  1.0057975251693279
None Run 29:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 68.00
Split: 10, Run: 03
None time:  0.9912382350303233
None Run 30:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 67.30
run time now: 2.992366313934326
total time:  33.742297739954665
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.43 ± 4.74
  Final Train: 99.22 ± 2.26
   Final Test: 71.53 ± 4.68
best run test_acc: 73.37999725341797
[I 2023-06-12 00:38:08,135] Trial 34 finished with value: 72.42666625976562 and parameters: {'Fwd': 0.0003252102430285179, 'K': 4, 'alpha': 0.9, 'dropout': 0.0, 'gnnepoch': 90, 'lambda1': 0.55, 'lambda2': 9.59912266693263, 'loop': 1, 'loss': 'CE', 'lr': 0.0008144425067759962, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.00022461809408558022, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  5
alpha:  0.8
lr:  0.0016406862272207053
weight_decay:  0.000634656329911201
dropout:  0.4
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.9828410688787699
None Run 01:
Highest Train: 100.00
Highest Valid: 59.20
  Final Train: 100.00
   Final Test: 56.30
Split: 01, Run: 02
None time:  1.137102359905839
None Run 02:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 71.50
Split: 01, Run: 03
None time:  1.114949874812737
None Run 03:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 90.00
   Final Test: 73.10
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.933377600973472
None Run 04:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 69.60
Split: 02, Run: 02
None time:  0.9701201370917261
None Run 05:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 72.30
Split: 02, Run: 03
None time:  0.9881755679380149
None Run 06:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 71.30
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1245420780032873
None Run 07:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 68.40
Split: 03, Run: 02
None time:  0.9592438901308924
None Run 08:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 72.10
Split: 03, Run: 03
None time:  0.9422865321394056
None Run 09:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 72.40
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.0001940671354532
None Run 10:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 67.20
Split: 04, Run: 02
None time:  1.2473854220006615
None Run 11:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 80.00
   Final Test: 66.60
Split: 04, Run: 03
None time:  1.1649293040391058
None Run 12:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 83.33
   Final Test: 61.90
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.0696719279512763
None Run 13:
Highest Train: 100.00
Highest Valid: 61.80
  Final Train: 100.00
   Final Test: 65.00
Split: 05, Run: 02
None time:  1.1671969019807875
None Run 14:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 77.60
Split: 05, Run: 03
None time:  1.0712351221591234
None Run 15:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 86.67
   Final Test: 76.40
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.069282463984564
None Run 16:
Highest Train: 100.00
Highest Valid: 80.40
  Final Train: 100.00
   Final Test: 73.50
Split: 06, Run: 02
None time:  1.102105868048966
None Run 17:
Highest Train: 100.00
Highest Valid: 79.20
  Final Train: 96.67
   Final Test: 72.70
Split: 06, Run: 03
None time:  1.0946353878825903
None Run 18:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 72.60
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.0124776039738208
None Run 19:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.30
Split: 07, Run: 02
None time:  1.0892641628161073
None Run 20:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 72.90
Split: 07, Run: 03
None time:  1.0204622771125287
None Run 21:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 71.80
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.0293725631199777
None Run 22:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 72.00
Split: 08, Run: 02
None time:  1.007247128058225
None Run 23:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 96.67
   Final Test: 78.40
Split: 08, Run: 03
None time:  0.9208339790347964
None Run 24:
Highest Train: 100.00
Highest Valid: 80.20
  Final Train: 100.00
   Final Test: 79.60
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.073021894088015
None Run 25:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 70.10
Split: 09, Run: 02
None time:  1.1297982959076762
None Run 26:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 78.60
Split: 09, Run: 03
None time:  0.9987010022159666
None Run 27:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 78.10
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.9988626488484442
None Run 28:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 61.50
Split: 10, Run: 02
None time:  0.9476098329760134
None Run 29:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 67.40
Split: 10, Run: 03
None time:  1.061241109156981
None Run 30:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 66.60
run time now: 3.0512516498565674
total time:  32.487315230071545
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.22 ± 5.24
  Final Train: 97.78 ± 5.35
   Final Test: 70.96 ± 5.37
best run test_acc: 73.45999908447266
[I 2023-06-12 00:38:41,088] Trial 35 finished with value: 72.22000122070312 and parameters: {'Fwd': 0.0019366794988591276, 'K': 5, 'alpha': 0.8, 'dropout': 0.4, 'gnnepoch': 80, 'lambda1': 0.8, 'lambda2': 9.999424102803584, 'loop': 1, 'loss': 'CE', 'lr': 0.0016406862272207053, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.000634656329911201, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  3
alpha:  0.7000000000000001
lr:  0.0012301607129507294
weight_decay:  0.0016911627750426797
dropout:  0.8
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.1221741989720613
None Run 01:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 71.20
Split: 01, Run: 02
None time:  2.1693968041799963
None Run 02:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 63.60
Split: 01, Run: 03
None time:  2.0688332500867546
None Run 03:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 65.10
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  2.1567299850285053
None Run 04:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 70.20
Split: 02, Run: 02
None time:  2.1488560289144516
None Run 05:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 71.50
Split: 02, Run: 03
None time:  2.0227094050496817
None Run 06:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 70.60
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  2.062934115063399
None Run 07:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 69.00
Split: 03, Run: 02
None time:  2.137184350984171
None Run 08:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 68.10
Split: 03, Run: 03
None time:  2.1423445441760123
None Run 09:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 67.90
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  2.4649179098196328
None Run 10:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 62.60
Split: 04, Run: 02
None time:  2.0307115130126476
None Run 11:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 63.50
Split: 04, Run: 03
None time:  2.1454961369745433
None Run 12:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 61.60
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  2.0519560400862247
None Run 13:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 72.00
Split: 05, Run: 02
None time:  2.0737379060592502
None Run 14:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 72.90
Split: 05, Run: 03
None time:  2.1930943068582565
None Run 15:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 72.30
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  2.0161324909422547
None Run 16:
Highest Train: 100.00
Highest Valid: 80.40
  Final Train: 100.00
   Final Test: 76.30
Split: 06, Run: 02
None time:  1.9922590348869562
None Run 17:
Highest Train: 100.00
Highest Valid: 82.80
  Final Train: 100.00
   Final Test: 76.70
Split: 06, Run: 03
None time:  2.1117523089051247
None Run 18:
Highest Train: 100.00
Highest Valid: 82.80
  Final Train: 100.00
   Final Test: 76.20
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.1699506568256766
None Run 19:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 69.60
Split: 07, Run: 02
None time:  2.1422954460140318
None Run 20:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 68.40
Split: 07, Run: 03
None time:  2.079354589106515
None Run 21:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 67.60
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  2.2153334910981357
None Run 22:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 76.40
Split: 08, Run: 02
None time:  2.1919361730106175
None Run 23:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 77.50
Split: 08, Run: 03
None time:  2.021328955888748
None Run 24:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 74.40
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.02611814904958
None Run 25:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 74.20
Split: 09, Run: 02
None time:  2.152581772999838
None Run 26:
Highest Train: 100.00
Highest Valid: 78.80
  Final Train: 100.00
   Final Test: 74.60
Split: 09, Run: 03
None time:  2.1474129769485444
None Run 27:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 74.70
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.8, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=3, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.7000000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.9192046369425952
None Run 28:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 65.50
Split: 10, Run: 02
None time:  2.0697496230714023
None Run 29:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 69.70
Split: 10, Run: 03
None time:  2.0613871258683503
None Run 30:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 69.40
run time now: 6.088814735412598
total time:  64.30913818418048
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 71.33 ± 5.30
  Final Train: 100.00 ± 0.00
   Final Test: 70.44 ± 4.50
best run test_acc: 71.62999725341797
[I 2023-06-12 00:39:45,954] Trial 36 finished with value: 71.32666015625 and parameters: {'Fwd': 1.9680550210948127e-05, 'K': 3, 'alpha': 0.7000000000000001, 'dropout': 0.8, 'gnnepoch': 100, 'lambda1': 0.9500000000000001, 'lambda2': 8.723349356866645, 'loop': 1, 'loss': 'CE', 'lr': 0.0012301607129507294, 'softmaxF': False, 'useGCN': True, 'weight_decay': 0.0016911627750426797, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  9
alpha:  0.25
lr:  0.0010646768889940954
weight_decay:  0.00047720711133362017
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.5966496020555496
None Run 01:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 71.70
Split: 01, Run: 02
None time:  2.4465364881325513
None Run 02:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 72.20
Split: 01, Run: 03
None time:  2.5157364571932703
None Run 03:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 72.90
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  3.043842863989994
None Run 04:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 72.10
Split: 02, Run: 02
None time:  3.3257350500207394
None Run 05:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 70.10
Split: 02, Run: 03
None time:  2.8225310780107975
None Run 06:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 71.80
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  2.4178597589489073
None Run 07:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 70.20
Split: 03, Run: 02
None time:  3.245073510101065
None Run 08:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 68.80
Split: 03, Run: 03
None time:  2.528595149051398
None Run 09:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 66.30
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  2.5872225197963417
None Run 10:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 63.00
Split: 04, Run: 02
None time:  2.5250870720483363
None Run 11:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 63.70
Split: 04, Run: 03
None time:  2.6276302330661565
None Run 12:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 62.80
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  4.213506835978478
None Run 13:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 73.20
Split: 05, Run: 02
None time:  3.0355102501343936
None Run 14:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 73.10
Split: 05, Run: 03, Epoch: 100, Loss: 0.0658, Train: 100.00%, Valid: 69.80% Test: 73.70%
Split: 05, Run: 03
None time:  6.37609095685184
None Run 15:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 73.40
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  2.7580100290942937
None Run 16:
Highest Train: 100.00
Highest Valid: 82.60
  Final Train: 100.00
   Final Test: 77.80
Split: 06, Run: 02
None time:  2.76774700707756
None Run 17:
Highest Train: 100.00
Highest Valid: 82.20
  Final Train: 100.00
   Final Test: 77.60
Split: 06, Run: 03
None time:  2.616109776077792
None Run 18:
Highest Train: 100.00
Highest Valid: 82.20
  Final Train: 100.00
   Final Test: 76.40
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.614512264961377
None Run 19:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 69.80
Split: 07, Run: 02
None time:  4.353207132779062
None Run 20:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 67.90
Split: 07, Run: 03
None time:  2.888655693968758
None Run 21:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 71.30
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  2.405264616943896
None Run 22:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 75.80
Split: 08, Run: 02
None time:  3.334885382791981
None Run 23:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 76.60
Split: 08, Run: 03
None time:  3.57441638992168
None Run 24:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 76.30
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.2690972711425275
None Run 25:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 74.80
Split: 09, Run: 02
None time:  2.285686443094164
None Run 26:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 75.70
Split: 09, Run: 03
None time:  2.4984776549972594
None Run 27:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 100.00
   Final Test: 74.30
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.25)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  4.653959180926904
None Run 28:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 70.80
Split: 10, Run: 02
None time:  3.4414573782123625
None Run 29:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 69.20
Split: 10, Run: 03
None time:  3.753865029895678
None Run 30:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 70.00
run time now: 11.90058946609497
total time:  93.71117869811133
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.02 ± 5.04
  Final Train: 100.00 ± 0.00
   Final Test: 71.65 ± 4.10
best run test_acc: 72.44999694824219
[I 2023-06-12 00:41:20,181] Trial 37 finished with value: 72.02000427246094 and parameters: {'Fwd': 5.3018139879706674e-05, 'K': 9, 'alpha': 0.25, 'dropout': 0.2, 'gnnepoch': 110, 'lambda1': 0.6000000000000001, 'lambda2': 7.954415406905802, 'loop': 1, 'loss': 'MSE', 'lr': 0.0010646768889940954, 'softmaxF': True, 'useGCN': True, 'weight_decay': 0.00047720711133362017, 'weightedloss': True}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  5
alpha:  0.9500000000000001
lr:  0.002286575373041311
weight_decay:  0.014655713787213738
dropout:  0.6000000000000001
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.837952318135649
None Run 01:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 66.90
Split: 01, Run: 02
None time:  0.8602319820784032
None Run 02:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 64.20
Split: 01, Run: 03
None time:  0.7683557600248605
None Run 03:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 63.70
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.004897614941001
None Run 04:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 73.60
Split: 02, Run: 02
None time:  0.9253018628805876
None Run 05:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 72.50
Split: 02, Run: 03
None time:  0.891812157118693
None Run 06:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 71.30
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.801230896031484
None Run 07:
Highest Train: 100.00
Highest Valid: 50.40
  Final Train: 100.00
   Final Test: 55.20
Split: 03, Run: 02
None time:  0.9245635038241744
None Run 08:
Highest Train: 100.00
Highest Valid: 59.20
  Final Train: 100.00
   Final Test: 63.00
Split: 03, Run: 03
None time:  0.9744015350006521
None Run 09:
Highest Train: 100.00
Highest Valid: 54.80
  Final Train: 100.00
   Final Test: 61.10
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.8707756290677935
None Run 10:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 68.70
Split: 04, Run: 02
None time:  0.8687144150026143
None Run 11:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 66.40
Split: 04, Run: 03
None time:  1.0507298849988729
None Run 12:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 96.67
   Final Test: 70.10
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.7734175259247422
None Run 13:
Highest Train: 100.00
Highest Valid: 57.80
  Final Train: 100.00
   Final Test: 60.80
Split: 05, Run: 02
None time:  0.7882929239422083
None Run 14:
Highest Train: 100.00
Highest Valid: 62.20
  Final Train: 100.00
   Final Test: 66.10
Split: 05, Run: 03
None time:  0.8321947669610381
None Run 15:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 68.50
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.7888625669293106
None Run 16:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 64.30
Split: 06, Run: 02
None time:  0.8667881248984486
None Run 17:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 71.30
Split: 06, Run: 03
None time:  0.9408606681972742
None Run 18:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 96.67
   Final Test: 71.90
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.6883298431057483
None Run 19:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 72.90
Split: 07, Run: 02
None time:  0.8438372609671205
None Run 20:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 96.67
   Final Test: 72.60
Split: 07, Run: 03
None time:  0.8516553260851651
None Run 21:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 74.40
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.8093642969615757
None Run 22:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 74.70
Split: 08, Run: 02
None time:  0.8415066311135888
None Run 23:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.30
Split: 08, Run: 03
None time:  0.8805946910288185
None Run 24:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 96.67
   Final Test: 77.60
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  0.7613973319530487
None Run 25:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 67.90
Split: 09, Run: 02
None time:  0.7552378489635885
None Run 26:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 67.90
Split: 09, Run: 03
None time:  0.8366421011742204
None Run 27:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 70.40
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.6000000000000001, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=5, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.7530168071389198
None Run 28:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 61.20
Split: 10, Run: 02
None time:  0.8522209161892533
None Run 29:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 65.20
Split: 10, Run: 03
None time:  0.8765496069099754
None Run 30:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 100.00
   Final Test: 62.30
run time now: 2.5254716873168945
total time:  26.580701049184427
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 68.71 ± 6.62
  Final Train: 99.56 ± 1.15
   Final Test: 67.93 ± 5.13
best run test_acc: 70.1600112915039
[I 2023-06-12 00:41:47,262] Trial 38 finished with value: 68.71333312988281 and parameters: {'Fwd': 7.22700915578028e-06, 'K': 5, 'alpha': 0.9500000000000001, 'dropout': 0.6000000000000001, 'gnnepoch': 70, 'lambda1': 0.75, 'lambda2': 9.116823559091705, 'loop': 0, 'loss': 'CE', 'lr': 0.002286575373041311, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.014655713787213738, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  2
alpha:  0.8500000000000001
lr:  0.000753114897445676
weight_decay:  0.000958686939395055
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.7583751301281154
None Run 01:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 66.50
Split: 01, Run: 02
None time:  1.7180166060570627
None Run 02:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 68.20
Split: 01, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 68.00% Test: 67.70%
Split: 01, Run: 03
None time:  2.9223486380651593
None Run 03:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 67.60
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.723734427941963
None Run 04:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 68.90
Split: 02, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 65.80% Test: 67.40%
Split: 02, Run: 02
None time:  2.970248479861766
None Run 05:
Highest Train: 100.00
Highest Valid: 65.80
  Final Train: 100.00
   Final Test: 67.30
Split: 02, Run: 03
None time:  1.7029445129446685
None Run 06:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 69.60
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.7225570708978921
None Run 07:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 68.00
Split: 03, Run: 02
None time:  1.7240958837792277
None Run 08:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 66.60
Split: 03, Run: 03
None time:  1.6685034870170057
None Run 09:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 67.70
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.7350213159807026
None Run 10:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 60.70
Split: 04, Run: 02
None time:  1.6926129010971636
None Run 11:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 61.90
Split: 04, Run: 03
None time:  1.745387134840712
None Run 12:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 61.60
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.68704690807499
None Run 13:
Highest Train: 100.00
Highest Valid: 61.80
  Final Train: 100.00
   Final Test: 65.90
Split: 05, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 66.20% Test: 69.50%
Split: 05, Run: 02
None time:  2.9839831010904163
None Run 14:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 69.50
Split: 05, Run: 03
None time:  1.7239407650195062
None Run 15:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 71.60
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 82.80% Test: 77.30%
Split: 06, Run: 01
None time:  2.943321657832712
None Run 16:
Highest Train: 100.00
Highest Valid: 82.80
  Final Train: 100.00
   Final Test: 77.30
Split: 06, Run: 02
None time:  1.707303914008662
None Run 17:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 76.50
Split: 06, Run: 03
None time:  1.6922069010324776
None Run 18:
Highest Train: 100.00
Highest Valid: 81.20
  Final Train: 100.00
   Final Test: 75.70
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 64.40% Test: 64.90%
Split: 07, Run: 01
None time:  2.9412105749361217
None Run 19:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 65.00
Split: 07, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 64.60% Test: 64.80%
Split: 07, Run: 02
None time:  3.007309690816328
None Run 20:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 65.00
Split: 07, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 69.20% Test: 69.70%
Split: 07, Run: 03
None time:  2.9412489540409297
None Run 21:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 69.70
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 69.60% Test: 74.70%
Split: 08, Run: 01
None time:  2.906664069974795
None Run 22:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 74.70
Split: 08, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 72.40% Test: 75.20%
Split: 08, Run: 02
None time:  3.032197413034737
None Run 23:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 75.20
Split: 08, Run: 03
None time:  1.7033172089140862
None Run 24:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 73.80
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.7434908798895776
None Run 25:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 69.70
Split: 09, Run: 02, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 76.40% Test: 73.20%
Split: 09, Run: 02
None time:  2.954824192915112
None Run 26:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 72.80
Split: 09, Run: 03, Epoch: 100, Loss: 0.0000, Train: 100.00%, Valid: 78.00% Test: 73.70%
Split: 09, Run: 03
None time:  2.941538261016831
None Run 27:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 74.10
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=2, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.7545084699522704
None Run 28:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 68.80
Split: 10, Run: 02
None time:  1.758857503067702
None Run 29:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 66.00
Split: 10, Run: 03
None time:  1.6250992689747363
None Run 30:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 64.50
run time now: 5.176153182983398
total time:  66.14817792712711
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 69.45 ± 5.44
  Final Train: 100.00 ± 0.00
   Final Test: 69.01 ± 4.46
best run test_acc: 70.44000244140625
[I 2023-06-12 00:42:53,927] Trial 39 finished with value: 69.45333862304688 and parameters: {'Fwd': 0.00014273867032867243, 'K': 2, 'alpha': 0.8500000000000001, 'dropout': 0.1, 'gnnepoch': 90, 'lambda1': 0.5, 'lambda2': 5.917347262591769, 'loop': 0, 'loss': 'MSE', 'lr': 0.000753114897445676, 'softmaxF': False, 'useGCN': True, 'weight_decay': 0.000958686939395055, 'weightedloss': True}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  4
alpha:  0.55
lr:  0.0016556426482870084
weight_decay:  0.002182260065139308
dropout:  0.5
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.2855197919998318
None Run 01:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 64.30
Split: 01, Run: 02
None time:  1.2282688280101866
None Run 02:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 68.90
Split: 01, Run: 03
None time:  1.2695638129953295
None Run 03:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 65.90
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.258108644047752
None Run 04:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 67.40
Split: 02, Run: 02
None time:  1.2067379199434072
None Run 05:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 70.00
Split: 02, Run: 03
None time:  1.2774689900688827
None Run 06:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 69.50
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.3243367630057037
None Run 07:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 69.90
Split: 03, Run: 02
None time:  1.236386327072978
None Run 08:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 72.20
Split: 03, Run: 03
None time:  1.2921205521561205
None Run 09:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 71.70
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.2587864948436618
None Run 10:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 62.80
Split: 04, Run: 02
None time:  1.5107815889641643
None Run 11:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 90.00
   Final Test: 63.80
Split: 04, Run: 03
None time:  1.3937336618546396
None Run 12:
Highest Train: 100.00
Highest Valid: 67.40
  Final Train: 90.00
   Final Test: 60.20
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.4656216769944876
None Run 13:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 96.67
   Final Test: 75.00
Split: 05, Run: 02
None time:  1.244440919952467
None Run 14:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 96.67
   Final Test: 73.50
Split: 05, Run: 03
None time:  1.185104998992756
None Run 15:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 96.67
   Final Test: 71.40
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.3274822770617902
None Run 16:
Highest Train: 100.00
Highest Valid: 80.60
  Final Train: 100.00
   Final Test: 75.70
Split: 06, Run: 02
None time:  1.2929690580349416
None Run 17:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 72.90
Split: 06, Run: 03
None time:  1.5853136200457811
None Run 18:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 80.00
   Final Test: 69.40
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.2799607049673796
None Run 19:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 73.20
Split: 07, Run: 02
None time:  1.1949344710446894
None Run 20:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 71.00
Split: 07, Run: 03
None time:  1.2328923388849944
None Run 21:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 70.50
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.429894668981433
None Run 22:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 77.00
Split: 08, Run: 02
None time:  1.2692612670361996
None Run 23:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 78.50
Split: 08, Run: 03
None time:  1.2117160640191287
None Run 24:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 77.40
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.185254035051912
None Run 25:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 65.80
Split: 09, Run: 02
None time:  1.1975529349874705
None Run 26:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 74.00
Split: 09, Run: 03
None time:  1.2575983060523868
None Run 27:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 73.00
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.5, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=4, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.55)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.2300442131236196
None Run 28:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 65.90
Split: 10, Run: 02
None time:  1.3433417461346835
None Run 29:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 96.67
   Final Test: 66.00
Split: 10, Run: 03
None time:  1.3116632560268044
None Run 30:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 93.33
   Final Test: 64.50
run time now: 3.9306015968322754
total time:  39.85656713298522
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 71.55 ± 4.18
  Final Train: 98.00 ± 4.43
   Final Test: 70.04 ± 4.64
best run test_acc: 71.72999572753906
[I 2023-06-12 00:43:34,356] Trial 40 finished with value: 71.55333709716797 and parameters: {'Fwd': 0.05313757654147321, 'K': 4, 'alpha': 0.55, 'dropout': 0.5, 'gnnepoch': 110, 'lambda1': 0.8500000000000001, 'lambda2': 9.979772591407402, 'loop': 1, 'loss': 'CE', 'lr': 0.0016556426482870084, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.002182260065139308, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.9500000000000001
lr:  0.003074494042235664
weight_decay:  0.0070707049146881175
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.4041339568793774
None Run 01:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 65.00
Split: 01, Run: 02
None time:  1.4011382469907403
None Run 02:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 72.20
Split: 01, Run: 03
None time:  1.43515659798868
None Run 03:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 96.67
   Final Test: 74.80
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.340240556979552
None Run 04:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
Split: 02, Run: 02
None time:  1.3923991702031344
None Run 05:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
Split: 02, Run: 03
None time:  1.3682319140061736
None Run 06:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  2.4644409520551562
None Run 07:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 76.67
   Final Test: 69.20
Split: 03, Run: 02
None time:  1.6086570259649307
None Run 08:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 76.67
   Final Test: 72.10
Split: 03, Run: 03
None time:  1.4690562658943236
None Run 09:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 71.80
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.4692911389283836
None Run 10:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 64.80
Split: 04, Run: 02
None time:  1.5713230189867318
None Run 11:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 90.00
   Final Test: 60.90
Split: 04, Run: 03
None time:  1.5896338939201087
None Run 12:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 90.00
   Final Test: 60.50
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.4095236498396844
None Run 13:
Highest Train: 100.00
Highest Valid: 60.00
  Final Train: 100.00
   Final Test: 63.60
Split: 05, Run: 02
None time:  1.4056045031175017
None Run 14:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 76.50
Split: 05, Run: 03
None time:  1.4457691030111164
None Run 15:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 76.10
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.3897885559126735
None Run 16:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 74.20
Split: 06, Run: 02
None time:  1.2559671059716493
None Run 17:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 70.90
Split: 06, Run: 03
None time:  1.7228664469439536
None Run 18:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 66.67
   Final Test: 68.70
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.4364651199430227
None Run 19:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 76.00
Split: 07, Run: 02
None time:  1.4241883910726756
None Run 20:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 73.50
Split: 07, Run: 03
None time:  1.4480024790391326
None Run 21:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 73.30
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.4420662231277674
None Run 22:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 74.80
Split: 08, Run: 02
None time:  1.460062223020941
None Run 23:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 76.90
Split: 08, Run: 03
None time:  1.4036620929837227
None Run 24:
Highest Train: 100.00
Highest Valid: 80.80
  Final Train: 100.00
   Final Test: 78.80
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.4062116460409015
None Run 25:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 75.80
Split: 09, Run: 02
None time:  1.47441257792525
None Run 26:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 77.20
Split: 09, Run: 03
None time:  1.2894246948417276
None Run 27:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 77.30
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.384075870970264
None Run 28:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 69.70
Split: 10, Run: 02
None time:  1.434868774143979
None Run 29:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 90.00
   Final Test: 62.60
Split: 10, Run: 03
None time:  1.5569181020837277
None Run 30:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 86.67
   Final Test: 61.70
run time now: 4.573283910751343
total time:  45.64089764398523
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.54 ± 4.98
  Final Train: 95.78 ± 8.62
   Final Test: 71.03 ± 5.39
best run test_acc: 73.49000549316406
[I 2023-06-12 00:44:20,582] Trial 41 finished with value: 72.54000854492188 and parameters: {'Fwd': 5.9834743476182024e-05, 'K': 6, 'alpha': 0.9500000000000001, 'dropout': 0.0, 'gnnepoch': 120, 'lambda1': 0.7000000000000001, 'lambda2': 9.355895152212218, 'loop': 2, 'loss': 'CE', 'lr': 0.003074494042235664, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.0070707049146881175, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.9500000000000001
lr:  0.0024579057417094827
weight_decay:  0.00012215165964017856
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.2379801720380783
None Run 01:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 63.50
Split: 01, Run: 02
None time:  1.3261844620574266
None Run 02:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 73.10
Split: 01, Run: 03
None time:  1.394403631100431
None Run 03:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 90.00
   Final Test: 74.80
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.1812839470803738
None Run 04:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
Split: 02, Run: 02
None time:  1.2295274129137397
None Run 05:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
Split: 02, Run: 03
None time:  1.2069785930216312
None Run 06:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.2233168510720134
None Run 07:
Highest Train: 100.00
Highest Valid: 58.40
  Final Train: 100.00
   Final Test: 63.00
Split: 03, Run: 02
None time:  1.332421231083572
None Run 08:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 90.00
   Final Test: 71.90
Split: 03, Run: 03
None time:  1.2114165609236807
None Run 09:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 71.30
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.2075959760695696
None Run 10:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 65.70
Split: 04, Run: 02
None time:  1.3434395780786872
None Run 11:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 90.00
   Final Test: 61.70
Split: 04, Run: 03
None time:  1.3830689121969044
None Run 12:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 90.00
   Final Test: 60.60
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.2828963079955429
None Run 13:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 75.20
Split: 05, Run: 02
None time:  1.273779891896993
None Run 14:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 75.90
Split: 05, Run: 03
None time:  1.3628538779448718
None Run 15:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 86.67
   Final Test: 76.10
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.3914600820280612
None Run 16:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 74.10
Split: 06, Run: 02
None time:  1.273021596018225
None Run 17:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 70.90
Split: 06, Run: 03
None time:  1.4734551589936018
None Run 18:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 73.33
   Final Test: 69.20
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.2853906459640712
None Run 19:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 75.40
Split: 07, Run: 02
None time:  1.2638992092106491
None Run 20:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 72.60
Split: 07, Run: 03
None time:  1.3207525359466672
None Run 21:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 72.80
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.1827634109649807
None Run 22:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 73.70
Split: 08, Run: 02
None time:  1.2425756838638335
None Run 23:
Highest Train: 100.00
Highest Valid: 80.40
  Final Train: 100.00
   Final Test: 79.90
Split: 08, Run: 03
None time:  1.237073898082599
None Run 24:
Highest Train: 100.00
Highest Valid: 79.80
  Final Train: 100.00
   Final Test: 78.40
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.2410336800385267
None Run 25:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 72.30
Split: 09, Run: 02
None time:  1.2049807801377028
None Run 26:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 78.50
Split: 09, Run: 03
None time:  1.2636880301870406
None Run 27:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 77.50
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.2800650130957365
None Run 28:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 96.67
   Final Test: 69.30
Split: 10, Run: 02
None time:  1.168587164953351
None Run 29:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 96.67
   Final Test: 66.60
Split: 10, Run: 03
None time:  1.319123133085668
None Run 30:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 86.67
   Final Test: 64.40
run time now: 3.813443183898926
total time:  39.57582139503211
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.77 ± 4.75
  Final Train: 96.67 ± 6.31
   Final Test: 71.35 ± 5.16
best run test_acc: 73.64000701904297
[I 2023-06-12 00:45:00,652] Trial 42 finished with value: 72.76667022705078 and parameters: {'Fwd': 1.2212831902171386e-05, 'K': 6, 'alpha': 0.9500000000000001, 'dropout': 0.0, 'gnnepoch': 100, 'lambda1': 0.75, 'lambda2': 8.807115731109104, 'loop': 2, 'loss': 'CE', 'lr': 0.0024579057417094827, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.00012215165964017856, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  0.8500000000000001
lr:  0.002330082068459339
weight_decay:  0.00024002178487318417
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.2370362458750606
None Run 01:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 68.60
Split: 01, Run: 02
None time:  1.3397837460506707
None Run 02:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 76.10
Split: 01, Run: 03
None time:  1.3686715168878436
None Run 03:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 93.33
   Final Test: 72.80
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.1118338000960648
None Run 04:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.10
Split: 02, Run: 02
None time:  1.2610212061554193
None Run 05:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 72.70
Split: 02, Run: 03
None time:  1.1893493989482522
None Run 06:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.10
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.230292463907972
None Run 07:
Highest Train: 100.00
Highest Valid: 61.80
  Final Train: 100.00
   Final Test: 65.20
Split: 03, Run: 02
None time:  1.177747619105503
None Run 08:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 100.00
   Final Test: 71.20
Split: 03, Run: 03
None time:  1.0849649221636355
None Run 09:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 70.90
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.1867622481659055
None Run 10:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 63.50
Split: 04, Run: 02
None time:  1.3827134207822382
None Run 11:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 83.33
   Final Test: 66.20
Split: 04, Run: 03
None time:  1.4482775360811502
None Run 12:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 86.67
   Final Test: 61.10
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.1750579390209168
None Run 13:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 65.10
Split: 05, Run: 02
None time:  1.2738170740194619
None Run 14:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 76.70
Split: 05, Run: 03
None time:  1.3602525400929153
None Run 15:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 90.00
   Final Test: 74.70
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.3167060790583491
None Run 16:
Highest Train: 100.00
Highest Valid: 81.00
  Final Train: 100.00
   Final Test: 76.30
Split: 06, Run: 02
None time:  1.2338942990172654
None Run 17:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 72.40
Split: 06, Run: 03
None time:  1.2731953009497374
None Run 18:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 71.40
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.2462045308202505
None Run 19:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 74.80
Split: 07, Run: 02
None time:  1.2357369640376419
None Run 20:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 72.30
Split: 07, Run: 03
None time:  1.2572987598832697
None Run 21:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 72.20
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.2554714889265597
None Run 22:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 72.80
Split: 08, Run: 02
None time:  1.333174968836829
None Run 23:
Highest Train: 100.00
Highest Valid: 79.40
  Final Train: 96.67
   Final Test: 79.50
Split: 08, Run: 03
None time:  1.2420102930627763
None Run 24:
Highest Train: 100.00
Highest Valid: 80.00
  Final Train: 100.00
   Final Test: 80.40
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.1537307971157134
None Run 25:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 72.30
Split: 09, Run: 02
None time:  1.3508039868902415
None Run 26:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 100.00
   Final Test: 78.50
Split: 09, Run: 03
None time:  1.242160295136273
None Run 27:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 78.90
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.2790037121158093
None Run 28:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 69.40
Split: 10, Run: 02
None time:  1.1949832681566477
None Run 29:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 67.20
Split: 10, Run: 03
None time:  1.2976111529860646
None Run 30:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 93.33
   Final Test: 63.90
run time now: 3.816056966781616
total time:  38.79729892197065
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.81 ± 4.75
  Final Train: 98.11 ± 4.35
   Final Test: 71.64 ± 4.97
best run test_acc: 74.27000427246094
[I 2023-06-12 00:45:39,879] Trial 43 finished with value: 72.81333923339844 and parameters: {'Fwd': 4.133800539592276e-06, 'K': 7, 'alpha': 0.8500000000000001, 'dropout': 0.1, 'gnnepoch': 100, 'lambda1': 0.75, 'lambda2': 8.225051056350813, 'loop': 1, 'loss': 'CE', 'lr': 0.002330082068459339, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.00024002178487318417, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.9
lr:  0.003535308004435922
weight_decay:  0.00014128053669030925
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.2651223428547382
None Run 01:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 68.00
Split: 01, Run: 02
None time:  1.3327837309334427
None Run 02:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 96.67
   Final Test: 74.40
Split: 01, Run: 03
None time:  1.3867825118359178
None Run 03:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 90.00
   Final Test: 73.20
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.356283786939457
None Run 04:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 72.80
Split: 02, Run: 02
None time:  1.2541954470798373
None Run 05:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 72.10
Split: 02, Run: 03
None time:  1.2747605838812888
None Run 06:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 71.10
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.3132699569687247
None Run 07:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 68.30
Split: 03, Run: 02
None time:  1.2779589819256216
None Run 08:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 71.20
Split: 03, Run: 03
None time:  1.414005464874208
None Run 09:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 86.67
   Final Test: 71.50
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.2199791248422116
None Run 10:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 63.30
Split: 04, Run: 02
None time:  1.4677091990597546
None Run 11:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 83.33
   Final Test: 64.50
Split: 04, Run: 03
None time:  1.2532534159254283
None Run 12:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 64.00
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.3767863709945232
None Run 13:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 90.00
   Final Test: 75.30
Split: 05, Run: 02
None time:  1.3187503898516297
None Run 14:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 76.30
Split: 05, Run: 03
None time:  1.4801822199951857
None Run 15:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 80.00
   Final Test: 74.80
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.330734807997942
None Run 16:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 75.00
Split: 06, Run: 02
None time:  1.420995214022696
None Run 17:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 90.00
   Final Test: 72.40
Split: 06, Run: 03
None time:  1.261223129928112
None Run 18:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 93.33
   Final Test: 71.10
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.2782843641471118
None Run 19:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 74.80
Split: 07, Run: 02
None time:  1.29505634191446
None Run 20:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 73.70
Split: 07, Run: 03
None time:  1.299594348995015
None Run 21:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 73.30
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.3130760248750448
None Run 22:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 76.00
Split: 08, Run: 02
None time:  1.4139173470903188
None Run 23:
Highest Train: 100.00
Highest Valid: 80.00
  Final Train: 96.67
   Final Test: 80.40
Split: 08, Run: 03
None time:  1.2553415801376104
None Run 24:
Highest Train: 100.00
Highest Valid: 80.60
  Final Train: 100.00
   Final Test: 80.10
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.2911842160392553
None Run 25:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 75.30
Split: 09, Run: 02
None time:  1.3652055619750172
None Run 26:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 96.67
   Final Test: 78.20
Split: 09, Run: 03
None time:  1.3824549037963152
None Run 27:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 100.00
   Final Test: 79.20
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.3001612189691514
None Run 28:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 69.70
Split: 10, Run: 02
None time:  1.0795912600588053
None Run 29:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 96.67
   Final Test: 65.40
Split: 10, Run: 03
None time:  1.230833254987374
None Run 30:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 93.33
   Final Test: 62.70
run time now: 3.6687839031219482
total time:  40.639838214963675
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.90 ± 4.67
  Final Train: 96.44 ± 5.60
   Final Test: 72.27 ± 4.85
best run test_acc: 73.86000061035156
[I 2023-06-12 00:46:21,016] Trial 44 finished with value: 72.9000015258789 and parameters: {'Fwd': 3.7564725104775305e-06, 'K': 8, 'alpha': 0.9, 'dropout': 0.0, 'gnnepoch': 110, 'lambda1': 0.8500000000000001, 'lambda2': 7.695822616021278, 'loop': 1, 'loss': 'CE', 'lr': 0.003535308004435922, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.00014128053669030925, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.8500000000000001
lr:  0.0071369015150807786
weight_decay:  0.00026194731715250473
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.396591037977487
None Run 01:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 76.60
Split: 01, Run: 02
None time:  2.4196660148445517
None Run 02:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 75.60
Split: 01, Run: 03
None time:  2.3950318300630897
None Run 03:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 96.67
   Final Test: 75.30
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  2.2394749850500375
None Run 04:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 71.10
Split: 02, Run: 02
None time:  2.267167195910588
None Run 05:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 71.10
Split: 02, Run: 03
None time:  2.2814952700864524
None Run 06:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 71.10
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  2.33494581701234
None Run 07:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 67.60
Split: 03, Run: 02
None time:  2.3510523869190365
None Run 08:
Highest Train: 100.00
Highest Valid: 62.40
  Final Train: 100.00
   Final Test: 68.00
Split: 03, Run: 03
None time:  2.0617410889826715
None Run 09:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 68.50
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  2.0171204837970436
None Run 10:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 67.50
Split: 04, Run: 02
None time:  2.2886935269925743
None Run 11:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 67.40
Split: 04, Run: 03
None time:  2.3061687068548054
None Run 12:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 67.80
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  2.195749452803284
None Run 13:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 70.10
Split: 05, Run: 02
None time:  2.1448530859779567
None Run 14:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 70.20
Split: 05, Run: 03
None time:  2.135685588931665
None Run 15:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 70.80
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  2.1819517239928246
None Run 16:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 70.00
Split: 06, Run: 02
None time:  2.209555923938751
None Run 17:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 70.00
Split: 06, Run: 03
None time:  2.251092509832233
None Run 18:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 69.90
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.231646948028356
None Run 19:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 73.40
Split: 07, Run: 02
None time:  2.2121842668857425
None Run 20:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 73.10
Split: 07, Run: 03
None time:  2.270636166911572
None Run 21:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 72.60
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  2.2404678950551897
None Run 22:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 96.67
   Final Test: 76.80
Split: 08, Run: 02
None time:  1.9524835040792823
None Run 23:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 77.20
Split: 08, Run: 03
None time:  2.314868760993704
None Run 24:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 75.50
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.1723278081044555
None Run 25:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 100.00
   Final Test: 76.50
Split: 09, Run: 02
None time:  2.3853186031337827
None Run 26:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 77.20
Split: 09, Run: 03
None time:  2.2978959849569947
None Run 27:
Highest Train: 100.00
Highest Valid: 79.20
  Final Train: 100.00
   Final Test: 77.30
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  2.2766409181058407
None Run 28:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 67.80
Split: 10, Run: 02
None time:  2.2768627379555255
None Run 29:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 66.90
Split: 10, Run: 03
None time:  2.3242597389034927
None Run 30:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 68.10
run time now: 6.92535138130188
total time:  68.62523050396703
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.25 ± 4.59
  Final Train: 99.78 ± 0.85
   Final Test: 71.70 ± 3.58
best run test_acc: 72.08000183105469
[I 2023-06-12 00:47:30,175] Trial 45 finished with value: 72.24667358398438 and parameters: {'Fwd': 4.253207789668175e-06, 'K': 8, 'alpha': 0.8500000000000001, 'dropout': 0.0, 'gnnepoch': 110, 'lambda1': 0.9500000000000001, 'lambda2': 7.632795533613914, 'loop': 1, 'loss': 'CE', 'lr': 0.0071369015150807786, 'softmaxF': False, 'useGCN': True, 'weight_decay': 0.00026194731715250473, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  0.2
lr:  0.003715475200676923
weight_decay:  0.0001028887961929054
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.417842707131058
None Run 01:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 66.20
Split: 01, Run: 02
None time:  0.4189574639312923
None Run 02:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 66.20
Split: 01, Run: 03
None time:  0.4035427160561085
None Run 03:
Highest Train: 100.00
Highest Valid: 63.40
  Final Train: 100.00
   Final Test: 66.20
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.41857817489653826
None Run 04:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.10
Split: 02, Run: 02
None time:  0.40090659400448203
None Run 05:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.10
Split: 02, Run: 03
None time:  0.38194294390268624
None Run 06:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.10
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.4236484558787197
None Run 07:
Highest Train: 100.00
Highest Valid: 53.60
  Final Train: 100.00
   Final Test: 56.50
Split: 03, Run: 02
None time:  0.4038164750672877
None Run 08:
Highest Train: 100.00
Highest Valid: 53.60
  Final Train: 100.00
   Final Test: 56.50
Split: 03, Run: 03
None time:  0.40182180888950825
None Run 09:
Highest Train: 100.00
Highest Valid: 53.60
  Final Train: 100.00
   Final Test: 56.50
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  0.407007141970098
None Run 10:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 63.50
Split: 04, Run: 02
None time:  0.4190344598609954
None Run 11:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 63.50
Split: 04, Run: 03
None time:  0.4071255379822105
None Run 12:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 63.50
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.42061352101154625
None Run 13:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 65.10
Split: 05, Run: 02
None time:  0.4027867049444467
None Run 14:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 65.10
Split: 05, Run: 03
None time:  0.3954901830293238
None Run 15:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 65.10
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.40059665916487575
None Run 16:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 65.30
Split: 06, Run: 02
None time:  0.3924552539829165
None Run 17:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 65.30
Split: 06, Run: 03
None time:  0.38949950714595616
None Run 18:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 65.30
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.4280787471216172
None Run 19:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 66.30
Split: 07, Run: 02
None time:  0.4152609270531684
None Run 20:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 66.30
Split: 07, Run: 03
None time:  0.4116881478112191
None Run 21:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 66.30
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.4110684480983764
None Run 22:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 72.10
Split: 08, Run: 02
None time:  0.4073385938536376
None Run 23:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 72.10
Split: 08, Run: 03
None time:  0.42138289706781507
None Run 24:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 72.10
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  0.3919563621748239
None Run 25:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 71.70
Split: 09, Run: 02
None time:  0.40819921693764627
None Run 26:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 71.70
Split: 09, Run: 03
None time:  0.3758360689971596
None Run 27:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 71.70
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.2)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.41325456998310983
None Run 28:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 63.80
Split: 10, Run: 02
None time:  0.45339716086164117
None Run 29:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 63.80
Split: 10, Run: 03
None time:  0.44549290114082396
None Run 30:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 63.80
run time now: 1.3591570854187012
total time:  13.567878030939028
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 66.16 ± 5.69
  Final Train: 100.00 ± 0.00
   Final Test: 66.16 ± 4.53
best run test_acc: 66.15999603271484
[I 2023-06-12 00:47:44,197] Trial 46 finished with value: 66.16000366210938 and parameters: {'Fwd': 2.163889574447307e-06, 'K': 7, 'alpha': 0.2, 'dropout': 0.1, 'gnnepoch': 10, 'lambda1': 0.8500000000000001, 'lambda2': 8.130414506697308, 'loop': 1, 'loss': 'CE', 'lr': 0.003715475200676923, 'softmaxF': True, 'useGCN': False, 'weight_decay': 0.0001028887961929054, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.8
lr:  0.005633469751947429
weight_decay:  0.0003897881837125196
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.0881850488949567
None Run 01:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 70.60
Split: 01, Run: 02
None time:  1.895363125950098
None Run 02:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 74.40
Split: 01, Run: 03
None time:  1.5478759771212935
None Run 03:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 68.00
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.7931760719511658
None Run 04:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 70.50
Split: 02, Run: 02
None time:  1.233505719108507
None Run 05:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 03
None time:  1.3432674431242049
None Run 06:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 69.70
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.7639765420462936
None Run 07:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 71.80
Split: 03, Run: 02
None time:  2.2106309288647026
None Run 08:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 74.00
Split: 03, Run: 03
None time:  1.361130498116836
None Run 09:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 70.50
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.2396945171058178
None Run 10:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 62.90
Split: 04, Run: 02
None time:  1.849606896052137
None Run 11:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 63.40
Split: 04, Run: 03
None time:  1.424149053869769
None Run 12:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 62.80
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  2.4047585690859705
None Run 13:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 72.40
Split: 05, Run: 02
None time:  1.3046738090924919
None Run 14:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 75.50
Split: 05, Run: 03
None time:  1.38045324687846
None Run 15:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 76.10
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  2.1261779689230025
None Run 16:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 72.80
Split: 06, Run: 02
None time:  2.647172894096002
None Run 17:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 74.40
Split: 06, Run: 03
None time:  1.7180189301725477
None Run 18:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 72.60
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.6933484738692641
None Run 19:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 72.30
Split: 07, Run: 02
None time:  1.390185372903943
None Run 20:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 71.30
Split: 07, Run: 03
None time:  1.9829939440824091
None Run 21:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 72.70
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.400937755824998
None Run 22:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 77.60
Split: 08, Run: 02
None time:  1.5334197550546378
None Run 23:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 77.40
Split: 08, Run: 03
None time:  1.2938896780833602
None Run 24:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 77.70
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.7889679069630802
None Run 25:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 75.70
Split: 09, Run: 02
None time:  1.4802237499970943
None Run 26:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 77.70
Split: 09, Run: 03
None time:  1.3337332401424646
None Run 27:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 76.90
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.5128105969633907
None Run 28:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 67.20
Split: 10, Run: 02
None time:  1.4456203039735556
None Run 29:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 66.50
Split: 10, Run: 03
None time:  1.37883196095936
None Run 30:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 67.10
run time now: 4.385776519775391
total time:  50.69775994704105
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.27 ± 3.88
  Final Train: 100.00 ± 0.00
   Final Test: 71.79 ± 4.38
best run test_acc: 72.8800048828125
[I 2023-06-12 00:48:35,472] Trial 47 finished with value: 72.2733383178711 and parameters: {'Fwd': 1.915180462368068e-06, 'K': 8, 'alpha': 0.8, 'dropout': 0.2, 'gnnepoch': 110, 'lambda1': 0.65, 'lambda2': 7.174335866538543, 'loop': 1, 'loss': 'MSE', 'lr': 0.005633469751947429, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.0003897881837125196, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  9
alpha:  1.0
lr:  0.0014623480734158728
weight_decay:  8.080366887212837e-05
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.060554007999599
None Run 01:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 71.30
Split: 01, Run: 02
None time:  1.9891241900622845
None Run 02:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 65.90
Split: 01, Run: 03
None time:  1.9866659070830792
None Run 03:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 71.10
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.9739139180164784
None Run 04:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 02
None time:  1.913500800030306
None Run 05:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 03
None time:  1.979895460885018
None Run 06:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 71.20
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.919857663102448
None Run 07:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 66.70
Split: 03, Run: 02
None time:  1.9919085148721933
None Run 08:
Highest Train: 100.00
Highest Valid: 62.00
  Final Train: 100.00
   Final Test: 65.70
Split: 03, Run: 03
None time:  1.9268634649924934
None Run 09:
Highest Train: 100.00
Highest Valid: 65.00
  Final Train: 100.00
   Final Test: 68.00
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  2.1870379741303623
None Run 10:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 63.60
Split: 04, Run: 02
None time:  2.2279584088828415
None Run 11:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 65.20
Split: 04, Run: 03
None time:  2.224866033066064
None Run 12:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 66.90
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  2.098143775947392
None Run 13:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 72.30
Split: 05, Run: 02
None time:  1.9667327129282057
None Run 14:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 72.00
Split: 05, Run: 03
None time:  2.0333527920302004
None Run 15:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 73.10
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  2.035783142084256
None Run 16:
Highest Train: 100.00
Highest Valid: 83.00
  Final Train: 100.00
   Final Test: 76.20
Split: 06, Run: 02
None time:  1.984206171007827
None Run 17:
Highest Train: 100.00
Highest Valid: 83.20
  Final Train: 100.00
   Final Test: 76.40
Split: 06, Run: 03
None time:  2.009510725038126
None Run 18:
Highest Train: 100.00
Highest Valid: 81.40
  Final Train: 100.00
   Final Test: 75.40
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.9027347317896783
None Run 19:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.60
Split: 07, Run: 02
None time:  2.0471545557957143
None Run 20:
Highest Train: 100.00
Highest Valid: 72.20
  Final Train: 100.00
   Final Test: 71.80
Split: 07, Run: 03
None time:  2.0068361798767
None Run 21:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 70.20
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.9080146099440753
None Run 22:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 78.10
Split: 08, Run: 02
None time:  2.045857009012252
None Run 23:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 77.40
Split: 08, Run: 03
None time:  2.070081010926515
None Run 24:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 78.70
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.985501293092966
None Run 25:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 75.30
Split: 09, Run: 02
None time:  2.0329906560946256
None Run 26:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 75.30
Split: 09, Run: 03
None time:  2.0828476808965206
None Run 27:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 74.60
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.9287307590711862
None Run 28:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 67.30
Split: 10, Run: 02
None time:  2.015012907097116
None Run 29:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 100.00
   Final Test: 68.10
Split: 10, Run: 03
None time:  2.023462804965675
None Run 30:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 67.80
run time now: 6.015735864639282
total time:  61.908021948998794
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.09 ± 5.34
  Final Train: 100.00 ± 0.00
   Final Test: 71.29 ± 4.16
best run test_acc: 72.08000183105469
[I 2023-06-12 00:49:37,948] Trial 48 finished with value: 72.086669921875 and parameters: {'Fwd': 4.250433311642742e-06, 'K': 9, 'alpha': 1.0, 'dropout': 0.0, 'gnnepoch': 90, 'lambda1': 0.30000000000000004, 'lambda2': 7.6750092841660695, 'loop': 1, 'loss': 'CE', 'lr': 0.0014623480734158728, 'softmaxF': False, 'useGCN': True, 'weight_decay': 8.080366887212837e-05, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  9
alpha:  0.9
lr:  0.002489429084956089
weight_decay:  0.058111395213446916
dropout:  0.2
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.1479841540567577
None Run 01:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 67.20
Split: 01, Run: 02
None time:  1.1142226899974048
None Run 02:
Highest Train: 100.00
Highest Valid: 63.60
  Final Train: 100.00
   Final Test: 67.20
Split: 01, Run: 03
None time:  1.2876344830729067
None Run 03:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 65.70
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.1276775780133903
None Run 04:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 02
None time:  1.1779225170612335
None Run 05:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 03
None time:  1.1612330549396574
None Run 06:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 71.20
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1563886019866914
None Run 07:
Highest Train: 100.00
Highest Valid: 60.60
  Final Train: 100.00
   Final Test: 66.60
Split: 03, Run: 02
None time:  1.260182507801801
None Run 08:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 61.40
Split: 03, Run: 03
None time:  1.3004236831329763
None Run 09:
Highest Train: 100.00
Highest Valid: 60.20
  Final Train: 100.00
   Final Test: 62.50
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.2280798109713942
None Run 10:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 66.80
Split: 04, Run: 02
None time:  1.1339384529273957
None Run 11:
Highest Train: 100.00
Highest Valid: 64.60
  Final Train: 100.00
   Final Test: 63.80
Split: 04, Run: 03
None time:  1.4332984020002186
None Run 12:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 64.00
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.0977537131402642
None Run 13:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 67.00
Split: 05, Run: 02
None time:  1.2483995580114424
None Run 14:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 71.50
Split: 05, Run: 03
None time:  1.2995180380530655
None Run 15:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 74.60
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.2458193020429462
None Run 16:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 66.30
Split: 06, Run: 02
None time:  1.3502032300457358
None Run 17:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 73.20
Split: 06, Run: 03
None time:  1.3208112800493836
None Run 18:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 69.60
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.1791946799494326
None Run 19:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 73.80
Split: 07, Run: 02
None time:  1.1791883069090545
None Run 20:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 73.40
Split: 07, Run: 03
None time:  1.0940346419811249
None Run 21:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 72.10
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.1415255989413708
None Run 22:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 71.30
Split: 08, Run: 02
None time:  1.2145581899676472
None Run 23:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 96.67
   Final Test: 77.10
Split: 08, Run: 03
None time:  1.09400853398256
None Run 24:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 73.70
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.1107103740796447
None Run 25:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 71.10
Split: 09, Run: 02
None time:  1.435826059896499
None Run 26:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 77.10
Split: 09, Run: 03
None time:  1.1702392289880663
None Run 27:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 74.80
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.2136700148694217
None Run 28:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 68.50
Split: 10, Run: 02
None time:  1.1190335501451045
None Run 29:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 68.50
Split: 10, Run: 03
None time:  1.206120460992679
None Run 30:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 67.90
run time now: 3.6169281005859375
total time:  37.444962662877515
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 70.76 ± 5.59
  Final Train: 99.89 ± 0.61
   Final Test: 69.68 ± 4.14
best run test_acc: 71.61000061035156
[I 2023-06-12 00:50:15,840] Trial 49 finished with value: 70.76000213623047 and parameters: {'Fwd': 3.024873660970897e-06, 'K': 9, 'alpha': 0.9, 'dropout': 0.2, 'gnnepoch': 100, 'lambda1': 0.4, 'lambda2': 9.524110186100655, 'loop': 0, 'loss': 'CE', 'lr': 0.002489429084956089, 'softmaxF': True, 'useGCN': False, 'weight_decay': 0.058111395213446916, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  0.65
lr:  0.003425257204791986
weight_decay:  0.0006036468426131383
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.576766253914684
None Run 01:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 90.00
   Final Test: 79.10
Split: 01, Run: 02
None time:  1.260883058886975
None Run 02:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 96.67
   Final Test: 77.40
Split: 01, Run: 03
None time:  1.4349286498036236
None Run 03:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 90.00
   Final Test: 76.70
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.2759921841789037
None Run 04:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 02
None time:  1.2462598069105297
None Run 05:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.10
Split: 02, Run: 03
None time:  1.1796827900689095
None Run 06:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.10
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.3789214270655066
None Run 07:
Highest Train: 100.00
Highest Valid: 64.00
  Final Train: 100.00
   Final Test: 69.40
Split: 03, Run: 02
None time:  1.2061344180256128
None Run 08:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 75.20
Split: 03, Run: 03
None time:  1.2374304118566215
None Run 09:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 68.20
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.2304170581046492
None Run 10:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 63.50
Split: 04, Run: 02
None time:  1.222444606013596
None Run 11:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 63.50
Split: 04, Run: 03
None time:  1.39340831595473
None Run 12:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 80.00
   Final Test: 67.50
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.4346278789453208
None Run 13:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 90.00
   Final Test: 76.60
Split: 05, Run: 02
None time:  1.3217338549438864
None Run 14:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 93.33
   Final Test: 73.90
Split: 05, Run: 03
None time:  1.2631321500521153
None Run 15:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 83.33
   Final Test: 71.90
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.334717424819246
None Run 16:
Highest Train: 100.00
Highest Valid: 81.40
  Final Train: 100.00
   Final Test: 78.60
Split: 06, Run: 02
None time:  1.3908357459586114
None Run 17:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 96.67
   Final Test: 75.60
Split: 06, Run: 03
None time:  1.4365598899312317
None Run 18:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 96.67
   Final Test: 72.30
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.3841840790119022
None Run 19:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 73.90
Split: 07, Run: 02
None time:  1.313534737797454
None Run 20:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 70.80
Split: 07, Run: 03
None time:  1.3326675838325173
None Run 21:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 90.00
   Final Test: 71.50
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.4279105770401657
None Run 22:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 96.67
   Final Test: 78.00
Split: 08, Run: 02
None time:  1.316757210996002
None Run 23:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 72.20
Split: 08, Run: 03
None time:  1.2998187690973282
None Run 24:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 72.20
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.3521004780195653
None Run 25:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 74.50
Split: 09, Run: 02
None time:  1.2870010221377015
None Run 26:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 71.70
Split: 09, Run: 03
None time:  1.2396535510197282
None Run 27:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 71.70
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.65)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.4642090008128434
None Run 28:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 83.33
   Final Test: 70.30
Split: 10, Run: 02
None time:  1.4256389040965587
None Run 29:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 90.00
   Final Test: 64.60
Split: 10, Run: 03
None time:  1.3481173450127244
None Run 30:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 96.67
   Final Test: 63.80
run time now: 4.284399032592773
total time:  41.14918101602234
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.63 ± 4.13
  Final Train: 95.78 ± 5.93
   Final Test: 71.93 ± 4.37
best run test_acc: 74.48999786376953
[I 2023-06-12 00:50:57,453] Trial 50 finished with value: 72.63333129882812 and parameters: {'Fwd': 9.049641257799903e-06, 'K': 7, 'alpha': 0.65, 'dropout': 0.1, 'gnnepoch': 110, 'lambda1': 0.9500000000000001, 'lambda2': 8.261237776620119, 'loop': 1, 'loss': 'CE', 'lr': 0.003425257204791986, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.0006036468426131383, 'weightedloss': True}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.9500000000000001
lr:  0.002550375005708369
weight_decay:  0.00013995121342776784
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.196459332946688
None Run 01:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 100.00
   Final Test: 67.20
Split: 01, Run: 02
None time:  1.2836109281051904
None Run 02:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 77.80
Split: 01, Run: 03
None time:  1.2658894159831107
None Run 03:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 96.67
   Final Test: 74.20
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.2214757178444415
None Run 04:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
Split: 02, Run: 02
None time:  1.2375749358907342
None Run 05:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
Split: 02, Run: 03
None time:  1.1600383839104325
None Run 06:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.70
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1416915031149983
None Run 07:
Highest Train: 100.00
Highest Valid: 61.80
  Final Train: 100.00
   Final Test: 66.40
Split: 03, Run: 02
None time:  1.3405442291405052
None Run 08:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 93.33
   Final Test: 71.50
Split: 03, Run: 03
None time:  1.1829312888439745
None Run 09:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 71.40
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.2048457290511578
None Run 10:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 65.60
Split: 04, Run: 02
None time:  1.1952849170193076
None Run 11:
Highest Train: 100.00
Highest Valid: 68.20
  Final Train: 86.67
   Final Test: 62.20
Split: 04, Run: 03
None time:  1.3163348380476236
None Run 12:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 83.33
   Final Test: 59.80
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.3401528301183134
None Run 13:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 74.10
Split: 05, Run: 02
None time:  1.2842518619727343
None Run 14:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 76.10
Split: 05, Run: 03
None time:  1.3111631229985505
None Run 15:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 76.67
   Final Test: 75.60
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.2920262101106346
None Run 16:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 73.00
Split: 06, Run: 02
None time:  1.188767717918381
None Run 17:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 71.00
Split: 06, Run: 03
None time:  1.4981461020652205
None Run 18:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 66.67
   Final Test: 69.00
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.113060618052259
None Run 19:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 75.70
Split: 07, Run: 02
None time:  1.22543452703394
None Run 20:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 73.20
Split: 07, Run: 03
None time:  1.2179312040098011
None Run 21:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 73.10
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.2190570309758186
None Run 22:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 71.70
Split: 08, Run: 02
None time:  1.180295049911365
None Run 23:
Highest Train: 100.00
Highest Valid: 80.00
  Final Train: 96.67
   Final Test: 79.10
Split: 08, Run: 03
None time:  1.2917767851613462
None Run 24:
Highest Train: 100.00
Highest Valid: 79.40
  Final Train: 100.00
   Final Test: 77.80
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.2270870758220553
None Run 25:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 70.00
Split: 09, Run: 02
None time:  1.2675132448785007
None Run 26:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 78.00
Split: 09, Run: 03
None time:  1.1963347350247204
None Run 27:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 78.10
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.2142516949679703
None Run 28:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 69.60
Split: 10, Run: 02
None time:  1.391949076205492
None Run 29:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 86.67
   Final Test: 62.50
Split: 10, Run: 03
None time:  1.4035218399949372
None Run 30:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 76.67
   Final Test: 61.10
run time now: 4.054358005523682
total time:  38.64915597694926
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.73 ± 4.47
  Final Train: 95.44 ± 8.86
   Final Test: 71.23 ± 5.27
best run test_acc: 73.72000122070312
[I 2023-06-12 00:51:36,537] Trial 51 finished with value: 72.72666931152344 and parameters: {'Fwd': 1.3724186725780767e-05, 'K': 6, 'alpha': 0.9500000000000001, 'dropout': 0.0, 'gnnepoch': 100, 'lambda1': 0.8, 'lambda2': 8.85353578019719, 'loop': 2, 'loss': 'CE', 'lr': 0.002550375005708369, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.00013995121342776784, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  8
alpha:  0.8500000000000001
lr:  0.0021119417000546904
weight_decay:  3.97903201536594e-05
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.2014898450579494
None Run 01:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 64.90
Split: 01, Run: 02
None time:  1.1645358810201287
None Run 02:
Highest Train: 100.00
Highest Valid: 69.60
  Final Train: 100.00
   Final Test: 70.40
Split: 01, Run: 03
None time:  1.3097721470985562
None Run 03:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 93.33
   Final Test: 70.80
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.2469696579501033
None Run 04:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 72.70
Split: 02, Run: 02
None time:  1.1718613780103624
None Run 05:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 71.30
Split: 02, Run: 03
None time:  1.132984871044755
None Run 06:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 71.10
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1697214478626847
None Run 07:
Highest Train: 100.00
Highest Valid: 62.40
  Final Train: 100.00
   Final Test: 68.30
Split: 03, Run: 02
None time:  1.0976940768305212
None Run 08:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 69.50
Split: 03, Run: 03
None time:  1.1117317639291286
None Run 09:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 69.70
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.1141758391167969
None Run 10:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 64.00
Split: 04, Run: 02
None time:  1.3347934980411083
None Run 11:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 76.67
   Final Test: 69.00
Split: 04, Run: 03
None time:  1.2926559508778155
None Run 12:
Highest Train: 100.00
Highest Valid: 67.20
  Final Train: 86.67
   Final Test: 61.10
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.1473554419353604
None Run 13:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 66.60
Split: 05, Run: 02
None time:  1.2120179689954966
None Run 14:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 77.40
Split: 05, Run: 03
None time:  1.247556732967496
None Run 15:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 90.00
   Final Test: 75.60
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.262787344865501
None Run 16:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 76.50
Split: 06, Run: 02
None time:  1.1790142359677702
None Run 17:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 96.67
   Final Test: 72.80
Split: 06, Run: 03
None time:  1.2870289529673755
None Run 18:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 71.60
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.200861003017053
None Run 19:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 74.80
Split: 07, Run: 02
None time:  1.1798684599343687
None Run 20:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 72.10
Split: 07, Run: 03
None time:  1.2132034848909825
None Run 21:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 73.20
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.2461487359832972
None Run 22:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 96.67
   Final Test: 77.40
Split: 08, Run: 02
None time:  1.3286442691460252
None Run 23:
Highest Train: 100.00
Highest Valid: 79.40
  Final Train: 96.67
   Final Test: 80.00
Split: 08, Run: 03
None time:  1.097150760004297
None Run 24:
Highest Train: 100.00
Highest Valid: 80.40
  Final Train: 100.00
   Final Test: 79.50
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.1385727520100772
None Run 25:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 100.00
   Final Test: 72.70
Split: 09, Run: 02
None time:  1.20309719000943
None Run 26:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 96.67
   Final Test: 78.70
Split: 09, Run: 03
None time:  1.082463638857007
None Run 27:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 78.70
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=8, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.2308306619524956
None Run 28:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 68.60
Split: 10, Run: 02
None time:  1.2284342790953815
None Run 29:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 66.40
Split: 10, Run: 03
None time:  1.1397221609950066
None Run 30:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 64.30
run time now: 3.6428563594818115
total time:  37.19197167013772
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.39 ± 5.05
  Final Train: 97.78 ± 5.13
   Final Test: 71.66 ± 4.96
best run test_acc: 73.81999969482422
[I 2023-06-12 00:52:14,180] Trial 52 finished with value: 72.3933334350586 and parameters: {'Fwd': 4.657059367001844e-06, 'K': 8, 'alpha': 0.8500000000000001, 'dropout': 0.0, 'gnnepoch': 100, 'lambda1': 0.75, 'lambda2': 8.839472305937969, 'loop': 1, 'loss': 'CE', 'lr': 0.0021119417000546904, 'softmaxF': False, 'useGCN': False, 'weight_decay': 3.97903201536594e-05, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  1.0
lr:  0.004872593113782143
weight_decay:  0.00020426387129201767
dropout:  0.0
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.221582650905475
None Run 01:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 72.50
Split: 01, Run: 02
None time:  1.0361654059961438
None Run 02:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 77.40
Split: 01, Run: 03
None time:  1.18779343389906
None Run 03:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 93.33
   Final Test: 75.70
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.1570761469192803
None Run 04:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.10
Split: 02, Run: 02
None time:  1.1410378359723836
None Run 05:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 73.70
Split: 02, Run: 03
None time:  1.1188156420830637
None Run 06:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.10
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.1886146708857268
None Run 07:
Highest Train: 100.00
Highest Valid: 61.20
  Final Train: 100.00
   Final Test: 65.90
Split: 03, Run: 02
None time:  1.1617106688208878
None Run 08:
Highest Train: 100.00
Highest Valid: 61.80
  Final Train: 100.00
   Final Test: 65.80
Split: 03, Run: 03
None time:  1.2019879871513695
None Run 09:
Highest Train: 100.00
Highest Valid: 60.60
  Final Train: 100.00
   Final Test: 64.30
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.2521253428421915
None Run 10:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 90.00
   Final Test: 66.80
Split: 04, Run: 02
None time:  1.2254432491026819
None Run 11:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 90.00
   Final Test: 59.90
Split: 04, Run: 03
None time:  1.1845439730677754
None Run 12:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 63.50
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.0743831479921937
None Run 13:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 65.10
Split: 05, Run: 02
None time:  1.1997774508781731
None Run 14:
Highest Train: 100.00
Highest Valid: 79.20
  Final Train: 100.00
   Final Test: 78.00
Split: 05, Run: 03
None time:  1.202599158976227
None Run 15:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 100.00
   Final Test: 77.60
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.175129656912759
None Run 16:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 72.30
Split: 06, Run: 02
None time:  1.7100335420109332
None Run 17:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 73.33
   Final Test: 69.20
Split: 06, Run: 03
None time:  1.488195309881121
None Run 18:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 70.00
   Final Test: 69.40
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.0924852380994707
None Run 19:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 76.00
Split: 07, Run: 02
None time:  1.1147252139635384
None Run 20:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 71.90
Split: 07, Run: 03
None time:  1.1513363511767238
None Run 21:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 73.10
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.0988509361632168
None Run 22:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 72.20
Split: 08, Run: 02
None time:  1.0118336449377239
None Run 23:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 76.00
Split: 08, Run: 03
None time:  1.1491377411875874
None Run 24:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 96.67
   Final Test: 78.60
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.1868781270459294
None Run 25:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 75.90
Split: 09, Run: 02
None time:  1.3168614469468594
None Run 26:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 96.67
   Final Test: 77.00
Split: 09, Run: 03
None time:  1.1949296209495515
None Run 27:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 77.70
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.0, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=1.0)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.1450664668809623
None Run 28:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 69.60
Split: 10, Run: 02
None time:  1.225048623047769
None Run 29:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 93.33
   Final Test: 68.20
Split: 10, Run: 03
None time:  1.3237556791864336
None Run 30:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 80.00
   Final Test: 67.70
run time now: 3.736055374145508
total time:  37.02445943583734
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.39 ± 5.39
  Final Train: 96.11 ± 8.03
   Final Test: 71.44 ± 5.04
best run test_acc: 73.5999984741211
[I 2023-06-12 00:52:51,687] Trial 53 finished with value: 72.38666534423828 and parameters: {'Fwd': 1.2297042799886769e-05, 'K': 7, 'alpha': 1.0, 'dropout': 0.0, 'gnnepoch': 90, 'lambda1': 0.6000000000000001, 'lambda2': 9.510386868365075, 'loop': 2, 'loss': 'CE', 'lr': 0.004872593113782143, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.00020426387129201767, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  6
alpha:  0.9
lr:  0.0031146967408644498
weight_decay:  0.0002999005194451958
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.4616614659316838
None Run 01:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 100.00
   Final Test: 68.80
Split: 01, Run: 02
None time:  1.319630976067856
None Run 02:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 96.67
   Final Test: 78.00
Split: 01, Run: 03
None time:  1.4801205180119723
None Run 03:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 93.33
   Final Test: 76.90
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.4175362279638648
None Run 04:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.80
Split: 02, Run: 02
None time:  1.3946872369851917
None Run 05:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 72.60
Split: 02, Run: 03
None time:  1.2959524940233678
None Run 06:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 70.80
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.9645501119084656
None Run 07:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 73.33
   Final Test: 68.00
Split: 03, Run: 02
None time:  1.4133781739510596
None Run 08:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 73.30
Split: 03, Run: 03
None time:  1.4064472848549485
None Run 09:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 72.90
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.3756951340474188
None Run 10:
Highest Train: 100.00
Highest Valid: 65.40
  Final Train: 100.00
   Final Test: 63.60
Split: 04, Run: 02
None time:  1.4918363350443542
None Run 11:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 86.67
   Final Test: 64.90
Split: 04, Run: 03
None time:  1.5501516188960522
None Run 12:
Highest Train: 100.00
Highest Valid: 67.60
  Final Train: 86.67
   Final Test: 60.80
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.3287350051105022
None Run 13:
Highest Train: 100.00
Highest Valid: 62.40
  Final Train: 100.00
   Final Test: 66.50
Split: 05, Run: 02
None time:  1.4648409651126713
None Run 14:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 76.50
Split: 05, Run: 03
None time:  1.386622061021626
None Run 15:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 76.60
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.498989833984524
None Run 16:
Highest Train: 100.00
Highest Valid: 80.80
  Final Train: 96.67
   Final Test: 74.40
Split: 06, Run: 02
None time:  1.463685718132183
None Run 17:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 71.30
Split: 06, Run: 03
None time:  1.367351665860042
None Run 18:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 70.70
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.3301988751627505
None Run 19:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 72.50
Split: 07, Run: 02
None time:  1.4132495319936424
None Run 20:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 73.10
Split: 07, Run: 03
None time:  1.3676260029897094
None Run 21:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 73.20
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.408085020026192
None Run 22:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 74.10
Split: 08, Run: 02
None time:  1.4384778160601854
None Run 23:
Highest Train: 100.00
Highest Valid: 80.00
  Final Train: 100.00
   Final Test: 80.90
Split: 08, Run: 03
None time:  1.3973982178140432
None Run 24:
Highest Train: 100.00
Highest Valid: 80.80
  Final Train: 100.00
   Final Test: 79.60
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.4372714031487703
None Run 25:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 77.00
Split: 09, Run: 02
None time:  1.4218154978007078
None Run 26:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 78.80
Split: 09, Run: 03
None time:  1.3518170879688114
None Run 27:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 78.70
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=6, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.350890007102862
None Run 28:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 69.40
Split: 10, Run: 02
None time:  1.299466728931293
None Run 29:
Highest Train: 100.00
Highest Valid: 68.00
  Final Train: 100.00
   Final Test: 64.10
Split: 10, Run: 03
None time:  1.4003951309714466
None Run 30:
Highest Train: 100.00
Highest Valid: 69.00
  Final Train: 93.33
   Final Test: 62.30
run time now: 4.102210760116577
total time:  43.954502681968734
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 73.14 ± 4.72
  Final Train: 97.56 ± 5.87
   Final Test: 72.04 ± 5.39
best run test_acc: 74.21000671386719
[I 2023-06-12 00:53:36,147] Trial 54 finished with value: 73.13999938964844 and parameters: {'Fwd': 1.724900829850144e-05, 'K': 6, 'alpha': 0.9, 'dropout': 0.1, 'gnnepoch': 120, 'lambda1': 0.9, 'lambda2': 8.456514390139235, 'loop': 1, 'loss': 'CE', 'lr': 0.0031146967408644498, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.0002999005194451958, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  7
alpha:  0.9
lr:  0.003031068947799603
weight_decay:  0.00027117307386200314
dropout:  0.1
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.4287171140313148
None Run 01:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 65.70
Split: 01, Run: 02
None time:  1.4544516440946609
None Run 02:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 73.00
Split: 01, Run: 03
None time:  1.4427967797964811
None Run 03:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 96.67
   Final Test: 76.80
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.378665235126391
None Run 04:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.10
Split: 02, Run: 02
None time:  1.467330961022526
None Run 05:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 73.10
Split: 02, Run: 03
None time:  1.3620049790479243
None Run 06:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.10
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.476284080883488
None Run 07:
Highest Train: 100.00
Highest Valid: 62.80
  Final Train: 100.00
   Final Test: 67.90
Split: 03, Run: 02
None time:  1.4046874269843102
None Run 08:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 69.60
Split: 03, Run: 03
None time:  1.4100906029343605
None Run 09:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 70.60
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.3689468121156096
None Run 10:
Highest Train: 100.00
Highest Valid: 65.60
  Final Train: 100.00
   Final Test: 63.50
Split: 04, Run: 02
None time:  1.7258953789714724
None Run 11:
Highest Train: 100.00
Highest Valid: 70.40
  Final Train: 73.33
   Final Test: 66.00
Split: 04, Run: 03
None time:  1.4857768770307302
None Run 12:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 83.33
   Final Test: 61.90
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.4044888960197568
None Run 13:
Highest Train: 100.00
Highest Valid: 62.60
  Final Train: 100.00
   Final Test: 65.10
Split: 05, Run: 02
None time:  1.4970154841430485
None Run 14:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 96.67
   Final Test: 77.00
Split: 05, Run: 03
None time:  1.5863177960272878
None Run 15:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 90.00
   Final Test: 76.00
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.2509676788467914
None Run 16:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 74.70
Split: 06, Run: 02
None time:  1.3368530680891126
None Run 17:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 71.80
Split: 06, Run: 03
None time:  1.4914223328232765
None Run 18:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 86.67
   Final Test: 71.40
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.341552885947749
None Run 19:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 75.70
Split: 07, Run: 02
None time:  1.494352346053347
None Run 20:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 73.80
Split: 07, Run: 03
None time:  1.4500343219842762
None Run 21:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 73.50
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.337534214137122
None Run 22:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 76.10
Split: 08, Run: 02
None time:  1.4307552129030228
None Run 23:
Highest Train: 100.00
Highest Valid: 79.80
  Final Train: 96.67
   Final Test: 79.80
Split: 08, Run: 03
None time:  1.404822634998709
None Run 24:
Highest Train: 100.00
Highest Valid: 81.20
  Final Train: 100.00
   Final Test: 79.70
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.4490387490950525
None Run 25:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 77.00
Split: 09, Run: 02
None time:  1.4408174301497638
None Run 26:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 96.67
   Final Test: 78.30
Split: 09, Run: 03
None time:  1.3433588398620486
None Run 27:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 78.80
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.1, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=7, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.3390938218217343
None Run 28:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 69.40
Split: 10, Run: 02
None time:  1.4421157189644873
None Run 29:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 100.00
   Final Test: 65.10
Split: 10, Run: 03
None time:  1.4948120918124914
None Run 30:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 93.33
   Final Test: 62.30
run time now: 4.322439193725586
total time:  44.10837372811511
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.71 ± 4.90
  Final Train: 97.11 ± 6.17
   Final Test: 71.86 ± 5.29
best run test_acc: 74.19000244140625
[I 2023-06-12 00:54:20,701] Trial 55 finished with value: 72.71333312988281 and parameters: {'Fwd': 4.338095405113929e-05, 'K': 7, 'alpha': 0.9, 'dropout': 0.1, 'gnnepoch': 120, 'lambda1': 1.0, 'lambda2': 8.012792782643041, 'loop': 1, 'loss': 'CE', 'lr': 0.003031068947799603, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.00027117307386200314, 'weightedloss': False}. Best is trial 13 with value: 73.30667114257812.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  10
alpha:  0.8500000000000001
lr:  0.0035992445418965434
weight_decay:  0.00037414572828899133
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.5558817191049457
None Run 01:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 69.20
Split: 01, Run: 02
None time:  1.4952766979113221
None Run 02:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 72.80
Split: 01, Run: 03
None time:  1.6335748101118952
None Run 03:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 96.67
   Final Test: 77.90
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.4100187460426241
None Run 04:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 02
None time:  1.4737495980225503
None Run 05:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 73.30
Split: 02, Run: 03
None time:  1.317282411037013
None Run 06:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 71.20
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.5466077919118106
None Run 07:
Highest Train: 100.00
Highest Valid: 64.80
  Final Train: 100.00
   Final Test: 70.30
Split: 03, Run: 02
None time:  1.5600780481472611
None Run 08:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 100.00
   Final Test: 71.80
Split: 03, Run: 03
None time:  1.435470815980807
None Run 09:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 100.00
   Final Test: 71.70
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.4426915380172431
None Run 10:
Highest Train: 100.00
Highest Valid: 65.20
  Final Train: 100.00
   Final Test: 62.20
Split: 04, Run: 02
None time:  1.5488061681389809
None Run 11:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 83.33
   Final Test: 63.70
Split: 04, Run: 03
None time:  1.6891772800590843
None Run 12:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 83.33
   Final Test: 61.20
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.481480009155348
None Run 13:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 66.90
Split: 05, Run: 02
None time:  1.4961856987792999
None Run 14:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 77.30
Split: 05, Run: 03
None time:  1.593197951093316
None Run 15:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 80.00
   Final Test: 75.60
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.5649146819487214
None Run 16:
Highest Train: 100.00
Highest Valid: 81.80
  Final Train: 100.00
   Final Test: 77.40
Split: 06, Run: 02
None time:  1.5326648659538478
None Run 17:
Highest Train: 100.00
Highest Valid: 79.00
  Final Train: 100.00
   Final Test: 73.90
Split: 06, Run: 03
None time:  1.5493897791020572
None Run 18:
Highest Train: 100.00
Highest Valid: 78.80
  Final Train: 100.00
   Final Test: 73.10
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.4107771290000528
None Run 19:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 75.40
Split: 07, Run: 02
None time:  1.4511089229490608
None Run 20:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 73.50
Split: 07, Run: 03
None time:  1.5092127909883857
None Run 21:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 73.30
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.5032778980676085
None Run 22:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 76.90
Split: 08, Run: 02
None time:  1.4714320360217243
None Run 23:
Highest Train: 100.00
Highest Valid: 80.40
  Final Train: 100.00
   Final Test: 80.60
Split: 08, Run: 03
None time:  1.5125403101556003
None Run 24:
Highest Train: 100.00
Highest Valid: 80.60
  Final Train: 100.00
   Final Test: 79.00
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.70758175291121
None Run 25:
Highest Train: 100.00
Highest Valid: 79.60
  Final Train: 100.00
   Final Test: 77.10
Split: 09, Run: 02
None time:  1.4645146350376308
None Run 26:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 78.30
Split: 09, Run: 03
None time:  1.6462988341227174
None Run 27:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 96.67
   Final Test: 78.90
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.4842560929246247
None Run 28:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 69.60
Split: 10, Run: 02
None time:  1.4568904771003872
None Run 29:
Highest Train: 100.00
Highest Valid: 70.20
  Final Train: 93.33
   Final Test: 67.30
Split: 10, Run: 03
None time:  1.458400597795844
None Run 30:
Highest Train: 100.00
Highest Valid: 68.60
  Final Train: 93.33
   Final Test: 63.70
run time now: 4.450929880142212
total time:  46.70640707015991
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 73.59 ± 4.81
  Final Train: 97.56 ± 5.53
   Final Test: 72.48 ± 5.24
best run test_acc: 74.59000396728516
[I 2023-06-12 00:55:07,902] Trial 56 finished with value: 73.59333801269531 and parameters: {'Fwd': 1.9231476532611012e-05, 'K': 10, 'alpha': 0.8500000000000001, 'dropout': 0.30000000000000004, 'gnnepoch': 120, 'lambda1': 0.8500000000000001, 'lambda2': 8.378706907891196, 'loop': 1, 'loss': 'CE', 'lr': 0.0035992445418965434, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.00037414572828899133, 'weightedloss': False}. Best is trial 56 with value: 73.59333801269531.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  10
alpha:  0.4
lr:  0.00342640552622285
weight_decay:  0.06403539240838346
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  2.6284517750609666
None Run 01:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 96.67
   Final Test: 78.80
Split: 01, Run: 02
None time:  2.757793281925842
None Run 02:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 96.67
   Final Test: 76.10
Split: 01, Run: 03
None time:  2.732824784005061
None Run 03:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 96.67
   Final Test: 78.30
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  2.598860400961712
None Run 04:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 02
None time:  2.5687710819765925
None Run 05:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 03
None time:  2.5401011048816144
None Run 06:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 71.20
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  2.6113150941673666
None Run 07:
Highest Train: 100.00
Highest Valid: 63.00
  Final Train: 100.00
   Final Test: 68.10
Split: 03, Run: 02
None time:  2.378882225137204
None Run 08:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 67.60
Split: 03, Run: 03
None time:  2.3723033191636205
None Run 09:
Highest Train: 100.00
Highest Valid: 63.20
  Final Train: 100.00
   Final Test: 67.70
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  2.5357808959670365
None Run 10:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 67.10
Split: 04, Run: 02
None time:  2.5745534680318087
None Run 11:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 67.30
Split: 04, Run: 03
None time:  2.647464018082246
None Run 12:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 67.00
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  2.4976253940258175
None Run 13:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 100.00
   Final Test: 70.40
Split: 05, Run: 02
None time:  2.4958219351246953
None Run 14:
Highest Train: 100.00
Highest Valid: 67.00
  Final Train: 100.00
   Final Test: 69.80
Split: 05, Run: 03
None time:  2.573034194065258
None Run 15:
Highest Train: 100.00
Highest Valid: 66.20
  Final Train: 100.00
   Final Test: 70.70
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  2.546950836898759
None Run 16:
Highest Train: 100.00
Highest Valid: 79.20
  Final Train: 100.00
   Final Test: 72.80
Split: 06, Run: 02
None time:  2.4849026191513985
None Run 17:
Highest Train: 100.00
Highest Valid: 79.40
  Final Train: 100.00
   Final Test: 73.00
Split: 06, Run: 03
None time:  2.5054781090002507
None Run 18:
Highest Train: 100.00
Highest Valid: 78.80
  Final Train: 100.00
   Final Test: 73.40
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  2.5403570029884577
None Run 19:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 73.30
Split: 07, Run: 02
None time:  2.54661298613064
None Run 20:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 73.50
Split: 07, Run: 03
None time:  2.5304400068707764
None Run 21:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 73.30
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  2.5822751680389047
None Run 22:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 96.67
   Final Test: 77.50
Split: 08, Run: 02
None time:  2.659681231016293
None Run 23:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 96.67
   Final Test: 77.40
Split: 08, Run: 03
None time:  2.489828187972307
None Run 24:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 96.67
   Final Test: 78.10
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  2.6213135451544076
None Run 25:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 76.20
Split: 09, Run: 02
None time:  2.655229668132961
None Run 26:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 76.80
Split: 09, Run: 03
None time:  2.580430167960003
None Run 27:
Highest Train: 100.00
Highest Valid: 79.60
  Final Train: 100.00
   Final Test: 77.00
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.4)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  2.657994308974594
None Run 28:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 68.70
Split: 10, Run: 02
None time:  2.708984092110768
None Run 29:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 67.10
Split: 10, Run: 03
None time:  2.6821131999604404
None Run 30:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 68.00
run time now: 8.149340391159058
total time:  78.62170953699388
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.57 ± 4.87
  Final Train: 99.33 ± 1.36
   Final Test: 72.29 ± 3.97
best run test_acc: 72.68000030517578
[I 2023-06-12 00:56:26,960] Trial 57 finished with value: 72.56666564941406 and parameters: {'Fwd': 2.0484071269088035e-05, 'K': 10, 'alpha': 0.4, 'dropout': 0.30000000000000004, 'gnnepoch': 120, 'lambda1': 0.8500000000000001, 'lambda2': 6.891344959550368, 'loop': 1, 'loss': 'CE', 'lr': 0.00342640552622285, 'softmaxF': False, 'useGCN': True, 'weight_decay': 0.06403539240838346, 'weightedloss': False}. Best is trial 56 with value: 73.59333801269531.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  10
alpha:  0.8
lr:  0.007400046080520157
weight_decay:  0.0005671157287885332
dropout:  0.4
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 01, Run: 01, Epoch: 100, Loss: 0.0266, Train: 100.00%, Valid: 69.80% Test: 69.70%
Split: 01, Run: 01
None time:  4.197188331978396
None Run 01:
Highest Train: 100.00
Highest Valid: 69.80
  Final Train: 100.00
   Final Test: 69.80
Split: 01, Run: 02
None time:  3.26546579785645
None Run 02:
Highest Train: 100.00
Highest Valid: 72.00
  Final Train: 100.00
   Final Test: 71.60
Split: 01, Run: 03
None time:  1.5130603960715234
None Run 03:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 70.40
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.4493451151065528
None Run 04:
Highest Train: 100.00
Highest Valid: 72.60
  Final Train: 100.00
   Final Test: 70.60
Split: 02, Run: 02
None time:  1.5991965308785439
None Run 05:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 72.10
Split: 02, Run: 03
None time:  1.6216762990225106
None Run 06:
Highest Train: 100.00
Highest Valid: 73.00
  Final Train: 100.00
   Final Test: 71.70
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.684145940002054
None Run 07:
Highest Train: 100.00
Highest Valid: 71.60
  Final Train: 100.00
   Final Test: 73.50
Split: 03, Run: 02
None time:  1.7037755099590868
None Run 08:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 71.40
Split: 03, Run: 03
None time:  1.7406500440556556
None Run 09:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 70.60
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.4675981658510864
None Run 10:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 62.70
Split: 04, Run: 02, Epoch: 100, Loss: 0.0229, Train: 100.00%, Valid: 70.00% Test: 67.00%
Split: 04, Run: 02
None time:  4.150384405162185
None Run 11:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 67.10
Split: 04, Run: 03
None time:  1.5108588519506156
None Run 12:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 62.70
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.665713906986639
None Run 13:
Highest Train: 100.00
Highest Valid: 68.40
  Final Train: 100.00
   Final Test: 73.70
Split: 05, Run: 02
None time:  1.6953964419662952
None Run 14:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 76.20
Split: 05, Run: 03
None time:  1.52540772408247
None Run 15:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 76.30
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.6363108169753104
None Run 16:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 72.30
Split: 06, Run: 02
None time:  1.5472905118949711
None Run 17:
Highest Train: 100.00
Highest Valid: 74.20
  Final Train: 100.00
   Final Test: 73.10
Split: 06, Run: 03
None time:  1.713762141065672
None Run 18:
Highest Train: 100.00
Highest Valid: 79.40
  Final Train: 100.00
   Final Test: 78.10
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.5007745088078082
None Run 19:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 71.80
Split: 07, Run: 02
None time:  1.5964282311033458
None Run 20:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 72.00
Split: 07, Run: 03
None time:  1.4484308371320367
None Run 21:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 100.00
   Final Test: 71.00
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.7975466309580952
None Run 22:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 78.20
Split: 08, Run: 02
None time:  1.6282203570008278
None Run 23:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 79.00
Split: 08, Run: 03
None time:  1.8548850240185857
None Run 24:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 79.60
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  3.373392201960087
None Run 25:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 100.00
   Final Test: 75.90
Split: 09, Run: 02
None time:  1.557592002907768
None Run 26:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 76.40
Split: 09, Run: 03
None time:  1.563409429974854
None Run 27:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 100.00
   Final Test: 76.70
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): Identity()
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.8)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): Identity()
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  2.33804974402301
None Run 28:
Highest Train: 100.00
Highest Valid: 70.60
  Final Train: 100.00
   Final Test: 65.60
Split: 10, Run: 02
None time:  2.0716476489324123
None Run 29:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 66.90
Split: 10, Run: 03
None time:  1.6134430370293558
None Run 30:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 66.40
run time now: 6.072831630706787
total time:  59.20599897298962
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 72.33 ± 4.00
  Final Train: 100.00 ± 0.00
   Final Test: 72.11 ± 4.51
best run test_acc: 73.38999938964844
[I 2023-06-12 00:57:26,658] Trial 58 finished with value: 72.33333587646484 and parameters: {'Fwd': 1.7844396705170406e-05, 'K': 10, 'alpha': 0.8, 'dropout': 0.4, 'gnnepoch': 120, 'lambda1': 0.9, 'lambda2': 7.375465812855273, 'loop': 1, 'loss': 'MSE', 'lr': 0.007400046080520157, 'softmaxF': False, 'useGCN': False, 'weight_decay': 0.0005671157287885332, 'weightedloss': False}. Best is trial 56 with value: 73.59333801269531.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  9
alpha:  0.75
lr:  0.006108597134515425
weight_decay:  0.0009383927905131305
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.4357392720412463
None Run 01:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 96.67
   Final Test: 75.00
Split: 01, Run: 02
None time:  1.6246923450380564
None Run 02:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 96.67
   Final Test: 76.90
Split: 01, Run: 03
None time:  1.5015238700434566
None Run 03:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 96.67
   Final Test: 77.60
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.4045052588917315
None Run 04:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 74.30
Split: 02, Run: 02
None time:  1.1401843309868127
None Run 05:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 03
None time:  1.3948915170039982
None Run 06:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 96.67
   Final Test: 73.70
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.7577431369572878
None Run 07:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 86.67
   Final Test: 70.70
Split: 03, Run: 02
None time:  1.620819381903857
None Run 08:
Highest Train: 100.00
Highest Valid: 66.40
  Final Train: 90.00
   Final Test: 66.90
Split: 03, Run: 03
None time:  1.3799237869679928
None Run 09:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 62.20
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.5023900850210339
None Run 10:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 93.33
   Final Test: 66.30
Split: 04, Run: 02
None time:  1.5884745351504534
None Run 11:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 93.33
   Final Test: 70.30
Split: 04, Run: 03
None time:  1.5132179639767855
None Run 12:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 93.33
   Final Test: 70.40
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.4823640261311084
None Run 13:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 93.33
   Final Test: 73.70
Split: 05, Run: 02
None time:  1.3725670271087438
None Run 14:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 75.50
Split: 05, Run: 03
None time:  1.437787420116365
None Run 15:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 74.50
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.3824753039516509
None Run 16:
Highest Train: 100.00
Highest Valid: 81.60
  Final Train: 96.67
   Final Test: 76.50
Split: 06, Run: 02
None time:  1.3489349170122296
None Run 17:
Highest Train: 100.00
Highest Valid: 82.20
  Final Train: 100.00
   Final Test: 77.60
Split: 06, Run: 03
None time:  1.339060238795355
None Run 18:
Highest Train: 100.00
Highest Valid: 79.40
  Final Train: 100.00
   Final Test: 74.50
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.3635174178052694
None Run 19:
Highest Train: 100.00
Highest Valid: 73.40
  Final Train: 100.00
   Final Test: 73.40
Split: 07, Run: 02
None time:  1.283557795919478
None Run 20:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 66.90
Split: 07, Run: 03
None time:  1.2725973650813103
None Run 21:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 66.90
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.4099396069068462
None Run 22:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 77.20
Split: 08, Run: 02
None time:  1.3227343140169978
None Run 23:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 77.40
Split: 08, Run: 03
None time:  1.4944478659890592
None Run 24:
Highest Train: 100.00
Highest Valid: 78.00
  Final Train: 96.67
   Final Test: 78.90
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.3097564030904323
None Run 25:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 72.80
Split: 09, Run: 02
None time:  1.3035803309176117
None Run 26:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 72.80
Split: 09, Run: 03
None time:  1.3718965218868107
None Run 27:
Highest Train: 100.00
Highest Valid: 75.40
  Final Train: 100.00
   Final Test: 74.80
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.4060406449716538
None Run 28:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 71.80
Split: 10, Run: 02
None time:  1.5227261050604284
None Run 29:
Highest Train: 100.00
Highest Valid: 76.40
  Final Train: 96.67
   Final Test: 74.30
Split: 10, Run: 03
None time:  1.4529019738547504
None Run 30:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 96.67
   Final Test: 73.60
run time now: 4.437106609344482
total time:  44.080649838084355
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 73.93 ± 4.89
  Final Train: 97.44 ± 3.47
   Final Test: 72.95 ± 3.99
best run test_acc: 74.75
[I 2023-06-12 00:58:11,225] Trial 59 finished with value: 73.92666625976562 and parameters: {'Fwd': 4.1924399102669885e-05, 'K': 9, 'alpha': 0.75, 'dropout': 0.30000000000000004, 'gnnepoch': 110, 'lambda1': 0.9, 'lambda2': 9.168649529525826, 'loop': 1, 'loss': 'CE', 'lr': 0.006108597134515425, 'softmaxF': True, 'useGCN': False, 'weight_decay': 0.0009383927905131305, 'weightedloss': False}. Best is trial 59 with value: 73.92666625976562.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  10
alpha:  0.75
lr:  0.009888957323393545
weight_decay:  0.001732743345345552
dropout:  0.30000000000000004
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  0.785759513033554
None Run 01:
Highest Train: 100.00
Highest Valid: 66.60
  Final Train: 100.00
   Final Test: 65.20
Split: 01, Run: 02
None time:  0.7515992310363799
None Run 02:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 67.40
Split: 01, Run: 03
None time:  0.7736926551442593
None Run 03:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 67.40
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  0.7334533480461687
None Run 04:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 02
None time:  0.7004175991751254
None Run 05:
Highest Train: 100.00
Highest Valid: 71.80
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 03
None time:  0.8176793828606606
None Run 06:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 96.67
   Final Test: 75.10
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  0.7899745779577643
None Run 07:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 69.00
Split: 03, Run: 02
None time:  0.7518438859842718
None Run 08:
Highest Train: 100.00
Highest Valid: 56.00
  Final Train: 100.00
   Final Test: 59.30
Split: 03, Run: 03
None time:  0.6723359150346369
None Run 09:
Highest Train: 100.00
Highest Valid: 59.40
  Final Train: 100.00
   Final Test: 60.80
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.4964862801134586
None Run 10:
Highest Train: 100.00
Highest Valid: 69.40
  Final Train: 100.00
   Final Test: 66.90
Split: 04, Run: 02
None time:  1.0140443400014192
None Run 11:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 93.33
   Final Test: 68.30
Split: 04, Run: 03
None time:  0.76428202399984
None Run 12:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 63.40
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  0.7260982100851834
None Run 13:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 66.90
Split: 05, Run: 02
None time:  0.7599668439943343
None Run 14:
Highest Train: 100.00
Highest Valid: 66.00
  Final Train: 100.00
   Final Test: 66.90
Split: 05, Run: 03
None time:  0.9453617979306728
None Run 15:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 72.60
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  0.6214787119533867
None Run 16:
Highest Train: 100.00
Highest Valid: 81.40
  Final Train: 100.00
   Final Test: 77.10
Split: 06, Run: 02
None time:  0.8557489409577101
None Run 17:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 96.67
   Final Test: 71.80
Split: 06, Run: 03
None time:  0.7918380140326917
None Run 18:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 66.80
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  0.7633072850294411
None Run 19:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 73.60
Split: 07, Run: 02
None time:  0.8472157260403037
None Run 20:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 70.60
Split: 07, Run: 03
None time:  0.8244356629438698
None Run 21:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 69.30
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  0.8365216620732099
None Run 22:
Highest Train: 100.00
Highest Valid: 75.60
  Final Train: 100.00
   Final Test: 75.90
Split: 08, Run: 02
None time:  0.8294805057812482
None Run 23:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 96.67
   Final Test: 75.80
Split: 08, Run: 03
None time:  0.694952507968992
None Run 24:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 72.50
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  0.7806498080026358
None Run 25:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 72.80
Split: 09, Run: 02
None time:  0.7956039099954069
None Run 26:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 100.00
   Final Test: 72.80
Split: 09, Run: 03
None time:  1.028743693837896
None Run 27:
Highest Train: 100.00
Highest Valid: 78.40
  Final Train: 100.00
   Final Test: 76.70
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.30000000000000004, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=10, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.75)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  0.8162212558090687
None Run 28:
Highest Train: 100.00
Highest Valid: 66.80
  Final Train: 100.00
   Final Test: 64.40
Split: 10, Run: 02
None time:  0.8608430991880596
None Run 29:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 96.67
   Final Test: 69.60
Split: 10, Run: 03
None time:  0.8590518902055919
None Run 30:
Highest Train: 100.00
Highest Valid: 68.80
  Final Train: 100.00
   Final Test: 66.30
run time now: 2.5841150283813477
total time:  25.88166235992685
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 70.17 ± 5.58
  Final Train: 99.33 ± 1.61
   Final Test: 69.59 ± 4.55
best run test_acc: 72.5300064086914
[I 2023-06-12 00:58:37,548] Trial 60 finished with value: 70.16666412353516 and parameters: {'Fwd': 3.639565481080941e-05, 'K': 10, 'alpha': 0.75, 'dropout': 0.30000000000000004, 'gnnepoch': 50, 'lambda1': 0.9500000000000001, 'lambda2': 9.124533285310186, 'loop': 0, 'loss': 'CE', 'lr': 0.009888957323393545, 'softmaxF': True, 'useGCN': False, 'weight_decay': 0.001732743345345552, 'weightedloss': False}. Best is trial 59 with value: 73.92666625976562.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  9
alpha:  0.9
lr:  0.004751517317890495
weight_decay:  0.09965441895380325
dropout:  0.4
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.425626085139811
None Run 01:
Highest Train: 100.00
Highest Valid: 74.40
  Final Train: 100.00
   Final Test: 74.20
Split: 01, Run: 02
None time:  1.54168894700706
None Run 02:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 93.33
   Final Test: 76.50
Split: 01, Run: 03
None time:  1.5109330918639898
None Run 03:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 100.00
   Final Test: 75.20
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.3659948778804392
None Run 04:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 02
None time:  1.4350275439210236
None Run 05:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 71.20
Split: 02, Run: 03
None time:  1.3769705360755324
None Run 06:
Highest Train: 100.00
Highest Valid: 71.40
  Final Train: 100.00
   Final Test: 71.20
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.4915966200642288
None Run 07:
Highest Train: 100.00
Highest Valid: 64.20
  Final Train: 100.00
   Final Test: 69.20
Split: 03, Run: 02
None time:  1.3768528320360929
None Run 08:
Highest Train: 100.00
Highest Valid: 60.00
  Final Train: 100.00
   Final Test: 63.40
Split: 03, Run: 03
None time:  1.3728310470469296
None Run 09:
Highest Train: 100.00
Highest Valid: 60.00
  Final Train: 100.00
   Final Test: 61.80
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.791936363093555
None Run 10:
Highest Train: 100.00
Highest Valid: 70.00
  Final Train: 83.33
   Final Test: 65.60
Split: 04, Run: 02
None time:  1.6559543539769948
None Run 11:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 93.33
   Final Test: 68.10
Split: 04, Run: 03
None time:  1.5337699740193784
None Run 12:
Highest Train: 100.00
Highest Valid: 69.20
  Final Train: 93.33
   Final Test: 66.40
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.550828147912398
None Run 13:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 75.90
Split: 05, Run: 02
None time:  1.405620050849393
None Run 14:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 74.00
Split: 05, Run: 03
None time:  1.49228799296543
None Run 15:
Highest Train: 100.00
Highest Valid: 76.00
  Final Train: 100.00
   Final Test: 77.00
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.4958196880761534
None Run 16:
Highest Train: 100.00
Highest Valid: 80.40
  Final Train: 100.00
   Final Test: 74.20
Split: 06, Run: 02
None time:  1.3373460702132434
None Run 17:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 66.80
Split: 06, Run: 03
None time:  1.3715010909363627
None Run 18:
Highest Train: 100.00
Highest Valid: 71.20
  Final Train: 100.00
   Final Test: 66.80
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.3978485642001033
None Run 19:
Highest Train: 100.00
Highest Valid: 77.20
  Final Train: 100.00
   Final Test: 76.50
Split: 07, Run: 02
None time:  1.370507325977087
None Run 20:
Highest Train: 100.00
Highest Valid: 67.80
  Final Train: 100.00
   Final Test: 67.90
Split: 07, Run: 03
None time:  1.5412841860670596
None Run 21:
Highest Train: 100.00
Highest Valid: 73.80
  Final Train: 100.00
   Final Test: 73.70
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.4796847919933498
None Run 22:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 77.70
Split: 08, Run: 02
None time:  1.4126595149282366
None Run 23:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 77.10
Split: 08, Run: 03
None time:  1.469062973977998
None Run 24:
Highest Train: 100.00
Highest Valid: 78.60
  Final Train: 100.00
   Final Test: 79.50
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.504514078143984
None Run 25:
Highest Train: 100.00
Highest Valid: 79.60
  Final Train: 100.00
   Final Test: 78.30
Split: 09, Run: 02
None time:  1.515884455991909
None Run 26:
Highest Train: 100.00
Highest Valid: 80.60
  Final Train: 100.00
   Final Test: 78.80
Split: 09, Run: 03
None time:  1.5365360018331558
None Run 27:
Highest Train: 100.00
Highest Valid: 81.00
  Final Train: 100.00
   Final Test: 79.60
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.454680847004056
None Run 28:
Highest Train: 100.00
Highest Valid: 73.60
  Final Train: 100.00
   Final Test: 71.30
Split: 10, Run: 02
None time:  1.3841751241125166
None Run 29:
Highest Train: 100.00
Highest Valid: 77.80
  Final Train: 100.00
   Final Test: 72.30
Split: 10, Run: 03
None time:  1.4455242699477822
None Run 30:
Highest Train: 100.00
Highest Valid: 72.80
  Final Train: 100.00
   Final Test: 66.70
run time now: 4.3342883586883545
total time:  45.1700125169009
None All runs:
Highest Train: 100.00 ± 0.00
Highest Valid: 73.27 ± 5.40
  Final Train: 98.78 ± 3.55
   Final Test: 72.27 ± 5.05
best run test_acc: 74.41000366210938
[I 2023-06-12 00:59:23,162] Trial 61 finished with value: 73.26667022705078 and parameters: {'Fwd': 3.587768902096522e-05, 'K': 9, 'alpha': 0.9, 'dropout': 0.4, 'gnnepoch': 110, 'lambda1': 0.9, 'lambda2': 8.47014521501374, 'loop': 1, 'loss': 'CE', 'lr': 0.004751517317890495, 'softmaxF': True, 'useGCN': False, 'weight_decay': 0.09965441895380325, 'weightedloss': False}. Best is trial 59 with value: 73.92666625976562.
/home/wxy/miniconda3/lib/python3.10/site-packages/optuna/distributions.py:685: UserWarning: The distribution is specified by [0, 1.00001] and step=0.05, but the range is not divisible by `step`. It will be replaced by [0, 1.0].
  warnings.warn(
K:  9
alpha:  0.9500000000000001
lr:  0.0062458300435922305
weight_decay:  0.045448141007239116
dropout:  0.4
random split 10 times and each for 3 runs
len(train) 30
random split PubMed split 0
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 01, Run: 01
None time:  1.39053785498254
None Run 01:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 100.00
   Final Test: 76.90
Split: 01, Run: 02
None time:  1.29890450485982
None Run 02:
Highest Train: 100.00
Highest Valid: 75.00
  Final Train: 96.67
   Final Test: 76.60
Split: 01, Run: 03
None time:  1.5487342630513012
None Run 03:
Highest Train: 100.00
Highest Valid: 73.20
  Final Train: 100.00
   Final Test: 75.20
len(train) 30
random split PubMed split 1
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 02, Run: 01
None time:  1.5208466020412743
None Run 04:
Highest Train: 100.00
Highest Valid: 72.40
  Final Train: 100.00
   Final Test: 73.10
Split: 02, Run: 02
None time:  1.7110686858650297
None Run 05:
Highest Train: 100.00
Highest Valid: 77.40
  Final Train: 93.33
   Final Test: 76.30
Split: 02, Run: 03
None time:  1.5320063310209662
None Run 06:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 96.67
   Final Test: 75.00
len(train) 30
random split PubMed split 2
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 03, Run: 01
None time:  1.5361686379183084
None Run 07:
Highest Train: 100.00
Highest Valid: 63.80
  Final Train: 100.00
   Final Test: 68.20
Split: 03, Run: 02
None time:  1.5757625678088516
None Run 08:
Highest Train: 100.00
Highest Valid: 58.80
  Final Train: 100.00
   Final Test: 62.60
Split: 03, Run: 03
None time:  1.4889741919469088
None Run 09:
Highest Train: 100.00
Highest Valid: 62.00
  Final Train: 100.00
   Final Test: 65.70
len(train) 30
random split PubMed split 3
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 04, Run: 01
None time:  1.4553193810861558
None Run 10:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 63.80
Split: 04, Run: 02
None time:  1.4517813930287957
None Run 11:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 63.80
Split: 04, Run: 03
None time:  1.5277438429184258
None Run 12:
Highest Train: 100.00
Highest Valid: 64.40
  Final Train: 100.00
   Final Test: 63.80
len(train) 30
random split PubMed split 4
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 05, Run: 01
None time:  1.7348373159766197
None Run 13:
Highest Train: 100.00
Highest Valid: 75.80
  Final Train: 93.33
   Final Test: 74.40
Split: 05, Run: 02
None time:  1.7636783751659095
None Run 14:
Highest Train: 100.00
Highest Valid: 74.80
  Final Train: 96.67
   Final Test: 75.30
Split: 05, Run: 03
None time:  1.6402135509997606
None Run 15:
Highest Train: 100.00
Highest Valid: 75.20
  Final Train: 100.00
   Final Test: 77.50
len(train) 30
random split PubMed split 5
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 06, Run: 01
None time:  1.5496097460854799
None Run 16:
Highest Train: 100.00
Highest Valid: 80.80
  Final Train: 100.00
   Final Test: 75.00
Split: 06, Run: 02
None time:  1.5817359120119363
None Run 17:
Highest Train: 100.00
Highest Valid: 81.20
  Final Train: 96.67
   Final Test: 77.70
Split: 06, Run: 03
None time:  1.5423371200449765
None Run 18:
Highest Train: 100.00
Highest Valid: 76.80
  Final Train: 100.00
   Final Test: 72.90
len(train) 30
random split PubMed split 6
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 07, Run: 01
None time:  1.4390341290272772
None Run 19:
Highest Train: 100.00
Highest Valid: 76.20
  Final Train: 100.00
   Final Test: 76.10
Split: 07, Run: 02
None time:  1.486983569106087
None Run 20:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 76.60
Split: 07, Run: 03
None time:  1.5375063370447606
None Run 21:
Highest Train: 100.00
Highest Valid: 71.00
  Final Train: 100.00
   Final Test: 71.60
len(train) 30
random split PubMed split 7
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 08, Run: 01
None time:  1.6554189620073885
None Run 22:
Highest Train: 100.00
Highest Valid: 77.00
  Final Train: 100.00
   Final Test: 77.10
Split: 08, Run: 02
None time:  1.5832839750219136
None Run 23:
Highest Train: 100.00
Highest Valid: 77.60
  Final Train: 100.00
   Final Test: 77.90
Split: 08, Run: 03
None time:  1.499910247977823
None Run 24:
Highest Train: 100.00
Highest Valid: 78.20
  Final Train: 100.00
   Final Test: 77.70
len(train) 30
random split PubMed split 8
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 09, Run: 01
None time:  1.488197424216196
None Run 25:
Highest Train: 100.00
Highest Valid: 74.60
  Final Train: 100.00
   Final Test: 72.80
Split: 09, Run: 02
None time:  1.6663883090950549
None Run 26:
Highest Train: 100.00
Highest Valid: 79.20
  Final Train: 100.00
   Final Test: 76.70
Split: 09, Run: 03
None time:  1.4276540600694716
None Run 27:
Highest Train: 100.00
Highest Valid: 76.60
  Final Train: 100.00
   Final Test: 76.30
len(train) 30
random split PubMed split 9
Data: Data(x=[19717, 500], y=[19717], train_mask=[19717], val_mask=[19717], test_mask=[19717], adj_t=[19717, 19717, nnz=88648])
num_train tensor(30, device='cuda:0')
num_noise 0
noise: tensor(0)
data feature 500
ALTOPT(
  (lins): Sequential(
    (0): Linear(in_features=500, out_features=64, bias=True)
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.4, inplace=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=64, out_features=3, bias=True)
    (5): LogSoftmax(dim=-1)
  )
  (prop): Propagation(K=9, mode=None, lambda1=None, lambda2=None, L21=True, alpha=0.9500000000000001)
  (gcn): GCN(
    (convs): ModuleList(
      (0): GCNConv(500, 64)
      (1): GCNConv(64, 3)
    )
    (bns): ModuleList(
      (0): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    )
    (output): LogSoftmax(dim=-1)
  )
)
propagate done
init label
Split: 10, Run: 01
None time:  1.516327038174495
None Run 28:
Highest Train: 100.00
Highest Valid: 74.00
  Final Train: 100.00
   Final Test: 69.70
Split: 10, Run: 02
None time:  1.454490119125694
None Run 29:
Highest Train: 100.00
Highest Valid: 70.80
  Final Train: 100.00
   Final Test: 67.30
